var app=function(){"use strict";function e(){}const t=e=>e;function n(e){return e()}function l(){return Object.create(null)}function a(e){e.forEach(n)}function s(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let o;function c(e,t){return o||(o=document.createElement("a")),o.href=t,e===o.href}function u(t,n,l){t.$$.on_destroy.push(function(t,...n){if(null==t)return e;const l=t.subscribe(...n);return l.unsubscribe?()=>l.unsubscribe():l}(n,l))}function d(e){return null==e?"":e}function m(e,t,n){return e.set(n),t}const f="undefined"!=typeof window;let h=f?()=>window.performance.now():()=>Date.now(),p=f?e=>requestAnimationFrame(e):e;const v=new Set;function g(e){v.forEach((t=>{t.c(e)||(v.delete(t),t.f())})),0!==v.size&&p(g)}function y(e){let t;return 0===v.size&&p(g),{promise:new Promise((n=>{v.add(t={c:e,f:n})})),abort(){v.delete(t)}}}function _(e,t){e.appendChild(t)}function b(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function $(e){const t=M("style");return function(e,t){_(e.head||e,t),t.sheet}(b(e),t),t.sheet}function x(e,t,n){e.insertBefore(t,n||null)}function k(e){e.parentNode&&e.parentNode.removeChild(e)}function w(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function M(e){return document.createElement(e)}function j(e){return document.createTextNode(e)}function E(){return j(" ")}function S(){return j("")}function C(e,t,n,l){return e.addEventListener(t,n,l),()=>e.removeEventListener(t,n,l)}function O(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function q(e,t){t=""+t,e.data!==t&&(e.data=t)}function H(e,t,n,l){null==n?e.style.removeProperty(t):e.style.setProperty(t,n,l?"important":"")}function A(e,t){return new e(t)}const z=new Map;let I,T=0;function F(e,t,n,l,a,s,r,i=0){const o=16.666/l;let c="{\n";for(let e=0;e<=1;e+=o){const l=t+(n-t)*s(e);c+=100*e+`%{${r(l,1-l)}}\n`}const u=c+`100% {${r(n,1-n)}}\n}`,d=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${i}`,m=b(e),{stylesheet:f,rules:h}=z.get(m)||function(e,t){const n={stylesheet:$(t),rules:{}};return z.set(e,n),n}(m,e);h[d]||(h[d]=!0,f.insertRule(`@keyframes ${d} ${u}`,f.cssRules.length));const p=e.style.animation||"";return e.style.animation=`${p?`${p}, `:""}${d} ${l}ms linear ${a}ms 1 both`,T+=1,d}function B(e,t){const n=(e.style.animation||"").split(", "),l=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),a=n.length-l.length;a&&(e.style.animation=l.join(", "),T-=a,T||p((()=>{T||(z.forEach((e=>{const{ownerNode:t}=e.stylesheet;t&&k(t)})),z.clear())})))}function N(e){I=e}function R(){if(!I)throw new Error("Function called outside component initialization");return I}const P=[],D=[];let L=[];const G=[],W=Promise.resolve();let K=!1;function J(e){L.push(e)}function Q(e){G.push(e)}const U=new Set;let V,X=0;function Y(){if(0!==X)return;const e=I;do{try{for(;X<P.length;){const e=P[X];X++,N(e),Z(e.$$)}}catch(e){throw P.length=0,X=0,e}for(N(null),P.length=0,X=0;D.length;)D.pop()();for(let e=0;e<L.length;e+=1){const t=L[e];U.has(t)||(U.add(t),t())}L.length=0}while(P.length);for(;G.length;)G.pop()();K=!1,U.clear(),N(e)}function Z(e){if(null!==e.fragment){e.update(),a(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(J)}}function ee(){return V||(V=Promise.resolve(),V.then((()=>{V=null}))),V}function te(e,t,n){e.dispatchEvent(function(e,t,{bubbles:n=!1,cancelable:l=!1}={}){const a=document.createEvent("CustomEvent");return a.initCustomEvent(e,n,l,t),a}(`${t?"intro":"outro"}${n}`))}const ne=new Set;let le;function ae(){le={r:0,c:[],p:le}}function se(){le.r||a(le.c),le=le.p}function re(e,t){e&&e.i&&(ne.delete(e),e.i(t))}function ie(e,t,n,l){if(e&&e.o){if(ne.has(e))return;ne.add(e),le.c.push((()=>{ne.delete(e),l&&(n&&e.d(1),l())})),e.o(t)}else l&&l()}const oe={duration:0};function ce(n,l,a){const r={direction:"in"};let i,o,c=l(n,a,r),u=!1,d=0;function m(){i&&B(n,i)}function f(){const{delay:l=0,duration:a=300,easing:s=t,tick:r=e,css:f}=c||oe;f&&(i=F(n,0,1,a,l,s,f,d++)),r(0,1);const p=h()+l,v=p+a;o&&o.abort(),u=!0,J((()=>te(n,!0,"start"))),o=y((e=>{if(u){if(e>=v)return r(1,0),te(n,!0,"end"),m(),u=!1;if(e>=p){const t=s((e-p)/a);r(t,1-t)}}return u}))}let p=!1;return{start(){p||(p=!0,B(n),s(c)?(c=c(r),ee().then(f)):f())},invalidate(){p=!1},end(){u&&(m(),u=!1)}}}function ue(n,l,r){const i={direction:"out"};let o,c=l(n,r,i),u=!0;const d=le;function m(){const{delay:l=0,duration:s=300,easing:r=t,tick:i=e,css:m}=c||oe;m&&(o=F(n,1,0,s,l,r,m));const f=h()+l,p=f+s;J((()=>te(n,!1,"start"))),y((e=>{if(u){if(e>=p)return i(0,1),te(n,!1,"end"),--d.r||a(d.c),!1;if(e>=f){const t=r((e-f)/s);i(1-t,t)}}return u}))}return d.r+=1,s(c)?ee().then((()=>{c=c(i),m()})):m(),{end(e){e&&c.tick&&c.tick(1,0),u&&(o&&B(n,o),u=!1)}}}function de(e,t){e.d(1),t.delete(e.key)}function me(e,t){ie(e,1,1,(()=>{t.delete(e.key)}))}function fe(e,t,n,l,s,r,i,o,c,u,d,m){let f=e.length,h=r.length,p=f;const v={};for(;p--;)v[e[p].key]=p;const g=[],y=new Map,_=new Map,b=[];for(p=h;p--;){const e=m(s,r,p),a=n(e);let o=i.get(a);o?l&&b.push((()=>o.p(e,t))):(o=u(a,e),o.c()),y.set(a,g[p]=o),a in v&&_.set(a,Math.abs(p-v[a]))}const $=new Set,x=new Set;function k(e){re(e,1),e.m(o,d),i.set(e.key,e),d=e.first,h--}for(;f&&h;){const t=g[h-1],n=e[f-1],l=t.key,a=n.key;t===n?(d=t.first,f--,h--):y.has(a)?!i.has(l)||$.has(l)?k(t):x.has(a)?f--:_.get(l)>_.get(a)?(x.add(l),k(t)):($.add(a),f--):(c(n,i),f--)}for(;f--;){const t=e[f];y.has(t.key)||c(t,i)}for(;h;)k(g[h-1]);return a(b),g}function he(e,t,n){const l=e.$$.props[t];void 0!==l&&(e.$$.bound[l]=n,n(e.$$.ctx[l]))}function pe(e){e&&e.c()}function ve(e,t,l,r){const{fragment:i,after_update:o}=e.$$;i&&i.m(t,l),r||J((()=>{const t=e.$$.on_mount.map(n).filter(s);e.$$.on_destroy?e.$$.on_destroy.push(...t):a(t),e.$$.on_mount=[]})),o.forEach(J)}function ge(e,t){const n=e.$$;null!==n.fragment&&(!function(e){const t=[],n=[];L.forEach((l=>-1===e.indexOf(l)?t.push(l):n.push(l))),n.forEach((e=>e())),L=t}(n.after_update),a(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function ye(e,t){-1===e.$$.dirty[0]&&(P.push(e),K||(K=!0,W.then(Y)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function _e(t,n,s,r,i,o,c,u=[-1]){const d=I;N(t);const m=t.$$={fragment:null,ctx:[],props:o,update:e,not_equal:i,bound:l(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(d?d.$$.context:[])),callbacks:l(),dirty:u,skip_bound:!1,root:n.target||d.$$.root};c&&c(m.root);let f=!1;if(m.ctx=s?s(t,n.props||{},((e,n,...l)=>{const a=l.length?l[0]:n;return m.ctx&&i(m.ctx[e],m.ctx[e]=a)&&(!m.skip_bound&&m.bound[e]&&m.bound[e](a),f&&ye(t,e)),n})):[],m.update(),f=!0,a(m.before_update),m.fragment=!!r&&r(m.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);m.fragment&&m.fragment.l(e),e.forEach(k)}else m.fragment&&m.fragment.c();n.intro&&re(t.$$.fragment),ve(t,n.target,n.anchor,n.customElement),Y()}N(d)}class be{$destroy(){ge(this,1),this.$destroy=e}$on(t,n){if(!s(n))return e;const l=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return l.push(n),()=>{const e=l.indexOf(n);-1!==e&&l.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function $e(e){const t=e-1;return t*t*t+1}function xe(e,{delay:n=0,duration:l=400,easing:a=t}={}){const s=+getComputedStyle(e).opacity;return{delay:n,duration:l,easing:a,css:e=>"opacity: "+e*s}}function ke(e,{delay:t=0,duration:n=400,easing:l=$e,start:a=0,opacity:s=0}={}){const r=getComputedStyle(e),i=+r.opacity,o="none"===r.transform?"":r.transform,c=1-a,u=i*(1-s);return{delay:t,duration:n,easing:l,css:(e,t)=>`\n\t\t\ttransform: ${o} scale(${1-c*t});\n\t\t\topacity: ${i-u*t}\n\t\t`}}const we=[];function Me(t,n=e){let l;const a=new Set;function s(e){if(i(t,e)&&(t=e,l)){const e=!we.length;for(const e of a)e[1](),we.push(e,t);if(e){for(let e=0;e<we.length;e+=2)we[e][0](we[e+1]);we.length=0}}}return{set:s,update:function(e){s(e(t))},subscribe:function(r,i=e){const o=[r,i];return a.add(o),1===a.size&&(l=n(s)||e),r(t),()=>{a.delete(o),0===a.size&&l&&(l(),l=null)}}}}const je=Me("Afflatus"),Ee=Me({}),Se=Me({collections:{seal_needle:1,bottle_of_stars:1,mimosa:10,conch_shell:20,"vampire's_old_tooth":10,skyrocket:10,large_roll_of_bandages:10,bird_wine:10,pickled_radish:10},equipment:"sunshade",consumables:{},spellcards:{Earth_Light_Ray:4,marisa:0},souvenir:"wanderlust",role:"marisa",sugar:3,chance:2,health:92,coin:1e3,scene:"shrine",lv:50}),Ce=Me({resource:"dairi"}),Oe=Me({enermy:["cirno","cirno"],event:[],target:[!0,!0,!0,!0,!1,!1],enermyLimit:4,lv:80}),qe=Me({});function He(e,t,n){const l=e.slice();return l[4]=t[n],l[6]=n,l}function Ae(e,t){let n,l,a,s,r,i,o,u,d,m,f,h,p,v,g,y,b,$,w=(t[4].title?t[4].title:"提示")+"",S=t[4].content+"";function A(...e){return t[1](t[6],...e)}return{key:e,first:null,c(){n=M("div"),l=M("img"),s=E(),r=M("div"),i=M("txt"),o=j(w),u=E(),d=M("txt"),m=j(S),f=E(),h=M("div"),p=E(),c(l.src,a="/svg/logo.svg")||O(l,"src","/svg/logo.svg"),O(l,"class","svelte-1bgtu6v"),O(i,"class","title svelte-1bgtu6v"),O(d,"class","content svelte-1bgtu6v"),H(r,"margin-bottom","4px"),O(h,"class","tie svelte-1bgtu6v"),O(n,"class","svelte-1bgtu6v"),this.first=n},m(e,t){x(e,n,t),_(n,l),_(n,s),_(n,r),_(r,i),_(i,o),_(r,u),_(r,d),_(d,m),_(n,f),_(n,h),_(n,p),y=!0,b||($=C(n,"click",A),b=!0)},p(e,n){t=e,(!y||1&n)&&w!==(w=(t[4].title?t[4].title:"提示")+"")&&q(o,w),(!y||1&n)&&S!==(S=t[4].content+"")&&q(m,S)},i(e){y||(J((()=>{y&&(g&&g.end(1),v=ce(n,ke,{duration:300}),v.start())})),y=!0)},o(e){v&&v.invalidate(),g=ue(n,xe,{duration:300}),y=!1},d(e){e&&k(n),e&&g&&g.end(),b=!1,$()}}}function ze(e){let t,n,l=[],a=new Map,s=e[0];const r=e=>e[4].key;for(let t=0;t<s.length;t+=1){let n=He(e,s,t),i=r(n);a.set(i,l[t]=Ae(i,n))}return{c(){t=M("div");for(let e=0;e<l.length;e+=1)l[e].c();O(t,"class","msg svelte-1bgtu6v")},m(e,a){x(e,t,a);for(let e=0;e<l.length;e+=1)l[e]&&l[e].m(t,null);n=!0},p(e,[n]){1&n&&(s=e[0],ae(),l=fe(l,n,r,1,e,s,a,t,me,Ae,null,He),se())},i(e){if(!n){for(let e=0;e<s.length;e+=1)re(l[e]);n=!0}},o(e){for(let e=0;e<l.length;e+=1)ie(l[e]);n=!1},d(e){e&&k(t);for(let e=0;e<l.length;e+=1)l[e].d()}}}function Ie(e,t,n){let l;u(e,Ee,(e=>n(2,l=e)));let a=[];var s;function r(e){e.time=(new Date).getTime(),e.key=Math.random(),a.push(e),n(0,a=a.filter((t=>e.time-t.time<3e3)))}m(Ee,l.msg=r,l),window.msg=r,s=e=>n(0,a=a.filter((e=>(new Date).getTime()-e.time<3e3))),R().$$.before_update.push(s);return[a,(e,t)=>n(0,a=a.filter(((t,n)=>e!=n)))]}class Te extends be{constructor(e){super(),_e(this,e,Ie,ze,i,{})}}var Fe={portable_money_box:{name:"便携式赛钱箱",detail:"每持有100硬币，伤害提高5%(每层+5%)。",type:"blue"},bronze_mirror:{name:"铜镜",detail:"攻击有25%概率额外对随机其它目标造成20%(每层+20%)伤害。",type:"blue"},mimosa:{name:"三片叶子的含羞草",detail:"敌人造成的伤害不会超过自身攻击力的300%(每层*95%)。",type:"blue"},compass_cat:{name:"罗盘猫",detail:"对敏捷高于自己的敌人伤害+10%(每层+10%)。",type:"blue"},bird_wine:{name:"雀酒",detail:"击败敌人时对全体敌人附加燃烧*1(每层+1)。",type:"blue"},frozen_frog:{name:"冻青蛙",detail:"自身所受迟缓效果转移到随机1(每层+1)名敌人身上。",type:"blue"},fluorescent_zanthoxylum:{name:"荧光花椒",detail:"暴击率+5%",type:"blue"},corvis_feathers:{name:"鸦天狗羽毛",detail:"处于两个及以上正面效果下时，敏捷+0.05(每层+0.05)。",type:"blue"},sundial:{name:"日晷",detail:"间接伤害提高10%(每层+10%)。",type:"blue"},pickled_radish:{name:"腌萝卜",detail:"生命值高于95%时符卡造成的伤害+10%(每层+10%)。",type:"blue"},conch_shell:{name:"海螺壳",detail:"每次受到的伤害固定减少1(每层+1)。",type:"blue"},cursed_wind_chimes:{name:"被诅咒的风铃",detail:"造成600%(每层*95%)攻击力及以上的伤害时，使下一次攻击能驱散目标的所有正面效果。",type:"blue"},ghost_lantern:{name:"鬼行提灯",detail:"回合结束时，每剩余1点灵力，获得5%(每层+5%)最大生命值的临时防御结界。",type:"green"},"vampire's_old_tooth":{name:"吸血鬼的旧牙",detail:"攻击时回复0.5(每层+0.5)生命值。",type:"green"},large_roll_of_bandages:{name:"一大卷绷带",detail:"受到伤害的下一回合回复5%(每层+5%)当前生命值。",type:"green"},burning_seashore_flower:{name:"燃烧的彼岸花",detail:"每损失1%生命，获得0.5%(每层+0.25%)暴击率。",type:"green"},skyrocket:{name:"窜天猴",detail:"普通攻击30%概率造成1.5倍伤害并附带燃烧*1(每层+1)。",type:"green"},magic_dart:{name:"魔力飞镖",detail:"受到攻击时反击，造成伤害20%(每层+10%)的间接伤害。",type:"green"},fox_jade:{name:"狐玉",detail:"受到超过最大生命值40%(每层*95%)的伤害时触发一次击败效果。",type:"green"},cherry:{name:"石樱",detail:"20%(每层+20%)过量治疗量转化为临时防御结界。",type:"green"},earthy_spider_wine:{name:"土蜘蛛酒",detail:"普通攻击后符卡造成的伤害提高10%(每层+10%)，回合初清除。",type:"green"},amulet_of_full_moon:{name:"圆月护符",detail:"处于三个及以上负面效果下时，攻击造成的伤害增加10%(每层+10%)。",type:"green"},seal_needle:{name:"封魔针",detail:"累计造成八次伤害后，下次攻击对目标附加流血*1(每层+1)。",type:"green"},crown_of_thorns:{name:"荆棘礼冠",detail:"击败敌人时获得1(每层+1)额外灵力。",type:"green"},red_and_white_scarf:{name:"红白围巾",detail:"生命值高于30%(每层*90%)时，受到致命伤会保留1生命值。",type:"red"},bottle_of_stars:{name:"装星星的瓶子",detail:"造成300%攻击力及以上的伤害时附加1(每层+1)颗星星，在下回合爆炸造成50%伤害。",type:"red"},"philosopher's_stone":{name:"贤者之石",detail:"主动装备可使用次数加+1(每层+1)。",type:"red"},blade_of_yellow_spring:{name:"黄泉之刃",detail:"每回合获得1(每层+1)张额外普通攻击。",type:"red"},blood_book:{name:"鲜血魔导书",detail:"抽卡上限+1(每层+1)。",type:"red"},human_soul_lamp:{name:"人魂灯",detail:"暴击伤害+50%(每层+50%)。",type:"red"},"patchouli's_ribbon":{name:"帕秋莉的缎带",detail:"灵力上限+1(每层+1)。",type:"red"},fish_stone:{name:"月光宝珠",detail:"自身负面效果结算时所取层数减1(每层+1)。",type:"red"}},Be={sort:["gongonier","sword_of_feixiang","sunshade","mirror_of_pear","mini_bagua_stove","louguanjian","hd_camera"],gongonier:{name:"血之矢",detail:"被动。造成的伤害暴击时，回复伤害20%的生命值。"},sword_of_feixiang:{name:"绯想之剑",detail:"被动。对处于负面效果下的敌人造成的伤害+40%。"},sunshade:{name:"阳伞",detail:"主动。将30%生命值转化为200%防御结界。"},mirror_of_pear:{name:"净颇梨之镜",detail:"被动。普通攻击不消耗灵力。"},mini_bagua_stove:{name:"迷你八卦炉",detail:"主动。对全体敌人造成400%攻击力伤害。"},louguanjian:{name:"楼观剑",detail:"主动。扣除全体敌人20%当前生命值。"},hd_camera:{name:"高清相机",detail:"主动。驱散全体敌人身上的正面效果。"}},Ne={sort:["noda's_hat","microlithic_fish","ahab's_opinion","mimicry_cat_pendant","wanderlust"],"noda's_hat":{name:"野田的帽子",detail:"生命值高于50%时受到伤害增加20%，低于50%时则减少30%。"},microlithic_fish:{name:"小石的鱼",detail:"受到伤害时70%概率获得随机负面效果(迟缓，燃烧，流血，疲倦)*1，30%概率阻挡本次伤害。"},"ahab's_opinion":{name:"亚哈的意见",detail:"生命上限变为70%，战斗开始时回复全部生命值。"},mimicry_cat_pendant:{name:"拟态的猫挂件",detail:"使用符卡时，每有1灵力需求，扣除10%当前生命值，不消耗灵力。"},wanderlust:{name:"清泧的遨游术",detail:"手牌上限变为3，不受敏捷影响，每拥有1敏捷，回合初获得1额外灵力。"}},Re={sort:{marisa:["Stardust_Reverie","Master_Spark","Asteroid_Belt","Orrery's_Sun","Earth_Light_Ray"],medicine:["Nerve_Poison","Melancholy_Poison","Gassing_Garden","Poison_Breath","Into_Delirium"],reimu:["Dream_Seal","Demon_Seal_Circle","Double_Bound","The_Jade","Dream_Born"],youmu:["Bright_Bitter_Wheel","Six_Roots_Clean","Centered_Flow","Future_Never_Survive","Graciousness_Maze"]},marisa:{name:"魔法弹",detail:"对目标造成120%攻击力伤害。",output:{attack:[{type:"scale",value:"120",aim:"one"}]}},Stardust_Reverie:{name:"星尘幻想",detail:"对目标造成400%攻击力伤害，对其余敌人造成80%攻击力伤害。",output:{attack:[{type:"scale",value:"400",aim:"one"},{type:"scale",value:"80",aim:"else"}]}},Master_Spark:{name:"极限火花",detail:"对每个敌人造成360%攻击力伤害，下回合无法行动。",allAim:!0,output:{attack:[{type:"scale",value:"360",aim:"all"}],buff:[{value:"hypodynamic",amount:"1",aim:"self"}]}},Asteroid_Belt:{name:"小行星带",detail:"对每个敌人造成4x50%攻击力伤害。",allAim:!0,output:{attack:[{type:"scale",value:"50",aim:"all",amount:"4"}]}},"Orrery's_Sun":{name:"太阳仪",detail:"本回合所有直接攻击转移到下回合造成120%的间接伤害。",allAim:!0,output:{buff:[{value:"Orrery's_Sun",amount:"1",aim:"self"}]}},Earth_Light_Ray:{name:"地球光",detail:"将600%攻击力伤害平摊给所有敌人",allAim:!0,output:{attack:[{type:"scale",value:"600",aim:"average"}]}},medicine:{},Nerve_Poison:{name:"神经之毒",detail:""},Melancholy_Poison:{name:"忧郁之毒",detail:""},Gassing_Garden:{name:"毒气花园",detail:""},Poison_Breath:{name:"猛毒气息",detail:""},Into_Delirium:{name:"进入疯狂",detail:""},reimu:{},Dream_Seal:{name:"梦想封印",detail:"分别对随机目标造成8*10%对方当前生命值的伤害。不会暴击。"},Demon_Seal_Circle:{name:"封魔阵",detail:"无效化目标下回合的直接攻击。"},Double_Bound:{name:"二重结界",detail:"下一回合，受到伤害时会返还同样的伤害。"},The_Jade:{name:"阴阳鬼神玉",detail:"对目标造成400%攻击力伤害。"},Dream_Born:{name:"梦想天生",detail:"接下来的七次攻击有15%概率使自己免受一次伤害，第七次获得自身当前血量50%的护盾。"},youmu:{name:"剑气",detail:"对目标造成2*50%攻击力伤害。",output:{attack:[{type:"scale",value:"50",aim:"one",amount:"2"}]}},Bright_Bitter_Wheel:{name:"幽明的苦轮",detail:"半灵将重复你接下来的三次攻击，造成60%间接伤害，每次回复一点灵力。"},Six_Roots_Clean:{name:"六根清净斩",detail:"闪避下次受到的攻击并对每个敌人造成180%攻击力伤害。"},Centered_Flow:{name:"圆心流转斩",detail:"对每个敌人造成3*40%攻击力伤害，下一次普通攻击造成的伤害提高40%。"},Future_Never_Survive:{name:"未来永劫斩",detail:"对目标造成300%攻击力伤害，接下来三次普通攻击变为2*70%。"},Graciousness_Maze:{name:"迷津慈航斩",detail:"普通攻击消耗的灵力+1但伤害提高200%，直到下回合初。"}},Pe={sort:["reimu","marisa","shion","aya","youmu"],reimu:{name:"博丽灵梦",detail:"超乎常人的幸运，她的直觉几乎一定会命中。",talent:""},marisa:{name:"雾雨魔理沙",detail:"弹幕最重要的是火力！"},shion:{name:"依神紫苑",detail:"失去的财产，还有运气究竟去了哪里呢。"},aya:{name:"射命丸文",detail:"来吧，我会手下留情的。"},youmu:{name:"魂魄妖梦",detail:"半人半灵的半吊子。但是剑有两把。",talent:"所有暴击率转化为暴击伤害。每消耗一点灵力，获得一层通灵(闪避几率+10%)，每触发一次闪避减少三层通灵并对伤害来源发动一次必定暴击的普通攻击，回合初清除通灵。"}},De={role:{marisa:e=>Le(e,.9,.9,1,1),reimu:e=>Le(e,1,1,1,6),shion:e=>Le(e,1.1,1.1,1,5),medicine:e=>Le(e,.9,.9,1,4),aya:e=>Le(e,1,1,1.2,5),renko:e=>Le(e,1,1,1,5),youmu:e=>Le(e,.8,1.1,1.1,8)},enermy:{cirno:e=>Ge(e,1,1,1),piece:e=>Ge(e,1,1,1),lilywhite:e=>Ge(e,1,1,1),sunny:e=>Ge(e,1,1,1),lunar:e=>Ge(e,1,1,1),star:e=>Ge(e,1,1,1),eternity:e=>Ge(e,1,1,1)},amount:e=>{let t=4.2-1/Math.pow(2,e/32-2),n=t-parseInt(t),l=Number(Math.random()<n);return parseInt(t)+l}};function Le(e,t,n,l,a){return{health:Math.ceil(We(e)*t),attack:Math.ceil(We(e)*n/6),speed:1+.02*e*l,power:a}}function Ge(e,t,n,l){return{health:Je(Ke(e)*t),attack:Je(Ke(e)*n/8),speed:1+.02*(e-1)*l}}function We(e){return parseInt(Math.pow(Math.E,e/(Math.E*Math.log(e+1)+Math.sqrt(e)/Math.E))+e+10)}function Ke(e){return parseInt(Math.pow(Math.E,e/(Math.log(e+1)+Math.sqrt(e)))+e+10)}function Je(e){return.95*e+Math.random().toFixed(2)*e*.1}function Qe(e){let t,n,l,a,s,r,i,o,c;return{c(){t=M("div"),n=M("span"),l=j(e[0]),a=E(),s=M("a"),r=j(e[1]),H(n,"background-color","var(--"+e[2]+")"),O(n,"class","svelte-gtiu39"),O(s,"class","svelte-gtiu39"),O(t,"class","explain svelte-gtiu39"),H(t,"left",e[3]+"px"),H(t,"top",e[4]+"px")},m(i,o){x(i,t,o),_(t,n),_(n,l),_(t,a),_(t,s),_(s,r),e[8](t),c=!0},p(e,a){(!c||1&a)&&q(l,e[0]),(!c||4&a)&&H(n,"background-color","var(--"+e[2]+")"),(!c||2&a)&&q(r,e[1]),(!c||8&a)&&H(t,"left",e[3]+"px"),(!c||16&a)&&H(t,"top",e[4]+"px")},i(e){c||(J((()=>{c&&(o&&o.end(1),i=ce(t,xe,{duration:100}),i.start())})),c=!0)},o(e){i&&i.invalidate(),o=ue(t,xe,{duration:100}),c=!1},d(n){n&&k(t),e[8](null),n&&o&&o.end()}}}function Ue(e){let t,n,l="show"==e[5]&&Qe(e);return{c(){l&&l.c(),t=S()},m(e,a){l&&l.m(e,a),x(e,t,a),n=!0},p(e,[n]){"show"==e[5]?l?(l.p(e,n),32&n&&re(l,1)):(l=Qe(e),l.c(),re(l,1),l.m(t.parentNode,t)):l&&(ae(),ie(l,1,1,(()=>{l=null})),se())},i(e){n||(re(l),n=!0)},o(e){ie(l),n=!1},d(e){l&&l.d(e),e&&k(t)}}}function Ve(e,t,n){let l,a,s,r,i,o,c="hide";const u={move:(e,t,c)=>{n(0,l=t.name),n(1,a=t.detail),n(2,s=c),n(3,r=document.body.clientWidth-e.x>240?e.x+5:document.body.clientWidth-240),n(4,i=e.y-o.offsetHeight-5)},show:e=>n(5,c="show"),hide:e=>n(5,c="hide")};return[l,a,s,r,i,c,o,u,function(e){D[e?"unshift":"push"]((()=>{o=e,n(6,o)}))}]}class Xe extends be{constructor(e){super(),_e(this,e,Ve,Ue,i,{explain:7})}get explain(){return this.$$.ctx[7]}}function Ye(e,t,n){const l=e.slice();return l[34]=t[n],l[36]=n,l}function Ze(e,t,n){const l=e.slice();return l[37]=t[n],l[36]=n,l}function et(e,t,n){const l=e.slice();return l[34]=t[n],l[36]=n,l}function tt(e,t){let n,l,s,r,i,o,u,d,m=t[34].data+"";function f(...e){return t[10](t[34],...e)}return{key:e,first:null,c(){n=M("div"),l=M("img"),r=E(),i=M("txt"),o=j(m),H(l,"left",150+1.5*t[5][t[36]].x-16+"px"),H(l,"top",150+1.5*t[5][t[36]].y-16+"px"),c(l.src,s="/svg/"+t[34].type+".svg")||O(l,"src",s),O(l,"class","svelte-1d1kv8l"),H(i,"left",150+2.3*t[5][t[36]].x-16+"px"),H(i,"top",150+2.3*t[5][t[36]].y-16+"px"),O(i,"class","svelte-1d1kv8l"),O(n,"class","svelte-1d1kv8l"),this.first=n},m(e,a){x(e,n,a),_(n,l),_(n,r),_(n,i),_(i,o),u||(d=[C(n,"mouseenter",t[9]),C(n,"mousemove",f),C(n,"mouseleave",t[11])],u=!0)},p(e,n){t=e},d(e){e&&k(n),u=!1,a(d)}}}function nt(e){let t,n,l,a,s=[],r=new Map,i=Object.keys(e[3].collections);const o=e=>e[36];for(let t=0;t<i.length;t+=1){let n=Ze(e,i,t),l=o(n);r.set(l,s[t]=at(l,n))}return{c(){t=M("div");for(let e=0;e<s.length;e+=1)s[e].c();O(t,"class","collection svelte-1d1kv8l")},m(e,n){x(e,t,n);for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(t,null);a=!0},p(e,n){12&n[0]&&(i=Object.keys(e[3].collections),s=fe(s,n,o,1,e,i,r,t,de,at,null,Ze))},i(e){a||(J((()=>{a&&(l&&l.end(1),n=ce(t,xe,{duration:200}),n.start())})),a=!0)},o(e){n&&n.invalidate(),l=ue(t,xe,{duration:200}),a=!1},d(e){e&&k(t);for(let e=0;e<s.length;e+=1)s[e].d();e&&l&&l.end()}}}function lt(e){let t,n,l=Object.values(e[3].collections)[e[36]]+"";return{c(){t=M("txt"),n=j(l),O(t,"class","svelte-1d1kv8l")},m(e,l){x(e,t,l),_(t,n)},p(e,t){8&t[0]&&l!==(l=Object.values(e[3].collections)[e[36]]+"")&&q(n,l)},d(e){e&&k(t)}}}function at(e,t){let n,l,s,r,i,o,u,d=Object.values(t[3].collections)[t[36]]>1,m=d&&lt(t);function f(...e){return t[20](t[37],...e)}return{key:e,first:null,c(){n=M("div"),l=M("img"),r=E(),m&&m.c(),i=E(),c(l.src,s="/svg/collection/"+t[37]+".svg")||O(l,"src",s),O(l,"class","svelte-1d1kv8l"),O(n,"class","svelte-1d1kv8l"),this.first=n},m(e,a){x(e,n,a),_(n,l),_(n,r),m&&m.m(n,null),_(n,i),o||(u=[C(n,"mouseenter",t[19]),C(n,"mousemove",f),C(n,"mouseleave",t[21])],o=!0)},p(e,a){t=e,8&a[0]&&!c(l.src,s="/svg/collection/"+t[37]+".svg")&&O(l,"src",s),8&a[0]&&(d=Object.values(t[3].collections)[t[36]]>1),d?m?m.p(t,a):(m=lt(t),m.c(),m.m(n,i)):m&&(m.d(1),m=null)},d(e){e&&k(n),m&&m.d(),o=!1,a(u)}}}function st(e){let t,n,l,a,s=[],r=new Map,i=Object.keys(e[3].spellcards);const o=e=>e[36];for(let t=0;t<i.length;t+=1){let n=Ye(e,i,t),l=o(n);r.set(l,s[t]=it(l,n))}return{c(){t=M("div");for(let e=0;e<s.length;e+=1)s[e].c();O(t,"class","spellcards svelte-1d1kv8l")},m(e,n){x(e,t,n);for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(t,null);a=!0},p(e,n){12&n[0]&&(i=Object.keys(e[3].spellcards),s=fe(s,n,o,1,e,i,r,t,de,it,null,Ye))},i(e){a||(J((()=>{a&&(l&&l.end(1),n=ce(t,xe,{duration:200}),n.start())})),a=!0)},o(e){n&&n.invalidate(),l=ue(t,xe,{duration:200}),a=!1},d(e){e&&k(t);for(let e=0;e<s.length;e+=1)s[e].d();e&&l&&l.end()}}}function rt(e){let t,n,l=Object.values(e[3].spellcards)[e[36]]+"";return{c(){t=M("txt"),n=j(l),O(t,"class","svelte-1d1kv8l")},m(e,l){x(e,t,l),_(t,n)},p(e,t){8&t[0]&&l!==(l=Object.values(e[3].spellcards)[e[36]]+"")&&q(n,l)},d(e){e&&k(t)}}}function it(e,t){let n,l,s,r,i,o,u,d=Object.values(t[3].spellcards)[t[36]]>1,m=d&&rt(t);function f(...e){return t[23](t[34],...e)}return{key:e,first:null,c(){n=M("div"),l=M("img"),r=E(),m&&m.c(),i=E(),c(l.src,s="/svg/spellcard/"+t[34]+".svg")||O(l,"src",s),O(l,"class","svelte-1d1kv8l"),O(n,"class","spellcard svelte-1d1kv8l"),this.first=n},m(e,a){x(e,n,a),_(n,l),_(n,r),m&&m.m(n,null),_(n,i),o||(u=[C(n,"mouseenter",t[22]),C(n,"mousemove",f),C(n,"mouseleave",t[24])],o=!0)},p(e,a){t=e,8&a[0]&&!c(l.src,s="/svg/spellcard/"+t[34]+".svg")&&O(l,"src",s),8&a[0]&&(d=Object.values(t[3].spellcards)[t[36]]>1),d?m?m.p(t,a):(m=rt(t),m.c(),m.m(n,i)):m&&(m.d(1),m=null)},d(e){e&&k(n),m&&m.d(),o=!1,a(u)}}}function ot(e){let t,n,l,a;return{c(){t=M("div"),O(t,"class","consumable svelte-1d1kv8l")},m(e,n){x(e,t,n),a=!0},i(e){a||(J((()=>{a&&(l&&l.end(1),n=ce(t,xe,{duration:200}),n.start())})),a=!0)},o(e){n&&n.invalidate(),l=ue(t,xe,{duration:200}),a=!1},d(e){e&&k(t),e&&l&&l.end()}}}function ct(e){let t,n,l,s,r,i,o,u,m,f,h,p,v,g,y,b,$,w,S,A,z,I,T,F,B,N,R,P,L,G,W,K,J,U,V,X,Y,Z,ee,te,ne,le,oe,ce,ue,me,ye,_e,be,$e,xe,ke,we,Me,je,Ee,Se,Ce,Oe,qe,He,Ae,ze=[],Ie=new Map,Te=e[3].coin+"",Fe=Be[e[3].equipment].name+"",Re=Ne[e[3].souvenir].name+"";function Pe(t){e[8](t)}let De={};void 0!==e[2]&&(De.explain=e[2]),n=new Xe({props:De}),D.push((()=>he(n,"explain",Pe)));let Le=e[6];const Ge=e=>e[36];for(let t=0;t<Le.length;t+=1){let n=et(e,Le,t),l=Ge(n);Ie.set(l,ze[t]=tt(l,n))}let We="collection"==e[1]&&nt(e),Ke="spellcards"==e[1]&&st(e),Je="consumable"==e[1]&&ot();return{c(){t=M("div"),pe(n.$$.fragment),s=E(),r=M("div"),r.innerHTML='<div class="title svelte-1d1kv8l"><img src="/svg/data.svg" class="svelte-1d1kv8l"/> \n      <txt class="svelte-1d1kv8l">思与想的境界</txt></div>',i=E(),o=M("div"),u=M("div");for(let e=0;e<ze.length;e+=1)ze[e].c();m=E(),f=M("img"),p=E(),v=M("div"),g=M("img"),b=E(),$=M("txt"),w=j(Te),S=E(),A=M("div"),z=M("txt"),z.textContent="保存并回到标题界面",I=E(),T=M("div"),F=M("div"),B=M("div"),N=M("txt"),R=j("收藏品"),L=E(),G=M("txt"),W=j("符卡"),J=E(),U=M("txt"),V=j("消耗品"),Y=E(),We&&We.c(),Z=E(),Ke&&Ke.c(),ee=E(),Je&&Je.c(),te=E(),ne=M("div"),le=M("div"),oe=M("img"),ue=E(),me=M("txt"),ye=j(Fe),_e=E(),be=M("txt"),be.textContent="装备",$e=E(),xe=M("div"),ke=M("img"),Me=E(),je=M("txt"),Ee=j(Re),Se=E(),Ce=M("txt"),Ce.textContent="纪念品",O(r,"class","info svelte-1d1kv8l"),O(r,"id","info"),c(f.src,h="/img/role/"+e[4].resource+"/"+e[3].role+".webp")||O(f,"src",h),O(f,"class","svelte-1d1kv8l"),O(u,"class","state svelte-1d1kv8l"),c(g.src,y="/svg/coin.svg")||O(g,"src","/svg/coin.svg"),O(g,"class","svelte-1d1kv8l"),O($,"class","svelte-1d1kv8l"),O(v,"class","coin svelte-1d1kv8l"),O(z,"class","svelte-1d1kv8l"),O(A,"class","action svelte-1d1kv8l"),O(o,"class","left svelte-1d1kv8l"),O(N,"class",P=d("collection"==e[1]&&"selected")+" svelte-1d1kv8l"),O(G,"class",K=d("spellcards"==e[1]&&"selected")+" svelte-1d1kv8l"),O(U,"class",X=d("consumable"==e[1]&&"selected")+" svelte-1d1kv8l"),O(B,"class","index svelte-1d1kv8l"),O(F,"class","item svelte-1d1kv8l"),c(oe.src,ce="/svg/equipment/"+e[3].equipment+".svg")||O(oe,"src",ce),H(oe,"height","80%"),O(oe,"class","svelte-1d1kv8l"),O(me,"class","svelte-1d1kv8l"),O(be,"class","svelte-1d1kv8l"),O(le,"class","equipment svelte-1d1kv8l"),c(ke.src,we="/svg/souvenir/"+e[3].souvenir+".svg")||O(ke,"src",we),H(ke,"height","80%"),O(ke,"class","svelte-1d1kv8l"),O(je,"class","svelte-1d1kv8l"),O(Ce,"class","svelte-1d1kv8l"),O(xe,"class","souvenir svelte-1d1kv8l"),H(ne,"flex-direction","row"),O(T,"class","right svelte-1d1kv8l"),O(t,"class",Oe="body "+(e[0]&&"menu")+" "+e[3].role+" svelte-1d1kv8l")},m(l,a){x(l,t,a),ve(n,t,null),_(t,s),_(t,r),_(t,i),_(t,o),_(o,u);for(let e=0;e<ze.length;e+=1)ze[e]&&ze[e].m(u,null);_(u,m),_(u,f),_(o,p),_(o,v),_(v,g),_(v,b),_(v,$),_($,w),_(o,S),_(o,A),_(A,z),_(t,I),_(t,T),_(T,F),_(F,B),_(B,N),_(N,R),_(B,L),_(B,G),_(G,W),_(B,J),_(B,U),_(U,V),_(F,Y),We&&We.m(F,null),_(F,Z),Ke&&Ke.m(F,null),_(F,ee),Je&&Je.m(F,null),_(T,te),_(T,ne),_(ne,le),_(le,oe),_(le,ue),_(le,me),_(me,ye),_(le,_e),_(le,be),_(ne,$e),_(ne,xe),_(xe,ke),_(xe,Me),_(xe,je),_(je,Ee),_(xe,Se),_(xe,Ce),qe=!0,He||(Ae=[C(f,"mouseenter",e[12]),C(f,"mousemove",e[13]),C(f,"mouseleave",e[14]),C(z,"click",e[15]),C(N,"click",e[16]),C(G,"click",e[17]),C(U,"click",e[18]),C(le,"mouseenter",e[25]),C(le,"mousemove",e[26]),C(le,"mouseleave",e[27]),C(xe,"mouseenter",e[28]),C(xe,"mousemove",e[29]),C(xe,"mouseleave",e[30])],He=!0)},p(e,a){const s={};!l&&4&a[0]&&(l=!0,s.explain=e[2],Q((()=>l=!1))),n.$set(s),100&a[0]&&(Le=e[6],ze=fe(ze,a,Ge,1,e,Le,Ie,u,de,tt,m,et)),(!qe||24&a[0]&&!c(f.src,h="/img/role/"+e[4].resource+"/"+e[3].role+".webp"))&&O(f,"src",h),(!qe||8&a[0])&&Te!==(Te=e[3].coin+"")&&q(w,Te),(!qe||2&a[0]&&P!==(P=d("collection"==e[1]&&"selected")+" svelte-1d1kv8l"))&&O(N,"class",P),(!qe||2&a[0]&&K!==(K=d("spellcards"==e[1]&&"selected")+" svelte-1d1kv8l"))&&O(G,"class",K),(!qe||2&a[0]&&X!==(X=d("consumable"==e[1]&&"selected")+" svelte-1d1kv8l"))&&O(U,"class",X),"collection"==e[1]?We?(We.p(e,a),2&a[0]&&re(We,1)):(We=nt(e),We.c(),re(We,1),We.m(F,Z)):We&&(ae(),ie(We,1,1,(()=>{We=null})),se()),"spellcards"==e[1]?Ke?(Ke.p(e,a),2&a[0]&&re(Ke,1)):(Ke=st(e),Ke.c(),re(Ke,1),Ke.m(F,ee)):Ke&&(ae(),ie(Ke,1,1,(()=>{Ke=null})),se()),"consumable"==e[1]?Je?2&a[0]&&re(Je,1):(Je=ot(),Je.c(),re(Je,1),Je.m(F,null)):Je&&(ae(),ie(Je,1,1,(()=>{Je=null})),se()),(!qe||8&a[0]&&!c(oe.src,ce="/svg/equipment/"+e[3].equipment+".svg"))&&O(oe,"src",ce),(!qe||8&a[0])&&Fe!==(Fe=Be[e[3].equipment].name+"")&&q(ye,Fe),(!qe||8&a[0]&&!c(ke.src,we="/svg/souvenir/"+e[3].souvenir+".svg"))&&O(ke,"src",we),(!qe||8&a[0])&&Re!==(Re=Ne[e[3].souvenir].name+"")&&q(Ee,Re),(!qe||9&a[0]&&Oe!==(Oe="body "+(e[0]&&"menu")+" "+e[3].role+" svelte-1d1kv8l"))&&O(t,"class",Oe)},i(e){qe||(re(n.$$.fragment,e),re(We),re(Ke),re(Je),qe=!0)},o(e){ie(n.$$.fragment,e),ie(We),ie(Ke),ie(Je),qe=!1},d(e){e&&k(t),ge(n);for(let e=0;e<ze.length;e+=1)ze[e].d();We&&We.d(),Ke&&Ke.d(),Je&&Je.d(),He=!1,a(Ae)}}}function ut(e,t,n){let l,a,s;u(e,je,(e=>n(31,l=e))),u(e,Se,(e=>n(3,a=e))),u(e,Ce,(e=>n(4,s=e)));const r=function(e){console.log(e),e.preventDefault(),"Index"!=l&&n(0,o=!o)};let i,o=!1,c="collection";let d=De.role[a.role](a.lv);const m=[{type:"maxHealth",name:"最大生命值",detail:"显而易见，生命值不会超过这个数。",data:d.health},{type:"attack",name:"攻击力",detail:"所有攻击都以这个数为基础。不过也有例外。",data:d.attack},{type:"speed",name:"敏捷",detail:"决定了回合中行动的自由度，速度快，能做的事也就会更多呢。",data:d.speed},{type:"power",name:"灵力",detail:"使用普通攻击要消耗1灵力，符卡则消耗3，每回合初都会回复至上限。",data:d.power},{type:"health",name:"生命值",detail:"必须不让它归零才行。",data:a.health},{type:"sugar",name:"糖",detail:"面临选择时可用选项的数量。",data:a.sugar},{type:"level",name:"等级",detail:"等级越高越强大，只能通过战斗提升等级。",data:a.lv},{type:"chance",name:"残机",detail:"战败时消耗1残机回溯到战斗前，回复全部生命值并获得补给。",data:a.chance}];return[o,c,i,a,s,[{x:50,y:0},{x:35.4,y:-35.4},{x:0,y:-50},{x:-35.4,y:-35.4},{x:-50,y:0},{x:-35.4,y:35.4},{x:0,y:50},{x:35.4,y:35.4}],m,r,function(e){i=e,n(2,i)},e=>i.show(),(e,t)=>i.move(t,e,"blue"),e=>i.hide(),e=>i.show(),e=>i.move(e,Pe[a.role],"blue"),e=>i.hide(),e=>{n(0,o=!1)},e=>n(1,c="collection"),e=>n(1,c="spellcards"),e=>n(1,c="consumable"),e=>i.show(),(e,t)=>i.move(t,Fe[e],Fe[e].type),e=>i.hide(),e=>i.show(),(e,t)=>i.move(t,Re[e],"blue"),e=>i.hide(),e=>i.show(),e=>i.move(e,Be[a.equipment],"gold"),e=>i.hide(),e=>i.show(),e=>i.move(e,Ne[a.souvenir],"purple"),e=>i.hide()]}class dt extends be{constructor(e){super(),_e(this,e,ut,ct,i,{menu:7},null,[-1,-1])}get menu(){return this.$$.ctx[7]}}var mt=["啊啊啊我忘记了","阿吽","阿卡麟","阿空","阿燐","阿求","艾丽","爱丽丝","爱丽丝的魔法书","爱丽丝梦游仙境","爱丽丝威震天","爱莲","爱塔妮缇拉尔瓦","庵我烧了","奥莲姬","八百万之神","八坂神奈子","八分咲","八卦炉","八桥","八意永琳","八云蓝","八云紫","百鬼夜行","白鹭风茗","稗田阿求","百万鬼夜行","百药枡","白玉楼","半白泽","坂田合欢乃","宝宝巴士","抱头蹲防","包子仙","本居小铃","本子仙","彼岸","彼岸归航","比那名居天子","弁弁","博丽","博丽大结界","博丽结界","博丽灵梦","博丽神社","博丽神社例大祭","布都","布嘟嘟","不认识的孩子","不朽的曼珠沙华","擦弹","残机","缠流子","车车人","车万","沉默的兽灵","成美","赤蛮奇","重生","畜生界","畜生们的休息","船幽灵","船长","纯狐","纯妈","茨歌仙","茨木华扇","从地下的归还","萃梦想","萃香","村纱水蜜","大蛾子","大根","大蛤蟆之池","大酱","大结界","大鹫灵","大狸子","大妖精","大玉","弹幕","弹幕射击","弹幕邪天鬼","弹幕战","道中","得点","地底通路","敌机","地灵殿","地狱鸦","掉残","弔姐","吊瓶妖","凋叶棕","丁礼田","丁礼田舞","东方","东方蝉时歌","东方茨歌仙","东方萃梦想","东方大炮弹","东方大往生","东方大战争","东方地灵殿","东方绯想天","东方非想天则","东方封魔录","东方风神录","东方绀珠传","东方刚欲异闻","东方怪绮谈","东方鬼形兽","东方红楼梦","东方红魔乡","东方华烂漫","东方花映冢","东方幻想乡","东方辉针城","东方铃奈庵","东方灵异传","东方梦灵梦","东方梦时空","东方儚月抄","东方凭依华","东方清泉飨","东方求闻口授","东方求闻史纪","东方三月精","东方神灵庙","东方深秘录","东方失去之言","东方四季呗","东方天空璋","东方天上花","东方童楼遥","东方外来韦编","东方文花帖","东方香霖堂","东方心绮楼","东方星莲船","东方妖妖梦","东方萤灯筏","东方樱蝶梦","东方樱神月","东方永夜抄","东方游剧天","东方智灵奇传","东方紫香花","东方醉蝶华","东风谷早苗","动物灵","毒奶","多多良小伞","哆来咪","哆来咪苏伊特","谔谔","噩梦日记","二次创作","二设","二婶子","二岩猯藏","尔子田","尔子田里乃","法界","反魂蝶","芳香","防撞桶","非符","非想天","丰聪耳神子","风见幽香","疯帽子茶会","封魔录","风神录","封兽鵺","风之暗穴","疯中二婶子","符卡","符卡规则","芙兰","芙兰朵露","付丧神","尬舞姐妹","感情的摩天楼","绀珠传","刚欲同盟","刚欲异闻","高丽野阿吽","格斗","宫古芳香","狗椛","固定弹","鼓哥","鼓姐","古明地觉","古明地恋","怪力乱神","怪绮谈","广西烧烤摊老板","广有射怪鸟事","鬼畜妹","袿姬","鬼杰组","鬼杰组组长","鬼人正邪","鬼形兽","果果","过膝袜","航哥","好吗","河城荷取","赫卡","赫卡姐","赫卡提亚","荷取","核融炉","河童","黑谷山女","黑历史","红楼","红美铃","红萌馆","红魔馆","红魔乡","红银","红字本","虎哥","胡桃","冴月麟","椛椛","花开夜","华扇","华扇邸","花映冢","坏苹果","欢姐","幻梦缘起","幻视之夜","幻想万华镜","幻想夏乡","幻想乡","幻想乡空闪姬","幻想乡空战姬","幻想乡少女大战","幻想乡玩家","幻想跃迁实验室","幻缘团","幻月","幻跃团","黄昏立绘","辉夜","慧音","辉针城","辉针城的小人族","魂魄妖忌","魂魄妖梦","火车","霍青娥","火焰猫燐","吉弔","吉弔八千慧","姬海棠果","姬海棠极","姬海棠羽立","鸡妹","寄世界于偶像","键山雏","间歇泉","奖残","奖分","姐贵","结界","禁忌的魔法","矜羯罗","今泉影狼","今天也是好天气","今昔幻想乡","劲牙组","劲牙组组长","堇子","京都幻想剧团","静叶","囧仙","囧仙子","旧地狱遗址","旧都","九十九八桥","九十九弁弁","九天瀑布","菊理","决死符","卡娜安娜贝拉尔","考据党","可悲的人偶","克劳恩","克劳恩皮丝","堀川雷鼓","狂气之瞳","蓝妈","狼女","老娘是最强","乐航","乐囧","蕾蒂","蕾蒂霍瓦特洛克","蕾拉","蕾米","雷咪","蕾米莉亚","例大祭","莉格露","莉格露奈特巴格","骊驹早鬼","莉莉","莉莉白","莉莉黑","莉莉霍瓦特","莉莉卡","里乃","里香","恋恋","莲妈","莲子","铃二","铃瑚","灵力","灵梦","铃奈庵","灵乌路空","铃仙","铃仙二号","灵异传","灵知的太阳信仰","留琴","辘轳首","露米娅","露娜","露娜切露德","露娜萨","露易兹","轮椅战神","萝卜","洛天依","绿头发的爸爸","绿眼的嫉妒","玛艾露贝莉赫恩","玛格特罗依德邸","麻将山","玛露奇","满福神社","馒馒来","毛玉","梅蒂欣梅兰可莉","美国酱","妹红","梅丽","梅莉","美铃","梅露兰","魅魔","梦殿大祀庙","梦时空","梦想天生","梦消失","梦月","儚月抄","梦子","秘封","蜜蜂","秘封厨","秘封噩梦日记","秘封活动记录","秘封组","米国酱","米国小妖精","咪咪号","秘神摩多罗","米斯蒂娅","米斯蒂娅萝蕾拉","迷途之家","迷途竹林","面灵气","绵月丰姬","绵月依姬","苗苗","苗爷","冥界","命莲","命莲寺","明罗","摸多了硬起来","摩多罗","摩多罗隐岐奈","魔法森林","魔法使","魔理沙","摩妈","磨米机","摩托罗拉","摩西的奇迹","娜兹玲","牛妈","牛崎润美","女苑","帕露西","帕琪","帕秋莉","帕秋莉诺蕾姬","判定点","蓬莱人","蓬莱山辉夜","凭依华","琪露诺","骑士之夜","琪斯美","千年幻想乡","桥姬","秦河胜","秦心","青娥","清兰","青蛙子","秋静叶","秋穰子","求闻口授","求闻史纪","犬走椛","穰子","人间之里","人形裁判","人形使","人鱼","戎璎花","入道","乳町","若鹭姬","萨拉","萨丽艾尔","三分咲","三途川","伞妖","三月精","桑尼","桑尼米尔克","骚灵","森近霖之助","山姥","山女","山彦","上白泽慧音","烧烤摊老板","少名针妙丸","少女幻葬","少女绮想曲","射命丸文","社团","神话幻想","神灵","神灵庙","神妈","深秘录","神奈子","神绮","神社闭店之日","神玉","神子","圣白莲","圣德传说","圣德太子","圣德太子的马","圣德太子的天马","圣莲船","生死之境","世界美咲剧场","十六夜","十六夜咲夜","矢田寺成美","兽道","寿命论","兽娘幻想入","兽人","守矢神社","双七","水桥帕露西","水獭灵","四重存在","四季","四季大人","四季撒吗","四季撒吗我有罪","四季映姬","斯卡雷特","死灵","死神","四十米大刀","斯塔","斯塔萨菲娅","死亡幻想曲","寺子屋","苏格拉底","苏我屠自古","随机弹","砕月","碎月","太田顺也","太阳花田","太子的马","探女","探女老仙","陶瓷的杖刀人","藤原妹红","天狗","天空璋","天人","天探女","天邪鬼","天子","条纹过膝袜","庭渡久侘歌","同人","土蜘蛛","土著信仰","屠自古","豚乙女","外界","外来人","外来韦编","亡灵","威严满满","胃炎满满","文花帖","文文","我会自己上厕所","我做东方鬼畜音","物部布都","五分咲","无何有之乡","无名之丘","雾雨","雾雨魔理沙","无缘冢","雾之湖","稀神探女","西行寺幽幽子","吸血鬼","下压","仙界","现界","仙人","现世的秘术师","香霖堂","乡长","响子","消弹","小町","小恶魔","小老帝","小铃","小米弹","小人族","小伞","小桶","小兔姬","小碗","小五","咲夜","小野冢小町","泄矢诹访子","心酱","心绮楼","心之所在","星莲船","星条旗的小丑","星熊杯","星熊勇仪","幸运与不幸","星之器","续关","玄武之泽","玄爷","玄云海","阎魔","妖虫","妖怪狸","妖怪鼠","妖怪之山","妖精","妖精大战争","妖梦","妖兽","妖兔","妖妖跋扈","妖妖梦","鵺酱","野狼灵","野蛮至极","爷们红","夜雀","爷是恋恋","一般通过","一般通过山女","异变","伊吹萃香","伊吹瓢","伊吹西瓜","一分咲","衣玖","依莉斯","一轮","一设","依神女苑","依神紫苑","易者","引弹","因幡帝","因幡天为","隐匿的四季","隐岐奈","寅丸星","阴阳玉","樱花樱花","影狼","永动之龛","永江衣玖","永琳","永夜抄","勇仪","永远的春梦","永远的满月","永远亭","幽闭星光","有顶天","幽谷响子","幽幻魔眼","油库里","幽灵","幽冥结界","幽香","幽幽子","御伽之国的鬼岛","玉米棒子","欲望加速","宇佐见堇子","宇佐见莲子","原点组","原始的节拍","远野幻想物语","越共","乐器妖怪","月人","月时计","月兔","月之都","云居一轮","云山","再思之道","早鬼","早苗","杖刀偶磨弓","长者","折返","这是好的","真吉八弔","针妙丸","正邪","埴安神袿姬","智灵奇传","埴轮兵长","中弹","终符","朱鹭子","竹取飞翔","转转","壮族大妈","自机","自机狙","紫老太","紫妈","紫妹","紫奶奶","紫婆婆","紫香花","紫苑","诹访湖","诹访子","醉蝶华","佐渡的二岩"];function ft(e,t,n){const l=e.slice();return l[16]=t[n],l[18]=n,l}function ht(e){let t,n,l,a;const s=[vt,pt],r=[];return t=0,n=r[0]=s[0](e),{c(){n.c(),l=S()},m(e,t){r[0].m(e,t),x(e,l,t),a=!0},p(e,t){n.p(e,t)},i(e){a||(re(n),a=!0)},o(e){ie(n),a=!1},d(e){r[0].d(e),e&&k(l)}}}function pt(t){let n,l,a;return{c(){n=M("txt"),n.textContent="Press Any Key",O(n,"class","launch svelte-tuzla3")},m(e,t){x(e,n,t),a=!0},p:e,i(e){a||(l&&l.end(1),a=!0)},o(e){l=ue(n,xe,{duration:250}),a=!1},d(e){e&&k(n),e&&l&&l.end()}}}function vt(e){let t,n,l,a=[],s=new Map,r=[e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10]];const i=e=>e[18];for(let t=0;t<10;t+=1){let n=ft(e,r,t),l=i(n);s.set(l,a[t]=gt(l,n))}return{c(){t=M("div");for(let e=0;e<10;e+=1)a[e].c();O(t,"class","words svelte-tuzla3")},m(e,n){x(e,t,n);for(let e=0;e<10;e+=1)a[e]&&a[e].m(t,null);l=!0},p(e,n){2046&n&&(r=[e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10]],a=fe(a,n,i,1,e,r,s,t,de,gt,null,ft))},i(e){l||(n&&n.end(1),l=!0)},o(e){n=ue(t,xe,{duration:250}),l=!1},d(e){e&&k(t);for(let e=0;e<10;e+=1)a[e].d();e&&n&&n.end()}}}function gt(e,t){let n,l,a,s=t[16].word+"";return{key:e,first:null,c(){n=M("txt"),l=j(s),a=E(),H(n,"left",t[16].x),H(n,"top",t[16].y),H(n,"font-size",26-8*$t()+"px"),H(n,"animation-delay",.2*t[18]+"s"),O(n,"class","svelte-tuzla3"),this.first=n},m(e,t){x(e,n,t),_(n,l),_(n,a)},p(e,a){t=e,2046&a&&s!==(s=t[16].word+"")&&q(l,s),2046&a&&H(n,"left",t[16].x),2046&a&&H(n,"top",t[16].y),2046&a&&H(n,"animation-delay",.2*t[18]+"s")},d(e){e&&k(n)}}}function yt(e){let t;return{c(){t=M("txt"),t.textContent="幻想异闻录",O(t,"class","title svelte-tuzla3")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function _t(t){let n,l,s,r,i,o,c,u,d,m,f;return{c(){n=M("div"),l=M("txt"),l.textContent="开始",s=E(),r=M("txt"),r.textContent="灵感",i=E(),o=M("txt"),o.textContent="设定",c=E(),u=M("txt"),u.textContent="离去",O(l,"class","svelte-tuzla3"),O(r,"class","svelte-tuzla3"),O(o,"class","svelte-tuzla3"),O(u,"class","svelte-tuzla3"),O(n,"class","menu svelte-tuzla3")},m(e,a){x(e,n,a),_(n,l),_(n,s),_(n,r),_(n,i),_(n,o),_(n,c),_(n,u),m||(f=[C(l,"click",t[12]),C(r,"click",t[13])],m=!0)},p:e,i(e){d||J((()=>{d=ce(n,xe,{delay:250,duration:250}),d.start()}))},o:e,d(e){e&&k(n),m=!1,a(f)}}}function bt(e){let t,n,l,a,s,r,i,o,c=!e[0]&&ht(e);let u=yt(e),d=e[0]&&_t(e);return{c(){t=M("div"),c&&c.c(),n=E(),u.c(),l=E(),d&&d.c(),O(t,"class","body svelte-tuzla3")},m(a,s){x(a,t,s),c&&c.m(t,null),_(t,n),u.m(t,null),_(t,l),d&&d.m(t,null),r=!0,i||(o=C(t,"click",e[14],{once:!0}),i=!0)},p(e,[l]){e[0]?c&&(ae(),ie(c,1,1,(()=>{c=null})),se()):c?(c.p(e,l),1&l&&re(c,1)):(c=ht(e),c.c(),re(c,1),c.m(t,n)),e[0]?d?(d.p(e,l),1&l&&re(d,1)):(d=_t(e),d.c(),re(d,1),d.m(t,null)):d&&(d.d(1),d=null)},i(e){r||(re(c),re(d),J((()=>{r&&(s&&s.end(1),a=ce(t,xe,{duration:250}),a.start())})),r=!0)},o(e){ie(c),a&&a.invalidate(),s=ue(t,xe,{duration:250}),r=!1},d(e){e&&k(t),c&&c.d(),u.d(),d&&d.d(),e&&s&&s.end(),i=!1,o()}}}function $t(){return Math.random()}function xt(e,t,n){let l;u(e,je,(e=>n(11,l=e)));let a=!1,s=g(),r=g(),i=g(),o=g(),c=g(),d=g(),f=g(),h=g(),p=g(),v=g();function g(){return{x:-40-160*$t()+"px",y:80-160*$t()+"px",word:mt[Math.floor($t()*mt.length)]}}setTimeout((e=>setInterval((e=>n(1,s=g())),2e3)),0),setTimeout((e=>setInterval((e=>n(2,r=g())),2e3)),200),setTimeout((e=>setInterval((e=>n(3,i=g())),2e3)),400),setTimeout((e=>setInterval((e=>n(4,o=g())),2e3)),600),setTimeout((e=>setInterval((e=>n(5,c=g())),2e3)),800),setTimeout((e=>setInterval((e=>n(6,d=g())),2e3)),1e3),setTimeout((e=>setInterval((e=>n(7,f=g())),2e3)),1200),setTimeout((e=>setInterval((e=>n(8,h=g())),2e3)),1400),setTimeout((e=>setInterval((e=>n(9,p=g())),2e3)),1600),setTimeout((e=>setInterval((e=>n(10,v=g())),2e3)),1800);return[a,s,r,i,o,c,d,f,h,p,v,l,e=>m(je,l="Foreword",l),e=>m(je,l="Afflatus",l),e=>n(0,a=!0)]}class kt extends be{constructor(e){super(),_e(this,e,xt,bt,i,{})}}var wt={sort:["s1","s3","s5"],s1:{title:"一块",detail:"只有一个选择才真正有趣啊！",type:"sugar"},s3:{title:"三块",detail:"那就折衷吧...",type:"sugar"},s5:{title:"五块",detail:"我的控制欲还蛮强的。",type:"sugar"}};function Mt(e,t,n){const l=e.slice();return l[8]=t[n],l[10]=n,l}function jt(e,t){let n,l,a,s,r,i,o,u,d,m,f,h,p,v,g=t[3][t[1]][t[8]].title+"",y=t[3][t[1]][t[8]].detail+"";function b(...e){return t[6](t[8],...e)}return{key:e,first:null,c(){n=M("div"),l=M("img"),s=E(),r=M("a"),i=j(g),o=E(),u=M("div"),d=M("a"),m=j(y),f=E(),c(l.src,a=t[5](t[1],t[8]))||O(l,"src",a),O(l,"class","svelte-1dkcu88"),O(r,"class","svelte-1dkcu88"),O(d,"class","svelte-1dkcu88"),O(u,"class","svelte-1dkcu88"),O(n,"class",h="selection animation_"+(t[0]?"close":"open")+"Selections svelte-1dkcu88"),this.first=n},m(e,t){x(e,n,t),_(n,l),_(n,s),_(n,r),_(r,i),_(n,o),_(n,u),_(u,d),_(d,m),_(n,f),p||(v=C(n,"click",b),p=!0)},p(e,s){t=e,2&s&&!c(l.src,a=t[5](t[1],t[8]))&&O(l,"src",a),2&s&&g!==(g=t[3][t[1]][t[8]].title+"")&&q(i,g),2&s&&y!==(y=t[3][t[1]][t[8]].detail+"")&&q(m,y),1&s&&h!==(h="selection animation_"+(t[0]?"close":"open")+"Selections svelte-1dkcu88")&&O(n,"class",h)},d(e){e&&k(n),p=!1,v()}}}function Et(t){let n,l=[],a=new Map,s=t[4];const r=e=>e[10];for(let e=0;e<s.length;e+=1){let n=Mt(t,s,e),i=r(n);a.set(i,l[e]=jt(i,n))}return{c(){n=M("div");for(let e=0;e<l.length;e+=1)l[e].c();O(n,"class","selections svelte-1dkcu88")},m(e,t){x(e,n,t);for(let e=0;e<l.length;e+=1)l[e]&&l[e].m(n,null)},p(e,[t]){63&t&&(s=e[4],l=fe(l,t,r,1,e,s,a,n,de,jt,null,Mt))},i:e,o:e,d(e){e&&k(n);for(let e=0;e<l.length;e+=1)l[e].d()}}}function St(e,t,n){let l,a;u(e,Ce,(e=>n(7,l=e))),u(e,Se,(e=>n(2,a=e)));let{type:s}=t,{selected:r}=t;const i={sugar:wt,role:Pe};let o=deepCopy(i[s]).sort.rd().slice(0,a.sugar);return e.$$set=e=>{"type"in e&&n(1,s=e.type),"selected"in e&&n(0,r=e.selected)},[r,s,a,i,o,(e,t)=>({role:`/img/role/${l.resource}/${t}.webp`,sugar:"/svg/sugar.svg"}[e]),(e,t)=>{n(0,r=!0);let l="sugar"==s?Number(e.slice(1)):e;["equipment","role","sugar"].includes(s)?m(Se,a[s]=l,a):e in a[s]?m(Se,a[s][l]++,a):m(Se,a[s][l]=1,a)}]}class Ct extends be{constructor(e){super(),_e(this,e,St,Et,i,{type:1,selected:0})}}var Ot={sort:{shrine:{normal:["cirno","lilywhite"],elite:[],boss:[]},forest:{normal:["sunny","lunar","star","eternity"]},moon:{normal:["piece"]}},cirno:{name:"冰之妖精",detail:"冷酷的智者",type:"normal"},piece:{name:"地狱的妖精",detail:"拥有使人发狂程度的能力",type:"normal"},lilywhite:{name:"报春的妖精",detail:"拥有告知春天到来程度的能力",type:"normal"},sunny:{name:"日光的妖精",detail:"拥有操纵光的折射程度的能力",type:"normal"},lunar:{name:"月光的妖精",detail:"拥有消除声音程度的能力",type:"normal"},star:{name:"星光的妖精",detail:"拥有感应到活动事物程度的能力",type:"normal"},eternity:{name:"凤蝶的妖精",detail:"拥有播撒鳞粉程度的能力",type:"normal"}};function qt(e,t,n){const l=e.slice();return l[14]=t[n],l[16]=n,l}function Ht(e){let t,n,l,a=e[14].value+"";return{c(){t=M("txt"),n=j(a),O(t,"class",l=d(e[16]+e[2]==e[1]-1&&"reading")+" svelte-19hh7fi"),H(t,"--length",e[14].value.getByteLen()/2-1),H(t,"width",e[14].value.getByteLen()-2+"ch"),H(t,"--time",(e[16]+e[2]==e[1]-1?.2*(e[14].value.getByteLen()/2-1):0)+"s")},m(e,l){x(e,t,l),_(t,n)},p(e,s){6&s&&a!==(a=e[14].value+"")&&q(n,a),6&s&&l!==(l=d(e[16]+e[2]==e[1]-1&&"reading")+" svelte-19hh7fi")&&O(t,"class",l),6&s&&H(t,"--length",e[14].value.getByteLen()/2-1),6&s&&H(t,"width",e[14].value.getByteLen()-2+"ch"),6&s&&H(t,"--time",(e[16]+e[2]==e[1]-1?.2*(e[14].value.getByteLen()/2-1):0)+"s")},d(e){e&&k(t)}}}function At(e){let t,n,l;function a(t){e[7](t)}let s={type:e[3]};return void 0!==e[0]&&(s.selected=e[0]),t=new Ct({props:s}),D.push((()=>he(t,"selected",a))),{c(){pe(t.$$.fragment)},m(e,n){ve(t,e,n),l=!0},p(e,l){const a={};8&l&&(a.type=e[3]),!n&&1&l&&(n=!0,a.selected=e[0],Q((()=>n=!1))),t.$set(a)},i(e){l||(re(t.$$.fragment,e),l=!0)},o(e){ie(t.$$.fragment,e),l=!1},d(e){ge(t,e)}}}function zt(e){let t,n,l,a,s,r,i,o,c=e[5].slice(e[2],e[1]),u=[];for(let t=0;t<c.length;t+=1)u[t]=Ht(qt(e,c,t));let d=e[3]&&At(e);return{c(){t=M("div"),n=M("div");for(let e=0;e<u.length;e+=1)u[e].c();l=E(),d&&d.c(),O(n,"class","talk svelte-19hh7fi"),O(t,"class","body svelte-19hh7fi")},m(a,s){x(a,t,s),_(t,n);for(let e=0;e<u.length;e+=1)u[e]&&u[e].m(n,null);_(t,l),d&&d.m(t,null),r=!0,i||(o=C(t,"click",e[8]),i=!0)},p(e,[l]){if(38&l){let t;for(c=e[5].slice(e[2],e[1]),t=0;t<c.length;t+=1){const a=qt(e,c,t);u[t]?u[t].p(a,l):(u[t]=Ht(a),u[t].c(),u[t].m(n,null))}for(;t<u.length;t+=1)u[t].d(1);u.length=c.length}e[3]?d?(d.p(e,l),8&l&&re(d,1)):(d=At(e),d.c(),re(d,1),d.m(t,null)):d&&(ae(),ie(d,1,1,(()=>{d=null})),se())},i(e){r||(re(d),J((()=>{r&&(s&&s.end(1),a=ce(t,xe,{duration:250}),a.start())})),r=!0)},o(e){ie(d),a&&a.invalidate(),s=ue(t,xe,{duration:250}),r=!1},d(e){e&&k(t),w(u,e),d&&d.d(),e&&s&&s.end(),i=!1,o()}}}function It(e,t,n){let l,a,s;u(e,Se,(e=>n(9,l=e))),u(e,je,(e=>n(10,a=e))),u(e,Oe,(e=>n(11,s=e)));let r=!1,i=0,o=0,c=null,d=!0,f=[{type:"txt",value:"宇佐见莲子正对着笔记本电脑沉思。"},{type:"txt",value:"“终于要动笔了吗？”梅莉端着咖啡走来。"},{type:"txt",value:"“是啊。”莲子伸了个懒腰。"},{type:"txt",value:"“要加多少糖呢？”"},{type:"selector",value:"sugar"},{type:"txt",value:"“幻想交织在静谧的夜空之下——”莲子写道。"},{type:"txt",value:"“这句话有什么作用吗？”"},{type:"txt",value:"“文、文学的事情，你少管！”"},{type:"txt",value:"“少女坐在破旧的神社中。”她接着写，“其名为——”"},{type:"selector",value:"role"}];function h(){"txt"==f[i].type?n(1,i++,i):r?(n(4,d=!1),setTimeout((e=>{i==f.length-1?function(){const e={enermy:e=>s.enermy.push(Ot.sort[l.scene][e].rd()[0])};e.enermy("normal");let t=De.amount(s.lv);for(let n=0;n<t+10;n++)e.enermy("normal");m(Se,l.spellcards[l.role]=4,l),p(),p(),m(je,a="Explore",a)}():(n(2,o=i+1),n(1,i+=1),n(3,c=null),n(0,r=!1),n(4,d=!0),setTimeout((e=>h()),200))}),1e3)):n(3,c=f[i].value)}function p(){let e=deepCopy(Re).sort[l.role].rd()[0];l.spellcards[e]?m(Se,l.spellcards[e]++,l):m(Se,l.spellcards[e]=1,l)}h();return[r,i,o,c,d,f,h,function(e){r=e,n(0,r)},e=>d&&h()]}class Tt extends be{constructor(e){super(),_e(this,e,It,zt,i,{})}}function Ft(e,t,n){const l=e.slice();return l[7]=t[n],l[9]=n,l}function Bt(e,t){let n,l,a,s,r,i,o,u,m,f,h,p,v,g,y,b,$=Ot[t[7]].name+"",w=Ot[t[7]].detail+"";function S(...e){return t[5](t[9],...e)}return{key:e,first:null,c(){n=M("div"),l=M("img"),s=E(),r=M("div"),i=M("txt"),o=M("span"),o.textContent=`lv.${t[4].lv}`,u=j($),m=E(),f=M("txt"),h=j(w),p=E(),v=M("div"),c(l.src,a=`/img/enermy/${Ot[t[7]].type}/${t[7]}/icon.png`)||O(l,"src",a),O(l,"class","svelte-181igqh"),O(o,"class","svelte-181igqh"),O(i,"class","svelte-181igqh"),O(f,"class","svelte-181igqh"),O(r,"class","enermy-info svelte-181igqh"),O(v,"class",d(`enermy-type enermy_${Ot[t[7]].type}`)+" svelte-181igqh"),O(n,"class",g=d(`enermy ${t[0][t[9]]&&"enermy_selected"}`)+" svelte-181igqh"),this.first=n},m(e,t){x(e,n,t),_(n,l),_(n,s),_(n,r),_(r,i),_(i,o),_(i,u),_(r,m),_(r,f),_(f,h),_(n,p),_(n,v),y||(b=C(n,"click",S),y=!0)},p(e,l){t=e,1&l&&g!==(g=d(`enermy ${t[0][t[9]]&&"enermy_selected"}`)+" svelte-181igqh")&&O(n,"class",g)},d(e){e&&k(n),y=!1,b()}}}function Nt(e){let t,n,l,a,s,r,i,o,c,u,d,m,f,h=[],p=new Map,v=e[4].enermy;const g=e=>e[9];for(let t=0;t<v.length;t+=1){let n=Ft(e,v,t),l=g(n);p.set(l,h[t]=Bt(l,n))}return{c(){t=M("div"),n=M("div"),n.innerHTML="<txt>机遇</txt>",l=E(),a=M("div"),s=M("txt"),s.textContent=`敌人(${e[3]})`,r=E();for(let e=0;e<h.length;e+=1)h[e].c();i=E(),o=M("txt"),o.textContent="战斗",O(n,"class","explore-events svelte-181igqh"),O(s,"class","title svelte-181igqh"),O(o,"class","btn svelte-181igqh"),O(a,"class","explore-enermys svelte-181igqh"),O(t,"class","body explore svelte-181igqh"),H(t,"background-image","url('/img/scene/shrine.webp')")},m(c,u){x(c,t,u),_(t,n),_(t,l),_(t,a),_(a,s),_(a,r);for(let e=0;e<h.length;e+=1)h[e]&&h[e].m(a,null);_(a,i),_(a,o),d=!0,m||(f=C(o,"click",e[6]),m=!0)},p(e,[t]){17&t&&(v=e[4].enermy,h=fe(h,t,g,1,e,v,p,a,de,Bt,i,Ft))},i(e){d||(J((()=>{d&&(u&&u.end(1),c=ce(t,xe,{duration:250}),c.start())})),d=!0)},o(e){c&&c.invalidate(),u=ue(t,xe,{duration:250}),d=!1},d(e){e&&k(t);for(let e=0;e<h.length;e+=1)h[e].d();e&&u&&u.end(),m=!1,f()}}}function Rt(e,t,n){let l,a;u(e,Oe,(e=>n(1,l=e))),u(e,je,(e=>n(2,a=e)));let s=l.enermy.length;const r=deepCopy(l);s>6&&r.enermy.splice(6);let i=r.enermy.map((e=>!1));return[i,l,a,s,r,(e,t)=>n(0,i[e]=!i[e],i),e=>{i.reduce(((e,t)=>e+Number(t)),0)>r.enermyLimit?alert("你最多只能选择四个敌人"):m(je,a="Battle",a),m(Oe,l.target=i,l)}]}class Pt extends be{constructor(e){super(),_e(this,e,Rt,Nt,i,{})}}function Dt(e,t,n){const l=e.slice();return l[17]=t[n],l}function Lt(e,t){let n,l,a,s,r,i,o,u,m,f,h,p,v,g,y=Re[t[4][t[17]]].name+"",b=Re[t[4][t[17]]].detail+"";function $(...e){return t[8](t[17],...e)}return{key:e,first:null,c(){n=M("div"),l=M("img"),s=E(),r=M("txt"),i=j(y),o=E(),u=M("div"),m=M("txt"),f=j(b),h=E(),c(l.src,a=`/svg/spellcard/${t[4][t[17]]}.svg`)||O(l,"src",a),O(l,"class","svelte-4xw2d3"),O(r,"class","svelte-4xw2d3"),O(m,"class","svelte-4xw2d3"),O(u,"class","svelte-4xw2d3"),O(n,"class",p=d(`spellcard ${t[2]==t[17]&&!t[3](t[17])&&"selectedSpellcard"} ${t[3](t[17])&&"animate_useSpellcard"}`)+" svelte-4xw2d3"),this.first=n},m(e,t){x(e,n,t),_(n,l),_(n,s),_(n,r),_(r,i),_(n,o),_(n,u),_(u,m),_(m,f),_(n,h),v||(g=C(n,"click",$),v=!0)},p(e,s){t=e,2&s&&!c(l.src,a=`/svg/spellcard/${t[4][t[17]]}.svg`)&&O(l,"src",a),2&s&&y!==(y=Re[t[4][t[17]]].name+"")&&q(i,y),2&s&&b!==(b=Re[t[4][t[17]]].detail+"")&&q(f,b),14&s&&p!==(p=d(`spellcard ${t[2]==t[17]&&!t[3](t[17])&&"selectedSpellcard"} ${t[3](t[17])&&"animate_useSpellcard"}`)+" svelte-4xw2d3")&&O(n,"class",p)},d(e){e&&k(n),v=!1,g()}}}function Gt(t){let n,l=[],a=new Map,s=t[1];const r=e=>e[17];for(let e=0;e<s.length;e+=1){let n=Dt(t,s,e),i=r(n);a.set(i,l[e]=Lt(i,n))}return{c(){n=M("div");for(let e=0;e<l.length;e+=1)l[e].c();O(n,"class","spellcards svelte-4xw2d3")},m(e,t){x(e,n,t);for(let e=0;e<l.length;e+=1)l[e]&&l[e].m(n,null)},p(e,[t]){31&t&&(s=e[1],l=fe(l,t,r,1,e,s,a,n,de,Lt,null,Dt))},i:e,o:e,d(e){e&&k(n);for(let e=0;e<l.length;e+=1)l[e].d()}}}function Wt(e,t,n){let l,a;u(e,Se,(e=>n(10,a=e)));const s=deepCopy(a),r=g("wanderlust",(e=>null))?3:4,i=[];for(let e in s.spellcards)for(let t=0;t<s.spellcards[e];t++)i.push(e);v("blade_of_yellow_spring",(e=>[...Array(e).keys()].forEach((e=>i.push(s.role)))));let o,c=p(),d=[],m=[],{Selected:f}=t;const h=function(e){let t=r+e;g("wanderlust",(e=>t=r));let l=[];v("blade_of_yellow_spring",(e=>{l=i.map(((e,t)=>t)).splice(-e),d.splice(-e)})),v("blood_book",(e=>t+=e)),n(1,d=d.filter((e=>!m.includes(e)))),c=c.filter((e=>!d.includes(e))).rd(),n(1,d=[...d,...c.splice(0,t-d.length),...l]),c=0==c.length?p():c,n(7,m=[]),n(2,o=null)};function p(){let e=i.map(((e,t)=>t));return v("blade_of_yellow_spring",(t=>e.splice(-t))),e}function v(e,t){e in s.collections&&t(s.collections[e])}function g(e,t){return s.souvenir==e&&t(),s.souvenir==e}return e.$$set=e=>{"Selected"in e&&n(0,f=e.Selected)},e.$$.update=()=>{128&e.$$.dirty&&n(3,l=e=>m.includes(e))},[f,d,o,l,i,e=>n(7,m=[...m,o]),h,m,(e,t)=>{n(2,o=o==e?null:e),n(0,f=i[o])}]}class Kt extends be{constructor(e){super(),_e(this,e,Wt,Gt,i,{Selected:0,used:5,refresh:6})}get used(){return this.$$.ctx[5]}get refresh(){return this.$$.ctx[6]}}var Jt={hypodynamic:{name:"乏力",detail:"回合开始时不回复灵力。生效时层数-1。",expend:!0},"Orrery's_Sun":{name:"太阳仪",detail:"直接攻击在次回合造成120%*1(每层+1)间接伤害。生效时层数-1。",positive:!0,expend:!0},tired:{name:"疲倦",detail:"回合开始时回复灵力减少1(每层+1)。生效时层数-1。",expend:!0},imprisoned:{name:"禁锢",detail:"回合内禁止行动。生效时层数-1。",expend:!0},prophesy:{name:"预言",detail:"闪避接下来的1(每层+1)次攻击。生效时层数-1。每回合初清空。",positive:!0,expend:!0,interim:!0},foresee:{name:"预知",detail:"闪避接下来的1(每层+1)次攻击。生效时层数-1。",positive:!0,expend:!0},interim_barrier:{name:"临时防御结界",detail:"阻挡1(每层+1)点伤害。生效时层数-1。每回合初清空。",positive:!0,interim:!0},barrier:{name:"防御结界",detail:"阻挡1(每层+1)点伤害。生效时层数-1。",positive:!0},Bright_Bitter_Wheel:{name:"幽明的苦轮",detail:"攻击附带60%间接伤害并回复1点灵力",positive:!0,interim:!0},frostbite:{name:"冻伤",detail:""},in_treatment:{name:"治疗中",detail:"回复5%(每层+5%)当前生命值。",positive:!0,interim:!0},burning:{name:"燃烧",detail:"每回合扣除2%(每层+2%)最大生命值。生效时层数-1。",expend:!0},strength_of_wine:{name:"酒劲",detail:"符卡造成的伤害+10%(每层+10%)。每回合初清空。",interim:!0,positive:!0},seal_needle:{name:"封魔针",detail:"造成8(每层-1)次伤害后，攻击对全体敌人附加流血。"},bleed:{name:"流血",detail:"每回合扣除2%(每层+2%)最大生命值。受治疗时移除。"},star:{name:"星星",detail:"天上的星星不装在瓶子里可是会爆炸的！",positive:!0},cursed_wind:{name:"诅咒之风",detail:"接下来的1(每层+1)次攻击会驱散目标身上所有正面效果。生效时层数-1。",positive:!0,expend:!0},tardy:{name:"迟缓",detail:"敏捷变为95%(每层*90%)。生效时层数-1。",expend:!0}};const Qt={cirno:{stage1:{mode:"random"}},piece:{stage1:{mode:"random"}},lilywhite:{stage1:{mode:"random"}},sunny:{stage1:{mode:"random"}},lunar:{stage1:{mode:"random"}},star:{stage1:{mode:"random"}},eternity:{stage1:{mode:"random"}}};var Ut={sort:{cirno:["Perfect_Freeze","Icicle_Fall","Diamond_Blizzard","Minus_K","Frost_Columns"],lilywhite:["Surprise_Spring"]},cirno:{name:"冷气",detail:"对目标造成100%攻击力伤害。",output:{attack:[{type:"scale",value:"100",aim:"one"}]}},Perfect_Freeze:{name:"完美冻结",detail:"50%几率冻结对方一回合，50%几率冻结自己，若自己被冻结，受到的伤害减半。解冻后对目标造成300%攻击力伤害。"},Icicle_Fall:{name:"冰瀑",detail:"一回合无法行动，之后对目标造成600%攻击力伤害。"},Diamond_Blizzard:{name:"钻石风暴",detail:"对目标造成240%攻击力伤害并施加一层缓慢，对自己造成50%攻击力伤害。"},Minus_K:{name:"负K",detail:"接下来一回合，受到伤害会反馈一层冻伤。"},Frost_Columns:{name:"冰袭方阵",detail:"对目标造成200%攻击力伤害并施加两层疲倦。"},Surprise_Spring:{name:"惊喜之春",detail:"随机对目标造成80%到200%攻击力伤害",output:{attack:[{type:"random",typeofRandom:"scale",max:"80",min:"200",aim:"one"}]}}};const Vt={};Object.assign(Vt,Re),Object.assign(Vt,Ut);const Xt={spellcard:Vt,buff:Jt};var Yt=(e,t,n)=>{const l={},a={attack:[],buff:[],heal:[]};e.role&&(e.state=De.role[e.role](e.lv)),"Orrery's_Sun"in e.buff&&(l["Orrery's_Sun"]=[]);const s=deepCopy(Xt.spellcard[n].output);if("buff"in s)for(let e of s.buff)a.buff.push(e);if("attack"in s)for(let t of s.attack)if(t.amount=t.amount?t.amount:1,"Orrery's_Sun"in e.buff)l["Orrery's_Sun"].push(t);else for(let e=0;e<t.amount;e++)a.attack.push(deepCopy(t));return"collections"in e&&(r("vampire's_old_tooth",(e=>0!=a.attack.length&&a.attack.forEach((t=>a.heal.push({type:"value",value:.5*e}))))),r("portable_money_box",(t=>a.attack.forEach((n=>n.value=n.value*(1+.05*t*Math.floor(e.coin/100)))))),r("skyrocket",(t=>n==e.role&&a.attack.forEach((e=>{Zt()<.3&&(e.value=1.5*e.value,a.buff.push({value:"burning",amount:t,aim:"one"}))})))),r("pickled_radish",(t=>e.health/e.state.health>=.95&&n!=e.role&&a.attack.forEach((e=>e.value*=1+.1*t)))),r("bronze_mirror",(e=>a.attack.forEach((t=>Zt()<.25&&a.attack.push({type:t.type,value:.3*t.value*e,aim:"random",critical:!1}))))),r("earthy_spider_wine",(t=>{n==e.role&&(e.buff.strength_of_wine=t)})),r("amulet_of_full_moon",(t=>{Object.keys(e.buff).reduce(((e,t)=>e+(1==Xt.buff[t].positive?0:1)),0)>2&&a.attack.forEach((e=>e.value*=1+.1*t))})),r("compass_cat",(t=>{e.speedGap<0&&a.attack.forEach((e=>e.value*=1+.1*t))})),i("strength_of_wine",(t=>n!=e.role&&a.attack.forEach((e=>e.value*=1+.1*t)))),i("seal_needle",(t=>{t<=0&&(r("seal_needle",(e=>a.buff.push({value:"bleed",amount:e,aim:"all"}))),e.buff.seal_needle+=9)}))),a.attack.forEach((t=>{t.from=e.role?"role":"enermy"})),a.buff.forEach((e=>e.amount=Number(e.amount))),a;function r(t,n){t in e.collections&&n(e.collections[t])}function i(t,n){if(t in e.buff){let l=e.buff[t];!Xt.buff[t].positive&&r("fish_stone",(e=>l-=e)),n(l>=0?l:0),Xt.buff[t].expend&&(1==e.buff[t]?delete e.buff[t]:e.buff[t]--)}}};function Zt(){return Math.random()}function en(t){let n,l,a,s,r,i,o,c,u,d,m,f;return{c(){n=M("div"),l=M("div"),a=E(),s=M("div"),r=E(),i=M("div"),o=E(),c=M("div"),u=E(),d=M("div"),m=E(),f=M("div"),O(l,"class","svelte-3ja3ij"),O(s,"class","svelte-3ja3ij"),O(i,"class","svelte-3ja3ij"),O(c,"class","svelte-3ja3ij"),O(d,"class","svelte-3ja3ij"),O(f,"class","svelte-3ja3ij"),O(n,"class","MarisaAttack svelte-3ja3ij"),H(n,"transform","rotate("+t[0]+"deg)"),H(n,"left",t[1]+"px"),H(n,"top",t[2]+"px")},m(e,t){x(e,n,t),_(n,l),_(n,a),_(n,s),_(n,r),_(n,i),_(n,o),_(n,c),_(n,u),_(n,d),_(n,m),_(n,f)},p:e,i:e,o:e,d(e){e&&k(n)}}}function tn(e){return[360*Math.random(),30+150*Math.random(),50+150*Math.random()]}const nn={marisa:class extends be{constructor(e){super(),_e(this,e,tn,en,i,{})}}};function ln(e,t,n){const l=e.slice();return l[31]=t[n],l[33]=n,l}function an(e,t,n){const l=e.slice();return l[34]=t[n],l[36]=n,l}function sn(e,t,n){const l=e.slice();return l[37]=t[n],l[36]=n,l}function rn(e){let t,n,l=Object.values(e[0][e[33]].buff)[e[36]]+"";return{c(){t=M("txt"),n=j(l),O(t,"class","svelte-2vu2l")},m(e,l){x(e,t,l),_(t,n)},p(e,t){1&t[0]&&l!==(l=Object.values(e[0][e[33]].buff)[e[36]]+"")&&q(n,l)},d(e){e&&k(t)}}}function on(e,t){let n,l,s,r,i,o,u,d=Object.values(t[0][t[33]].buff)[t[36]]>1,m=d&&rn(t);function f(...e){return t[15](t[37],...e)}return{key:e,first:null,c(){n=M("div"),l=M("img"),r=E(),m&&m.c(),i=E(),c(l.src,s="/svg/buff/"+t[37]+".svg")||O(l,"src",s),O(n,"class","svelte-2vu2l"),this.first=n},m(e,a){x(e,n,a),_(n,l),_(n,r),m&&m.m(n,null),_(n,i),o||(u=[C(n,"mouseenter",t[14]),C(n,"mousemove",f),C(n,"mouseleave",t[16])],o=!0)},p(e,a){t=e,1&a[0]&&!c(l.src,s="/svg/buff/"+t[37]+".svg")&&O(l,"src",s),1&a[0]&&(d=Object.values(t[0][t[33]].buff)[t[36]]>1),d?m?m.p(t,a):(m=rn(t),m.c(),m.m(n,i)):m&&(m.d(1),m=null)},d(e){e&&k(n),m&&m.d(),o=!1,a(u)}}}function cn(e){let t,n=[],l=new Map,a=e[4][e[33]].attack;const s=e=>e[36];for(let t=0;t<a.length;t+=1){let r=an(e,a,t),i=s(r);l.set(i,n[t]=un(i,r))}return{c(){for(let e=0;e<n.length;e+=1)n[e].c();t=S()},m(e,l){for(let t=0;t<n.length;t+=1)n[t]&&n[t].m(e,l);x(e,t,l)},p(e,r){272&r[0]&&(a=e[4][e[33]].attack,n=fe(n,r,s,1,e,a,l,t.parentNode,de,un,t,an))},d(e){for(let t=0;t<n.length;t+=1)n[t].d(e);e&&k(t)}}}function un(e,t){let n,l,a,s=t[34].damage.toFixed(1)+"";return{key:e,first:null,c(){n=M("a"),l=j(s),O(n,"class",a="battle-input "+(t[34].critical&&"critical")+" svelte-2vu2l"),H(n,"left",25+150*hn()+"px"),H(n,"top",50+150*hn()+"px"),this.first=n},m(e,t){x(e,n,t),_(n,l)},p(e,r){t=e,16&r[0]&&s!==(s=t[34].damage.toFixed(1)+"")&&q(l,s),16&r[0]&&a!==(a="battle-input "+(t[34].critical&&"critical")+" svelte-2vu2l")&&O(n,"class",a)},d(e){e&&k(n)}}}function dn(e){let t,n,l;var a=nn[e[7].role];return a&&(t=A(a,{})),{c(){t&&pe(t.$$.fragment),n=S()},m(e,a){t&&ve(t,e,a),x(e,n,a),l=!0},p(e,l){if(a!==(a=nn[e[7].role])){if(t){ae();const e=t;ie(e.$$.fragment,1,0,(()=>{ge(e,1)})),se()}a?(t=A(a,{}),pe(t.$$.fragment),re(t.$$.fragment,1),ve(t,n.parentNode,n)):t=null}},i(e){l||(t&&re(t.$$.fragment,e),l=!0)},o(e){t&&ie(t.$$.fragment,e),l=!1},d(e){e&&k(n),t&&ge(t,e)}}}function mn(e,t){let n,l,a,s,r,i,o,u,m,f,h,p,v,g,y,b,$,w,S,q,A,z,I=Ot[t[31]].name+"",T=[],F=new Map,B=Object.keys(t[0][t[33]].buff);const N=e=>e[36];for(let e=0;e<B.length;e+=1){let n=sn(t,B,e),l=N(n);F.set(l,T[e]=on(l,n))}let R=t[4]&&0!=t[4][t[33]].attack.length&&cn(t),P=t[4]&&0!=t[4][t[33]].attack.length&&dn(t);function D(...e){return t[17](t[33],...e)}return{key:e,first:null,c(){n=M("div"),l=M("div"),a=M("img"),i=E(),o=M("txt"),u=j(I),m=E(),f=M("div"),h=M("div"),p=E(),v=M("div");for(let e=0;e<T.length;e+=1)T[e].c();g=E(),y=M("div"),b=E(),R&&R.c(),$=E(),P&&P.c(),w=E(),c(a.src,s=`/img/enermy/${Ot[t[31]].type}/${t[31]}/${t[4]&&0!=t[4][t[33]].attack.length||t[0][t[33]].Health<=0?"hurt":"portrait"}.png`)||O(a,"src",s),O(a,"class",r=d(`${t[4]&&0!=t[4][t[33]].attack.length&&"animate_enermyShake"}`)+" svelte-2vu2l"),O(o,"class","svelte-2vu2l"),O(l,"class","enermy-info svelte-2vu2l"),O(h,"class","enermy-health svelte-2vu2l"),H(h,"visibility",t[0][t[33]].Health/t[0][t[33]].health!=1?"visible":"hidden"),H(h,"background-image",`linear-gradient(90deg, white ${t[0][t[33]].Health/t[0][t[33]].health*100}%, transparent ${t[0][t[33]].Health/t[0][t[33]].health*100}%)`),O(v,"class","enermy-buff svelte-2vu2l"),O(f,"class","enermy-state svelte-2vu2l"),O(y,"class","enermy-aim svelte-2vu2l"),O(n,"class",S=d(`enermy ${!t[6]&&t[1]&&"oneAim"} ${t[0][t[33]].Health<=0&&"animate_enermyOut"} ${t[2]==t[33]&&"orderEnermy"}`)+" svelte-2vu2l"),H(n,"z-index",t[8].length-t[33]),this.first=n},m(e,t){x(e,n,t),_(n,l),_(l,a),_(l,i),_(l,o),_(o,u),_(n,m),_(n,f),_(f,h),_(f,p),_(f,v);for(let e=0;e<T.length;e+=1)T[e]&&T[e].m(v,null);_(n,g),_(n,y),_(n,b),R&&R.m(n,null),_(n,$),P&&P.m(n,null),_(n,w),q=!0,A||(z=C(n,"click",D),A=!0)},p(e,l){t=e,(!q||17&l[0]&&!c(a.src,s=`/img/enermy/${Ot[t[31]].type}/${t[31]}/${t[4]&&0!=t[4][t[33]].attack.length||t[0][t[33]].Health<=0?"hurt":"portrait"}.png`))&&O(a,"src",s),(!q||16&l[0]&&r!==(r=d(`${t[4]&&0!=t[4][t[33]].attack.length&&"animate_enermyShake"}`)+" svelte-2vu2l"))&&O(a,"class",r),(!q||1&l[0])&&H(h,"visibility",t[0][t[33]].Health/t[0][t[33]].health!=1?"visible":"hidden"),(!q||1&l[0])&&H(h,"background-image",`linear-gradient(90deg, white ${t[0][t[33]].Health/t[0][t[33]].health*100}%, transparent ${t[0][t[33]].Health/t[0][t[33]].health*100}%)`),289&l[0]&&(B=Object.keys(t[0][t[33]].buff),T=fe(T,l,N,1,t,B,F,v,de,on,null,sn)),t[4]&&0!=t[4][t[33]].attack.length?R?R.p(t,l):(R=cn(t),R.c(),R.m(n,$)):R&&(R.d(1),R=null),t[4]&&0!=t[4][t[33]].attack.length?P?(P.p(t,l),16&l[0]&&re(P,1)):(P=dn(t),P.c(),re(P,1),P.m(n,w)):P&&(ae(),ie(P,1,1,(()=>{P=null})),se()),(!q||71&l[0]&&S!==(S=d(`enermy ${!t[6]&&t[1]&&"oneAim"} ${t[0][t[33]].Health<=0&&"animate_enermyOut"} ${t[2]==t[33]&&"orderEnermy"}`)+" svelte-2vu2l"))&&O(n,"class",S)},i(e){q||(re(P),q=!0)},o(e){ie(P),q=!1},d(e){e&&k(n);for(let e=0;e<T.length;e+=1)T[e].d();R&&R.d(),P&&P.d(),A=!1,z()}}}function fn(e){let t,n,l,a,s,r,i=[],o=new Map;function c(t){e[13](t)}let u={};void 0!==e[5]&&(u.explain=e[5]),n=new Xe({props:u}),D.push((()=>he(n,"explain",c)));let d=e[8];const m=e=>e[33];for(let t=0;t<d.length;t+=1){let n=ln(e,d,t),l=m(n);o.set(l,i[t]=mn(l,n))}return{c(){t=M("div"),pe(n.$$.fragment),a=E();for(let e=0;e<i.length;e+=1)i[e].c();O(t,"class",s="enermys "+(e[6]&&"allAim")+" svelte-2vu2l")},m(e,l){x(e,t,l),ve(n,t,null),_(t,a);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,null);r=!0},p(e,a){const c={};!l&&32&a[0]&&(l=!0,c.explain=e[5],Q((()=>l=!1))),n.$set(c),511&a[0]&&(d=e[8],ae(),i=fe(i,a,m,1,e,d,o,t,me,mn,null,ln),se()),(!r||64&a[0]&&s!==(s="enermys "+(e[6]&&"allAim")+" svelte-2vu2l"))&&O(t,"class",s)},i(e){if(!r){re(n.$$.fragment,e);for(let e=0;e<d.length;e+=1)re(i[e]);r=!0}},o(e){ie(n.$$.fragment,e);for(let e=0;e<i.length;e+=1)ie(i[e]);r=!1},d(e){e&&k(t),ge(n);for(let e=0;e<i.length;e+=1)i[e].d()}}}function hn(){return Math.random()}function pn(e,t,n){let l,a,s,r;u(e,qe,(e=>n(18,a=e))),u(e,Se,(e=>n(19,s=e))),u(e,Oe,(e=>n(20,r=e)));let{Selected:i}=t,{state:o}=t,{ordered:c}=t,{aimed:d}=t,{critical:f}=t,{killEvent:h}=t;const p={round:function(e,t){e({health:o[t].Health,state:o[t],buff:o[t].buff,input:e=>x(e,t),power:e=>null,index:t}),n(0,o)},output:function(){const e=o.map((e=>e.speed)),t=[];for(let n=0;n<e.length;n++){let n=e.indexOf(Math.max(...e));t.push(n),e[n]=0}return t.map((e=>function(e,t){let n=Math.floor(e/16)+1;return Qt[t][n],"cirno"==t?["cirno","cirno","cirno"]:["Surprise_Spring","Surprise_Spring"]}(g.lv,_[e]).map((t=>({output:Yt(o[e],(e=>m(qe,a=e,a)),t),spellcard:t})))))},input:x,state:e=>o,speedAdv:e=>{let t=p.state().filter((e=>e.Health>0));return p.state().filter((e=>e.Health>0)).reduce(((e,t)=>e+t.speed),0)/t.length},buff:function(e,t){if(!0===e)for(let e in o[t].buff)Jt[e].positive&&delete o[t].buff[e];else{if(!1!==e){let l;return function(e,t,l){t in o[e].buff&&(l(o[e].buff[t]),Jt[t].expend&&(1==o[e].buff[t]?delete o[e].buff[t]:n(0,o[e].buff[t]--,o)))}(t,e,(e=>l=e)),l}for(let e in o[t].buff)!Jt[e].positive&&delete o[t].buff[e]}}};let{role:v}=t;const g=deepCopy(r),y=deepCopy(s),_=g.target.map(((e,t)=>e&&g.enermy[t])).filter((e=>e));o=_.map((e=>{let t=De.enermy[e](g.lv);return t.Health=t.health,t.buff={},t}));let b,$=null;function x(e,t){let l=_.map((e=>({attack:[],buff:[],heal:[]}))),s={heal:[],attack:[],buff:[]},r=[...Array(l.length).keys()],i={one:[t],all:r,else:r.filter((e=>e!=t)),average:r,random:r.filter((e=>o[e].Health>0)).rd().splice(0,1)},c=v.state();for(let t of e.attack){let n=Number(t.value);t.amount=t.amount?t.amount:1,"scale"==t.type&&(n*=.01*c.attack),t.type,"average"==t.aim&&(n/=r.filter((e=>o[e].Health>0)).length);let u=deepCopy(t);u.critical="critical"in u?u.critical:f(u.from);let d=1.5;if("role"==u.from&&w("human_soul_lamp",(e=>d+=.5*e)),u.damage=n*(u.critical?d:1),"self"==t.aim)s.attack.push(u);else for(let n of i[t.aim]){let s=deepCopy(u);v.buff("cursed_wind")&&(p.buff(!0,n),e.buff=e.buff.filter((e=>"self"==e.aim)),m(qe,a.bottle_of_stars=a.bottle_of_stars.filter((e=>e.index!=n)),a)),"rate"==t.type&&(s.damage*=o[n].health),"Rate"==t.type&&(s.damage*=o[n].Health),l[n].attack.push(s)}}for(let t of e.heal)s.heal.push(t);for(let t of e.buff)if("self"==t.aim)s.buff.push({value:t.value,amount:t.amount});else for(let e of i[t.aim])l[e].buff.push(t);let u=function(e){const t={attack:[],buff:[],heal:[]},l=deepCopy(e);return l.forEach(((e,l)=>{for(let s of e.attack)s.indirect&&"role"==s.from&&w("sundial",(e=>s.damage*=1+.1*e)),M("sword_of_feixiang",(e=>{Object.keys(o[l].buff).reduce(((e,t)=>e+Jt[t].positive?0:1),0)>0&&(s.damage*=1.4)})),o[l].Health>0&&o[l].Health-s.damage<=0&&h(l),s.damage>0&&"role"==s.from&&(v.buff("seal_needle"),w("bottle_of_stars",(t=>{if(s.damage>=3*v.state().attack){e.buff.push({value:"star",amount:t}),a.bottle_of_stars||m(qe,a.bottle_of_stars=[],a);for(let e=0;e<t;e++)a.bottle_of_stars.push({index:l,damage:.5*s.damage})}})),w("cursed_wind_chimes",(e=>{s.damage>=6*v.state().attack*Math.pow(.95,e-1)&&t.buff.push({value:"cursed_wind",amount:1})})),M("gongonier",(e=>{s.critical&&t.heal.push({type:"value",value:.2*s.damage})}))),n(0,o[l].Health-=s.damage,o);for(let t of e.heal)k(t+o[l].Health,l),delete o[l].buff.bleed;for(let t of e.buff)n(0,o[l].buff[t.value]=o[l].buff[t.value]?o[l].buff[t.value]+t.amount:t.amount,o)})),n(4,$=l),n(0,o),setTimeout((e=>n(4,$=null)),800),t}(l);for(let e in u)u[e].forEach((t=>s[e].push(t)));return s}function k(e,t){n(0,o[t].Health=e>o[t].health?o[t].health:e,o)}function w(e,t){e in y.collections&&t(y.collections[e])}function M(e,t){y.equipment==e&&t()}return e.$$set=e=>{"Selected"in e&&n(1,i=e.Selected),"state"in e&&n(0,o=e.state),"ordered"in e&&n(2,c=e.ordered),"aimed"in e&&n(3,d=e.aimed),"critical"in e&&n(9,f=e.critical),"killEvent"in e&&n(10,h=e.killEvent),"role"in e&&n(12,v=e.role)},e.$$.update=()=>{2&e.$$.dirty[0]&&n(6,l=null!=i&&"allAim"in Re[i])},[o,i,c,d,$,b,l,y,_,f,h,p,v,function(e){b=e,n(5,b)},e=>b.show(),(e,t)=>b.move(t,Jt[e],Jt[e].positive?"blue":"purple"),e=>b.hide(),(e,t)=>{o[e].Health>0&&i&&d(e)}]}class vn extends be{constructor(e){super(),_e(this,e,pn,fn,i,{Selected:1,state:0,ordered:2,aimed:3,critical:9,killEvent:10,enermy:11,role:12},null,[-1,-1])}get enermy(){return this.$$.ctx[11]}}function gn(e,t,n){const l=e.slice();return l[35]=t[n],l[37]=n,l}function yn(e,t,n){const l=e.slice();return l[38]=t[n],l[37]=n,l}function _n(e,t,n){const l=e.slice();return l[40]=t[n],l[37]=n,l}function bn(e){let t,n,l,s,r,i,o,u=Object.values(e[0])[e[37]]>1,d=u&&$n(e);function m(...t){return e[20](e[40],...t)}return{c(){t=M("div"),n=M("img"),s=E(),d&&d.c(),r=E(),c(n.src,l="/svg/buff/"+e[40]+".svg")||O(n,"src",l),O(t,"class","svelte-16s3vpv")},m(l,a){x(l,t,a),_(t,n),_(t,s),d&&d.m(t,null),_(t,r),i||(o=[C(t,"mouseenter",e[19]),C(t,"mousemove",m),C(t,"mouseleave",e[21])],i=!0)},p(a,s){e=a,1&s[0]&&!c(n.src,l="/svg/buff/"+e[40]+".svg")&&O(n,"src",l),1&s[0]&&(u=Object.values(e[0])[e[37]]>1),u?d?d.p(e,s):(d=$n(e),d.c(),d.m(t,r)):d&&(d.d(1),d=null)},d(e){e&&k(t),d&&d.d(),i=!1,a(o)}}}function $n(e){let t,n,l=Object.values(e[0])[e[37]]+"";return{c(){t=M("txt"),n=j(l),O(t,"class","svelte-16s3vpv")},m(e,l){x(e,t,l),_(t,n)},p(e,t){1&t[0]&&l!==(l=Object.values(e[0])[e[37]]+"")&&q(n,l)},d(e){e&&k(t)}}}function xn(e,t){let n,l,a=Object.values(t[0])[t[37]]>0,s=a&&bn(t);return{key:e,first:null,c(){n=S(),s&&s.c(),l=S(),this.first=n},m(e,t){x(e,n,t),s&&s.m(e,t),x(e,l,t)},p(e,n){t=e,1&n[0]&&(a=Object.values(t[0])[t[37]]>0),a?s?s.p(t,n):(s=bn(t),s.c(),s.m(l.parentNode,l)):s&&(s.d(1),s=null)},d(e){e&&k(n),s&&s.d(e),e&&k(l)}}}function kn(e){let t,n=[],l=new Map,a=e[5].attack;const s=e=>e[37];for(let t=0;t<a.length;t+=1){let r=yn(e,a,t),i=s(r);l.set(i,n[t]=wn(i,r))}return{c(){for(let e=0;e<n.length;e+=1)n[e].c();t=S()},m(e,l){for(let t=0;t<n.length;t+=1)n[t]&&n[t].m(e,l);x(e,t,l)},p(e,r){32&r[0]&&(a=e[5].attack,n=fe(n,r,s,1,e,a,l,t.parentNode,de,wn,t,yn))},d(e){for(let t=0;t<n.length;t+=1)n[t].d(e);e&&k(t)}}}function wn(e,t){let n,l,a,s=t[38].damage.toFixed(1)+"";return{key:e,first:null,c(){n=M("txt"),l=j(s),O(n,"class",a="battle-input "+(t[38].critical&&"critical")+" svelte-16s3vpv"),H(n,"left",90+150*Sn()+"px"),H(n,"top",60*Sn()-40+"px"),this.first=n},m(e,t){x(e,n,t),_(n,l)},p(e,r){t=e,32&r[0]&&s!==(s=t[38].damage.toFixed(1)+"")&&q(l,s),32&r[0]&&a!==(a="battle-input "+(t[38].critical&&"critical")+" svelte-16s3vpv")&&O(n,"class",a)},d(e){e&&k(n)}}}function Mn(e){let t,n=[],l=new Map,a=e[5].heal;const s=e=>e[37];for(let t=0;t<a.length;t+=1){let r=gn(e,a,t),i=s(r);l.set(i,n[t]=jn(i,r))}return{c(){for(let e=0;e<n.length;e+=1)n[e].c();t=S()},m(e,l){for(let t=0;t<n.length;t+=1)n[t]&&n[t].m(e,l);x(e,t,l)},p(e,r){32&r[0]&&(a=e[5].heal,n=fe(n,r,s,1,e,a,l,t.parentNode,de,jn,t,gn))},d(e){for(let t=0;t<n.length;t+=1)n[t].d(e);e&&k(t)}}}function jn(e,t){let n,l,a=t[35].toFixed(1)+"";return{key:e,first:null,c(){n=M("txt"),l=j(a),O(n,"class","battle-heal"),H(n,"left",90+150*Sn()+"px"),H(n,"top",60*Sn()-40+"px"),this.first=n},m(e,t){x(e,n,t),_(n,l)},p(e,n){t=e,32&n[0]&&a!==(a=t[35].toFixed(1)+"")&&q(l,a)},d(e){e&&k(n)}}}function En(e){let t,n,l,s,r,i,o,u,d,m,f,h,p,v,g,y,b,$,w,S,A,z,I,T,F,B,N,R,P,L,G=[],W=new Map,K=e[2].toFixed(0)+"",J=e[1].health+"";function U(t){e[15](t)}let V={};void 0!==e[6]&&(V.explain=e[6]),n=new Xe({props:V}),D.push((()=>he(n,"explain",U)));let X=Object.keys(e[0]);const Y=e=>e[37];for(let t=0;t<X.length;t+=1){let n=_n(e,X,t),l=Y(n);W.set(l,G[t]=xn(l,n))}let Z=e[5]&&"attack"in e[5]&&0!=e[5].attack.length&&kn(e),ee=e[5]&&"heal"in e[5]&&0!=e[5].heal.length&&Mn(e);return{c(){t=M("div"),pe(n.$$.fragment),s=E(),r=M("div"),i=M("div"),o=E(),u=M("img"),m=E(),f=M("div"),h=M("txt"),p=j(e[4]),v=E(),g=M("div");for(let e=0;e<G.length;e+=1)G[e].c();y=E(),b=M("div"),$=M("txt"),w=j(K),S=j(" / "),A=j(J),z=E(),I=M("div"),T=E(),F=M("div"),F.textContent=`${Pe[e[8].role].name}`,B=E(),Z&&Z.c(),N=E(),ee&&ee.c(),H(i,"height",100*(1-e[3]/e[1].power)+"%"),O(i,"class","svelte-16s3vpv"),c(u.src,d=`/img/role/${e[7].resource}/${e[8].role}.webp`)||O(u,"src",d),O(u,"class","svelte-16s3vpv"),O(r,"class","power svelte-16s3vpv"),O(h,"class","svelte-16s3vpv"),O(f,"class","exPower svelte-16s3vpv"),H(f,"visibility",e[4]>0?"visible":"hidden"),O(g,"class","buff svelte-16s3vpv"),O($,"class","health-value svelte-16s3vpv"),H(I,"left",e[2]/e[1].health*100-100+"%"),O(I,"class","svelte-16s3vpv"),O(b,"class","health svelte-16s3vpv"),O(F,"class","state-role svelte-16s3vpv"),O(t,"class","state svelte-16s3vpv")},m(l,a){x(l,t,a),ve(n,t,null),_(t,s),_(t,r),_(r,i),_(r,o),_(r,u),_(t,m),_(t,f),_(f,h),_(h,p),_(t,v),_(t,g);for(let e=0;e<G.length;e+=1)G[e]&&G[e].m(g,null);_(t,y),_(t,b),_(b,$),_($,w),_($,S),_($,A),_(b,z),_(b,I),_(t,T),_(t,F),_(t,B),Z&&Z.m(t,null),_(t,N),ee&&ee.m(t,null),R=!0,P||(L=[C(f,"mouseenter",e[16]),C(f,"mousemove",e[17]),C(f,"mouseleave",e[18])],P=!0)},p(e,a){const s={};!l&&64&a[0]&&(l=!0,s.explain=e[6],Q((()=>l=!1))),n.$set(s),(!R||10&a[0])&&H(i,"height",100*(1-e[3]/e[1].power)+"%"),(!R||128&a[0]&&!c(u.src,d=`/img/role/${e[7].resource}/${e[8].role}.webp`))&&O(u,"src",d),(!R||16&a[0])&&q(p,e[4]),(!R||16&a[0])&&H(f,"visibility",e[4]>0?"visible":"hidden"),65&a[0]&&(X=Object.keys(e[0]),G=fe(G,a,Y,1,e,X,W,g,de,xn,null,_n)),(!R||4&a[0])&&K!==(K=e[2].toFixed(0)+"")&&q(w,K),(!R||2&a[0])&&J!==(J=e[1].health+"")&&q(A,J),(!R||6&a[0])&&H(I,"left",e[2]/e[1].health*100-100+"%"),e[5]&&"attack"in e[5]&&0!=e[5].attack.length?Z?Z.p(e,a):(Z=kn(e),Z.c(),Z.m(t,N)):Z&&(Z.d(1),Z=null),e[5]&&"heal"in e[5]&&0!=e[5].heal.length?ee?ee.p(e,a):(ee=Mn(e),ee.c(),ee.m(t,null)):ee&&(ee.d(1),ee=null)},i(e){R||(re(n.$$.fragment,e),R=!0)},o(e){ie(n.$$.fragment,e),R=!1},d(e){e&&k(t),ge(n);for(let e=0;e<G.length;e+=1)G[e].d();Z&&Z.d(),ee&&ee.d(),P=!1,a(L)}}}function Sn(){return Math.random()}function Cn(e,t,n){let l,a,s;u(e,qe,(e=>n(22,l=e))),u(e,Se,(e=>n(23,a=e))),u(e,Ce,(e=>n(7,s=e)));const r=deepCopy(a);let i={},o=De.role[r.role](r.lv),c=r.health;j("patchouli's_ribbon",(e=>n(1,o.power+=e,o))),j("seal_needle",(e=>n(0,i.seal_needle=8,i))),E("ahab's_opinion",(e=>{n(1,o.health=Math.floor(.7*o.health),o),n(2,c=o.health)}));let d,f=o.power,h="marisa"==r.role?5:0;const p={cost:e=>{let t=f+h-e;return n(4,h=t<=f?0:h-e),t<=f&&n(3,f=t),t},reset:e=>n(3,f=o.power),add:e=>n(4,h+=e),get:e=>f+h};let v;const g=p;let{critical:y}=t;const _={round:function(e){e({health:c,state:o,buff:i,input:k,power:e=>p.reset()}),n(0,i)},input:k,output:function(e){const t=deepCopy(r);return t.state=o,t.buff=i,t.health=c,t.speedGap=_.state().speed-b.speedAdv(),Yt(t,(e=>m(qe,l=e,l)),e)},state:function(e){if(!e){let e=deepCopy(o);return e.Health=c,j("corvis_feathers",(t=>{Object.keys(i).reduce(((e,t)=>e+Jt[t].positive?1:0),0)>=2&&(e.speed+=.05*t)})),M("tardy",(t=>e.speed*=Math.pow(.95,t))),e}for(let t in e)t in o&&n(1,o[t]=e[t],o);"Health"in e&&n(2,c=e.Health)},buff:function(e){if(!0===e)for(let e in i)Jt[e].positive&&delete i[e];if(!1===e)for(let e in i)!Jt[e].positive&&delete i[e];if("seal_needle"!=e){let t;return M(e,(e=>t=e)),t}n(0,i.seal_needle-=1,i)}};let{enermy:b}=t,{killEvent:$}=t,{deadEvent:x}=t;function k(e,t){let l=b.state()[t],a={attack:[],buff:[],heal:[]},s={heal:[],attack:[],buff:[]};for(let t of e.attack){let e=Number(t.value);t.amount=t.amount?t.amount:1,"scale"==t.type&&(e*=.01*l.attack),t.type,t.aim;let n=deepCopy(t);n.critical="critical"in n?n.critical:y(n.from);let r=1.5;"role"==n.from&&j("human_soul_lamp",(e=>r+=.5*e)),n.damage=e*(n.critical?r:1),"self"==t.aim?s.attack.push(n):("rate"==t.type&&(n.damage*=o.health),"Rate"==t.type&&(n.damage*=c),a.attack.push(n))}for(let t of e.heal)"value"==t.type&&a.heal.push(t.value),"rate"==t.type&&a.heal.push(t.value*o.health),"Rate"==t.type&&a.heal.push(t.value*c);for(let t of e.buff)"self"==t.aim?s.buff.push({value:t.value,amount:t.amount}):a.buff.push(t);let u=function(e){const t={attack:[],buff:[],heal:[]},l=deepCopy(e);for(let e of l.attack)j("mimosa",(t=>{let n=3*o.attack*Math.pow(.95,t-1);e.damage>n&&(e.damage=n)})),E("noda's_hat",(t=>{e.damage*=c/o.health>.5?1.2:.7})),j("conch_shell",(t=>e.damage-=t)),e.damage<0&&(e.damage=0),M("barrier",(t=>{t>e.damage?(n(0,i.barrier-=Math.ceil(e.damage),i),e.damage=0):(e.damage-=t,delete i.barrier)})),M("interim_barrier",(t=>{t>e.damage?(n(0,i.interim_barrier-=Math.ceil(e.damage),i),e.damage=0):(e.damage-=t,delete i.interim_barrier)})),E("microlithic_fish",(t=>{Sn()<.7&&e.damage>0?l.buff.push({value:["burning","bleed","tired","tardy"].rd()[0],amount:1}):e.damage=0})),n(2,c-=e.damage),j("magic_dart",(n=>{e.damage>0&&t.attack.push({value:(.2+.1*(n-1))*e.damage,type:"real",aim:"one",indirect:!0,from:"role"})})),j("large_roll_of_bandages",(t=>{e.damage>0&&n(0,i.in_treatment=t,i)})),j("red_and_white_scarf",(t=>{c/r.health>.3*Math.pow(.9,t-1)&&c-e.damage<=0&&(e.damage=c-1)})),j("fox_jade",(t=>{e.damage/o.health>=.4*Math.pow(.95,t-1)&&$()})),c<=0&&x();for(let e of l.heal)w(e+c),e+c>o.health&&j("cherry",(t=>l.buff.push({value:"interim_barrier",amount:Math.ceil(.2*(e+c-o.health)*t)}))),delete i.bleed;for(let e of l.buff)n(0,i[e.value]=i[e.value]?i[e.value]+e.amount:e.amount,i);return n(5,d=l),setTimeout((e=>n(5,d=null)),800),t}(a);for(let e in u)u[e].forEach((t=>s[e].push(t)));return s}function w(e){n(2,c=e>o.health?o.health:e)}function M(e,t){if(e in i){let l=i[e];!Jt[e].positive&&j("fish_stone",(e=>l-=e)),t(l>=0?l:0),Jt[e].expend&&(1==i[e]?delete i[e]:n(0,i[e]--,i))}}function j(e,t){e in r.collections&&t(r.collections[e])}function E(e,t){return r.souvenir==e&&t(),r.souvenir==e}return e.$$set=e=>{"critical"in e&&n(10,y=e.critical),"enermy"in e&&n(12,b=e.enermy),"killEvent"in e&&n(13,$=e.killEvent),"deadEvent"in e&&n(14,x=e.deadEvent)},[i,o,c,f,h,d,v,s,r,g,y,_,b,$,x,function(e){v=e,n(6,v)},e=>v.show(),e=>v.move(e,{name:"额外灵力",detail:"等同于灵力，优先消耗。"},"blue"),e=>v.hide(),e=>v.show(),(e,t)=>v.move(t,Jt[e],Jt[e].positive?"blue":"purple"),e=>v.hide()]}class On extends be{constructor(e){super(),_e(this,e,Cn,En,i,{Power:9,critical:10,role:11,enermy:12,killEvent:13,deadEvent:14},null,[-1,-1])}get Power(){return this.$$.ctx[9]}get role(){return this.$$.ctx[11]}}function qn(e,t,n){const l=e.slice();return l[6]=t[n],l[8]=n,l}function Hn(e,t){let n,l,a,s,r,i,o,u,m,f,h,p,v,g,y,b,$=Ut[t[6].spellcard].detail+"",w=Ut[t[6].spellcard].name+"",S=t[8]+1+"";return{key:e,first:null,c(){n=M("div"),l=M("div"),a=M("txt"),s=j($),r=E(),i=M("txt"),o=j(w),u=E(),m=M("img"),h=E(),p=M("txt"),v=j(S),g=E(),O(a,"class","title svelte-hs30wb"),O(i,"class","detail svelte-hs30wb"),O(l,"class","svelte-hs30wb"),c(m.src,f=`/img/enermy/${Ot[t[2][t[6].enermy]].type}/${t[2][t[6].enermy]}/icon.png`)||O(m,"src",f),O(m,"class","svelte-hs30wb"),O(p,"class","svelte-hs30wb"),O(n,"class",y=d(t[2][t[6].enermy])+" svelte-hs30wb"),O(n,"style",b=t[1]&&`animation-delay:${.5/(t[0].length-1)*(t[0].length-1-t[8])}s`),this.first=n},m(e,t){x(e,n,t),_(n,l),_(l,a),_(a,s),_(l,r),_(l,i),_(i,o),_(n,u),_(n,m),_(n,h),_(n,p),_(p,v),_(n,g)},p(e,l){t=e,1&l&&$!==($=Ut[t[6].spellcard].detail+"")&&q(s,$),1&l&&w!==(w=Ut[t[6].spellcard].name+"")&&q(o,w),1&l&&!c(m.src,f=`/img/enermy/${Ot[t[2][t[6].enermy]].type}/${t[2][t[6].enermy]}/icon.png`)&&O(m,"src",f),1&l&&S!==(S=t[8]+1+"")&&q(v,S),1&l&&y!==(y=d(t[2][t[6].enermy])+" svelte-hs30wb")&&O(n,"class",y),3&l&&b!==(b=t[1]&&`animation-delay:${.5/(t[0].length-1)*(t[0].length-1-t[8])}s`)&&O(n,"style",b)},d(e){e&&k(n)}}}function An(t){let n,l,a=[],s=new Map,r=t[0];const i=e=>e[8];for(let e=0;e<r.length;e+=1){let n=qn(t,r,e),l=i(n);s.set(l,a[e]=Hn(l,n))}return{c(){n=M("div");for(let e=0;e<a.length;e+=1)a[e].c();O(n,"class",l="record "+(t[1]&&"clear")+" svelte-hs30wb")},m(e,t){x(e,n,t);for(let e=0;e<a.length;e+=1)a[e]&&a[e].m(n,null)},p(e,[t]){7&t&&(r=e[0],a=fe(a,t,i,1,e,r,s,n,de,Hn,null,qn)),2&t&&l!==(l="record "+(e[1]&&"clear")+" svelte-hs30wb")&&O(n,"class",l)},i:e,o:e,d(e){e&&k(n);for(let e=0;e<a.length;e+=1)a[e].d()}}}function zn(e,t,n){let l;u(e,Oe,(e=>n(4,l=e)));let a=[],s=!1;const r={add:e=>n(0,a=[...a,e]),clear:e=>{n(1,s=!0),setTimeout((e=>{n(0,a=[]),n(1,s=!1)}),500)}},i=deepCopy(l),o=i.target.map(((e,t)=>e&&i.enermy[t])).filter((e=>e));return[a,s,o,r]}class In extends be{constructor(e){super(),_e(this,e,zn,An,i,{record:3})}get record(){return this.$$.ctx[3]}}function Tn(e){let t,n,l,s,r,i,o,u,m,f,h,p,v,g,y,b,$,w,j,S,q,A,z,I,T,F,B,N,R,P,L,G,W,K,U,V,X,Y,Z,ee;function te(t){e[17](t)}let ne={Selected:e[1],aimed:e[11],ordered:e[3],critical:e[15],killEvent:e[13],role:e[6]};function le(t){e[18](t)}void 0!==e[7]&&(ne.enermy=e[7]),l=new vn({props:ne}),D.push((()=>he(l,"enermy",te)));let ae={};function se(t){e[19](t)}function oe(t){e[20](t)}function de(t){e[21](t)}void 0!==e[8]&&(ae.record=e[8]),i=new In({props:ae}),D.push((()=>he(i,"record",le)));let me={};function fe(t){e[22](t)}function ye(t){e[23](t)}void 0!==e[0]&&(me.used=e[0]),void 0!==e[1]&&(me.Selected=e[1]),void 0!==e[2]&&(me.refresh=e[2]),m=new Kt({props:me}),D.push((()=>he(m,"used",se))),D.push((()=>he(m,"Selected",oe))),D.push((()=>he(m,"refresh",de)));let _e={critical:e[15],killEvent:e[13],deadEvent:e[14],enermy:e[7]};return void 0!==e[5]&&(_e.Power=e[5]),void 0!==e[6]&&(_e.role=e[6]),g=new On({props:_e}),D.push((()=>he(g,"Power",fe))),D.push((()=>he(g,"role",ye))),{c(){t=M("div"),n=M("div"),pe(l.$$.fragment),r=E(),pe(i.$$.fragment),u=E(),pe(m.$$.fragment),v=E(),pe(g.$$.fragment),$=E(),w=M("div"),j=M("div"),j.innerHTML='<img src="/svg/consumables.svg" class="svelte-1w6dg3m"/> \n        <txt class="svelte-1w6dg3m">消耗品</txt>',S=E(),q=M("div"),q.innerHTML='<img src="/svg/back.svg" class="svelte-1w6dg3m"/> \n        <txt class="svelte-1w6dg3m">回溯</txt>',A=E(),z=M("div"),I=M("img"),F=E(),B=M("txt"),B.textContent=`${e[10].equipment?Be[e[10].equipment].name:"空"}`,N=E(),R=M("div"),P=M("txt"),P.textContent="结束回合",G=E(),W=M("div"),K=M("div"),O(j,"class","consumables svelte-1w6dg3m"),O(q,"class","back svelte-1w6dg3m"),c(I.src,T="/svg/equipment/"+(e[10].equipment?e[10].equipment:"empty")+".svg")||O(I,"src",T),O(I,"class","svelte-1w6dg3m"),O(B,"class","svelte-1w6dg3m"),O(z,"class","equipment svelte-1w6dg3m"),O(P,"class","svelte-1w6dg3m"),O(R,"class",L=d(`end ${!e[4]&&"outRound"}`)+" svelte-1w6dg3m"),O(w,"class","action svelte-1w6dg3m"),O(n,"class","battle svelte-1w6dg3m"),O(W,"class","barrier body"),H(W,"z-index",e[9]?5:-1),O(t,"class",U="body "+e[10].role+" "+e[1]+" "+e[9]+" svelte-1w6dg3m"),H(t,"background-image","url('/img/scene/"+e[10].scene+".webp')")},m(a,s){x(a,t,s),_(t,n),ve(l,n,null),_(n,r),ve(i,n,null),_(n,u),ve(m,n,null),_(n,v),ve(g,n,null),_(n,$),_(n,w),_(w,j),_(w,S),_(w,q),_(w,A),_(w,z),_(z,I),_(z,F),_(z,B),_(w,N),_(w,R),_(R,P),_(t,G),_(t,W),_(W,K),Y=!0,Z||(ee=[C(q,"click",Fn),C(z,"click",e[24]),C(R,"click",e[25])],Z=!0)},p(e,n){const a={};2&n[0]&&(a.Selected=e[1]),8&n[0]&&(a.ordered=e[3]),64&n[0]&&(a.role=e[6]),!s&&128&n[0]&&(s=!0,a.enermy=e[7],Q((()=>s=!1))),l.$set(a);const r={};!o&&256&n[0]&&(o=!0,r.record=e[8],Q((()=>o=!1))),i.$set(r);const c={};!f&&1&n[0]&&(f=!0,c.used=e[0],Q((()=>f=!1))),!h&&2&n[0]&&(h=!0,c.Selected=e[1],Q((()=>h=!1))),!p&&4&n[0]&&(p=!0,c.refresh=e[2],Q((()=>p=!1))),m.$set(c);const u={};128&n[0]&&(u.enermy=e[7]),!y&&32&n[0]&&(y=!0,u.Power=e[5],Q((()=>y=!1))),!b&&64&n[0]&&(b=!0,u.role=e[6],Q((()=>b=!1))),g.$set(u),(!Y||16&n[0]&&L!==(L=d(`end ${!e[4]&&"outRound"}`)+" svelte-1w6dg3m"))&&O(R,"class",L),(!Y||512&n[0])&&H(W,"z-index",e[9]?5:-1),(!Y||514&n[0]&&U!==(U="body "+e[10].role+" "+e[1]+" "+e[9]+" svelte-1w6dg3m"))&&O(t,"class",U)},i(e){Y||(re(l.$$.fragment,e),re(i.$$.fragment,e),re(m.$$.fragment,e),re(g.$$.fragment,e),J((()=>{Y&&(X&&X.end(1),V=ce(t,xe,{duration:250}),V.start())})),Y=!0)},o(e){ie(l.$$.fragment,e),ie(i.$$.fragment,e),ie(m.$$.fragment,e),ie(g.$$.fragment,e),V&&V.invalidate(),X=ue(t,xe,{duration:250}),Y=!1},d(e){e&&k(t),ge(l),ge(i),ge(m),ge(g),e&&X&&X.end(),Z=!1,a(ee)}}}const Fn=e=>null;function Bn(e,t,n){let l,a;u(e,qe,(e=>n(28,l=e))),u(e,Se,(e=>n(29,a=e)));const s=deepCopy(a),i=new window.RAF;let o,c,d,f,h,p,v,g,y,_=!0,b=!1,$=1;var x;function k(){!function(){let e={buff:[],attack:[],heal:[]};S("ghost_lantern",(t=>e.buff.push({value:"interim_barrier",amount:Math.ceil(.05*p.state().health*t)*h.get()}))),p.input(e)}(),n(4,_=!1),g.clear();const e=200,t=v.output(),l=deepCopy(t),a=[{handle:!1,time:2}];let s=i.setInterval((e=>{if(a[0].time-=1,0==a[0].time){a[0].handle&&a[0].handle();const e=l.filter((e=>e)),r=l.length-e.length;y?i.clearInterval(s):0==e.length?(i.clearInterval(s),i.setTimeout((e=>{n(3,f=null),n(4,_=!0)}),400),i.setTimeout((e=>{p.round(w),d(M())}),800)):0==e[0].length?a.push({handle:e=>l[r]=!1,time:6}):(e[0].length==t[r].length&&i.setTimeout((e=>{n(3,f=r),v.round(w,r)}),400),a.push({handle:t=>{v.state()[r].Health<=0?l[r]=!1:(v.input(p.input(e[0][0].output,r),r),g.add({enermy:r,spellcard:e[0][0].spellcard}),e[0].shift())},time:v.state()[r].Health>0?6:1})),a.shift()}}),e)}function w(e){const t={heal:[],attack:[],buff:[]};let n,a=e.state.power;E(e,"in_treatment",(e=>t.heal.push({type:"Rate",value:.05*e}))),E(e,"burning",(e=>t.attack.push({value:.02*e,type:"rate",indirect:!0,critical:!1,aim:"one"}))),E(e,"bleed",(e=>t.attack.push({value:.02*e,type:"rate",indirect:!0,critical:!1,aim:"one"}))),E(e,"hypodynamic",(e=>n=1)),E(e,"star",(n=>{l.bottle_of_stars.filter((t=>t.index==e.index)).forEach((e=>t.attack.push({type:"real",value:e.damage,aim:"one",from:"role",indirect:!0,critical:!1}))),m(qe,l.bottle_of_stars=l.bottle_of_stars.filter((t=>t.index!=e.index)),l)})),(t.heal.length>0||t.attack.length>0)&&e.input(t);for(let t in e.buff)Jt[t].interim&&delete e.buff[t];!n&&e.power(a),!n&&a&&"marisa"==s.role&&h.add(5),O("wanderlust",(e=>a&&h.add(Math.floor(p.state().speed))))}function M(){let e=v.state().filter((e=>e.Health>0)),t=e.reduce(((e,t)=>e+t.speed),0)/e.length,n=Math.abs(p.state().speed-t),l=n-parseInt(n),a=parseInt(n)+Number(r()<l);return p.state().speed>t?a:-a}function j(){if($>0){const e={attack:[],buff:[],heal:[]};let t=!0;C("mini_bagua_stove",(t=>{e.attack.push({value:400,type:"scale",aim:"all"})})),C("louguanjian",(t=>{e.attack.push({value:.2,type:"Rate",aim:"all"})})),C("hd_camera",(e=>{v.state().map(((e,t)=>v.buff(!0,t))),m(qe,l.bottle_of_stars=[],l)})),C("sunshade",(n=>{let l=p.state().Health-.3*p.state().health;l>0?(p.state({Health:l}),e.buff.push({value:"barrier",amount:Math.ceil(.6*p.state().health),aim:"self"})):(msg({content:"不满足使用条件"}),t=!1)})),p.input(v.input(e)),t&&$--}else msg({content:"可使用次数已用尽"})}function E(e,t,n){if(t in e.buff){let l=e.buff[t];e.role&&!Jt[t].positive&&S("fish_stone",(e=>l-=e)),n(l>=0?l:0),Jt[t].expend&&(1==e.buff[t]?delete e.buff[t]:e.buff[t]--),"star"==t&&delete e.buff[t]}}function S(e,t){e in s.collections&&t(s.collections[e])}function C(e,t){s.equipment==e&&t()}function O(e,t){return s.souvenir==e&&t(),s.souvenir==e}x=e=>{b||(d(M()),b=!0)},R().$$.after_update.push(x),S("philosopher's_stone",(e=>$+=e));return[o,c,d,f,_,h,p,v,g,y,s,function(e){let t=c==s.role?1:3;if(C("mirror_of_pear",(e=>t=c==s.role?0:t)),O("mimicry_cat_pendant",(e=>{p.state({Health:p.state().Health*(1-.1*t)}),t=0})),_)if(t>h.get())msg({content:"灵力不足"});else{o(),h.cost(t);let l=v.input(p.output(c),e);p.input(l,e),n(1,c=null)}else msg({content:"不在你的回合"})},k,function(e){const t={attack:[],heal:[],buff:[]};S("bird_wine",(e=>t.buff.push({value:"burning",amount:e,aim:"all"}))),v.input(t),S("crown_of_thorns",(e=>h.add(e))),v.state().filter((e=>e.Health>0)).length<=1&&i.setTimeout((e=>{msg({content:"胜利"})}),1200)},function(e){msg({content:"失败"}),n(9,y="dead")},function(e){let t=.05;if("role"==e){let e=p.state();S("burning_seashore_flower",(n=>t+=Math.floor((e.health-e.Health)/e.health*100)*(.005+.0025*(n-1)))),S("fluorescent_zanthoxylum",(e=>t+=.05*e)),"youmu"==s.role&&(t=0)}return r()<t},j,function(e){v=e,n(7,v)},function(e){g=e,n(8,g)},function(e){o=e,n(0,o)},function(e){c=e,n(1,c)},function(e){d=e,n(2,d)},function(e){h=e,n(5,h)},function(e){p=e,n(6,p)},e=>j(),e=>_&&k()]}class Nn extends be{constructor(e){super(),_e(this,e,Bn,Tn,i,{},null,[-1,-1])}}var Rn={collection:{portable_money_box:"她经常要暴打妖怪，解决异变，人们很尊敬她。\n但那神社在人迹罕至的山里头。\n对了，随身带着赛钱箱不就好了。",bronze_mirror:"“这是我在竹林里捡到的镜子。”\n“应该叫毛玻璃？是半透明的。还很糊。”\n“但如果像这样对它发射一束光线。”\n“光线居然同时发生了穿透和反射！”\n“不过它的折射角度我就没法控制就是了。”",mimosa:"“老师快看呀，这棵含羞草只有三片叶子！”\n“碰一下试试？”\n叶子收拢了，相邻的那两片叶子靠在了一起。\n“那片叶子好孤独……”\n“但它坚持了该做的事。”",compass_cat:"“稀客啊。”\n“你居然还养了猫。”\n“你那不也有两只兔子。”\n“我总是觉得猫的眼睛……很像指南针。”\n“它在竹林里也不会迷路呢。”\n“那就给它起名叫罗盘猫吧。”\n“不要。”",bird_wine:"“我感觉到了，这节竹子里有东西。”\n“雀酒！”\n“也可能是青蛙？”\n“青蛙！”",frozen_frog:"敬请期待",fluorescent_zanthoxylum:"敬请期待",corvis_feathers:"“哇——哇——”\n“这乌鸦好烦。”\n一颗石子丢了过去，但树上只落下一根羽毛。\n“啊呀，乌鸦可是能预言凶兆，带来吉祥的哦。”\n“真不巧，我就是凶兆本人，连我妹妹都奈何不了我。”\n“这样啊，乌鸦的羽毛或许能抵消一些不幸，试试？”\n“嗯。”\n“噢，这根不行，这是我身上的。”",sundial:"“这是，日晷？”\n“在红雾之下的话，要用特别的方法才能知道时间。”\n“也就是说用不上了？说起来我家那片森林也见不到阳光呢。”\n“不行。”\n“那这个我也借走啦。”\n“老鼠。”",pickled_radish:"敬请期待",conch_shell:"“我在藏书的仓库里发现了这个。”\n“是海螺壳呢。”\n“幻想乡有海吗？”\n“月亮上，有的。”\n“我父亲居然上过月球。”\n“但那海里没有生命呢。”\n“难不成......”\n“嗯，是陶瓷的。”\n",cursed_wind_chimes:"“不是刮着风吗，这风铃怎么不会响。”\n“被诅咒了。或者成精了。”\n“也就是说，要做点驱魔仪式什么的吗？”\n“不，要是哪一天突然跑出来一个付丧神，我就不用自己打扫神社了。”\n“真懒呀。”\n“你家可比我这糟蹋多了。”\n“啰嗦。”",ghost_lantern:"敬请期待","vampire's_old_tooth":"前端略尖的牙齿。\n“她小时候换牙换下来的旧牙，我一直收藏着。”\n“能感觉到残存的强大力量，或许能作为大魔法的媒介。”\n“真的？”\n“假的。”",large_roll_of_bandages:"“这、这个尺寸，你究竟是谁？”\n“裹胸用的绷带被某个仙人顺走了啦。”\n“呀，还有这种事。”\n“还有人顺走过扫帚呢。”\n“诶嘿嘿。”",burning_seashore_flower:"“又在这偷懒？”\n“这株彼岸花，由于强大的意念在燃烧着，燃不尽。”\n“要是会引起麻烦就早点退治掉好了。”\n“你不会懂的，正是这份意念传达不出去，才会如此强大。”\n“所以？”\n“请您也不要将我偷懒的事说出去！”",skyrocket:"“在偷拍吗！”\n“啊呀呀，吓我一跳。毕竟巫女难得要出门了嘛，你呢？”\n“我拿到了一个好玩的火箭烟花，来吓一吓她。”\n向着巫女，窜天猴“嗖——”地飞出去。\n飞进了神社的赛钱箱里。",magic_dart:"“这个是未完成品，可以用魔力进行导向的飞镖。”\n“听起来很有意思，便宜卖我呗。”\n“都说了是未完成——小心！”\n“呀，戳我屁股上了。”\n“没受伤吧？”\n“当然没有。”",fox_jade:"敬请期待",cherry:"敬请期待",earthy_spider_wine:"敬请期待",amulet_of_full_moon:"敬请期待",seal_needle:"“真巧啊。”\n“……嗯，很巧呢。”\n“我想委托你给封魔针加些新功能。”\n“然后呢？然后你就要用新的封魔针退治我了吗？”\n“当然不。”\n“真的？”\n“我的赛钱箱被炸了个洞，我先退治完你再去找你。”",crown_of_thorns:"敬请期待",red_and_white_scarf:"敬请期待",bottle_of_stars:"敬请期待","philosopher's_stone":"敬请期待",blade_of_yellow_spring:"敬请期待",blood_book:"敬请期待",human_soul_lamp:"敬请期待","patchouli's_ribbon":"敬请期待",fish_stone:"敬请期待"},souvenir:{"noda's_hat":"敬请期待",microlithic_fish:"敬请期待","ahab's_opinion":"敬请期待",mimicry_cat_pendant:"敬请期待",wanderlust:"还不可以认输！\n绝望中，仍存有一线生机！\n\n龙战于野，其血玄黄！\n潜龙勿用，藏锋守拙！"},equipment:{gongonier:"敬请期待",sword_of_feixiang:"敬请期待",sunshade:"敬请期待",mirror_of_pear:"敬请期待",mini_bagua_stove:"敬请期待",louguanjian:"敬请期待",hd_camera:"敬请期待"}};function Pn(e,t,n){const l=e.slice();return l[22]=t[n],l}function Dn(e,t,n){const l=e.slice();return l[22]=t[n],l}function Ln(e,t,n){const l=e.slice();return l[22]=t[n],l}function Gn(e,t,n){const l=e.slice();return l[29]=t[n],l[31]=n,l}function Wn(e){let t,n,l,a,s=["blue","green","red"],r=[];for(let t=0;t<3;t+=1)r[t]=Jn(Ln(e,s,t));return{c(){t=M("div");for(let e=0;e<3;e+=1)r[e].c();O(t,"class","collections svelte-ohnihg")},m(e,n){x(e,t,n);for(let e=0;e<3;e+=1)r[e]&&r[e].m(t,null);a=!0},p(e,n){if(6&n[0]){let l;for(s=["blue","green","red"],l=0;l<3;l+=1){const a=Ln(e,s,l);r[l]?r[l].p(a,n):(r[l]=Jn(a),r[l].c(),r[l].m(t,null))}for(;l<3;l+=1)r[l].d(1)}},i(e){a||(J((()=>{a&&(l&&l.end(1),n=ce(t,xe,{duration:200}),n.start())})),a=!0)},o(e){n&&n.invalidate(),l=ue(t,xe,{duration:200}),a=!1},d(e){e&&k(t),w(r,e),e&&l&&l.end()}}}function Kn(e,t){let n,l,s,r,i,o,u;function m(...e){return t[10](t[29],...e)}function f(...e){return t[12](t[29],t[22],...e)}return{key:e,first:null,c(){n=M("div"),l=M("img"),r=E(),c(l.src,s="/svg/collection/"+t[29]+".svg")||O(l,"src",s),O(l,"class","svelte-ohnihg"),O(n,"class",i=d(t[1]==t[29]&&"selected")+" svelte-ohnihg"),this.first=n},m(e,a){x(e,n,a),_(n,l),_(n,r),o||(u=[C(n,"click",m),C(n,"mouseenter",t[11]),C(n,"mousemove",f),C(n,"mouseleave",t[13])],o=!0)},p(e,l){t=e,2&l[0]&&i!==(i=d(t[1]==t[29]&&"selected")+" svelte-ohnihg")&&O(n,"class",i)},d(e){e&&k(n),o=!1,a(u)}}}function Jn(e){let t,n=[],l=new Map;function a(...t){return e[9](e[22],...t)}let s=Object.keys(Fe).filter(a);const r=e=>e[31];for(let t=0;t<s.length;t+=1){let a=Gn(e,s,t),i=r(a);l.set(i,n[t]=Kn(i,a))}return{c(){for(let e=0;e<n.length;e+=1)n[e].c();t=S()},m(e,l){for(let t=0;t<n.length;t+=1)n[t]&&n[t].m(e,l);x(e,t,l)},p(i,o){e=i,6&o[0]&&(s=Object.keys(Fe).filter(a),n=fe(n,o,r,1,e,s,l,t.parentNode,de,Kn,t,Gn))},d(e){for(let t=0;t<n.length;t+=1)n[t].d(e);e&&k(t)}}}function Qn(e){let t,n,l,a,s=Ne.sort,r=[];for(let t=0;t<s.length;t+=1)r[t]=Un(Dn(e,s,t));return{c(){t=M("div");for(let e=0;e<r.length;e+=1)r[e].c();O(t,"class","souvenirs svelte-ohnihg")},m(e,n){x(e,t,n);for(let e=0;e<r.length;e+=1)r[e]&&r[e].m(t,null);a=!0},p(e,n){if(6&n[0]){let l;for(s=Ne.sort,l=0;l<s.length;l+=1){const a=Dn(e,s,l);r[l]?r[l].p(a,n):(r[l]=Un(a),r[l].c(),r[l].m(t,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=s.length}},i(e){a||(J((()=>{a&&(l&&l.end(1),n=ce(t,xe,{duration:200}),n.start())})),a=!0)},o(e){n&&n.invalidate(),l=ue(t,xe,{duration:200}),a=!1},d(e){e&&k(t),w(r,e),e&&l&&l.end()}}}function Un(e){let t,n,l,s,r,i,o;function u(...t){return e[14](e[22],...t)}function m(...t){return e[16](e[22],...t)}return{c(){t=M("div"),n=M("img"),s=E(),c(n.src,l="/svg/souvenir/"+e[22]+".svg")||O(n,"src",l),O(n,"class","svelte-ohnihg"),O(t,"class",r=d(e[1]==e[22]&&"selected")+" svelte-ohnihg")},m(l,a){x(l,t,a),_(t,n),_(t,s),i||(o=[C(t,"click",u),C(t,"mouseenter",e[15]),C(t,"mousemove",m),C(t,"mouseleave",e[17])],i=!0)},p(n,l){e=n,2&l[0]&&r!==(r=d(e[1]==e[22]&&"selected")+" svelte-ohnihg")&&O(t,"class",r)},d(e){e&&k(t),i=!1,a(o)}}}function Vn(e){let t,n,l,a,s=Be.sort,r=[];for(let t=0;t<s.length;t+=1)r[t]=Xn(Pn(e,s,t));return{c(){t=M("div");for(let e=0;e<r.length;e+=1)r[e].c();O(t,"class","equipments svelte-ohnihg")},m(e,n){x(e,t,n);for(let e=0;e<r.length;e+=1)r[e]&&r[e].m(t,null);a=!0},p(e,n){if(6&n[0]){let l;for(s=Be.sort,l=0;l<s.length;l+=1){const a=Pn(e,s,l);r[l]?r[l].p(a,n):(r[l]=Xn(a),r[l].c(),r[l].m(t,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=s.length}},i(e){a||(J((()=>{a&&(l&&l.end(1),n=ce(t,xe,{duration:200}),n.start())})),a=!0)},o(e){n&&n.invalidate(),l=ue(t,xe,{duration:200}),a=!1},d(e){e&&k(t),w(r,e),e&&l&&l.end()}}}function Xn(e){let t,n,l,s,r,i,o;function u(...t){return e[18](e[22],...t)}function m(...t){return e[20](e[22],...t)}return{c(){t=M("div"),n=M("img"),s=E(),c(n.src,l="/svg/equipment/"+e[22]+".svg")||O(n,"src",l),O(n,"class","svelte-ohnihg"),O(t,"class",r=d(e[1]==e[22]&&"selected")+" svelte-ohnihg")},m(l,a){x(l,t,a),_(t,n),_(t,s),i||(o=[C(t,"click",u),C(t,"mouseenter",e[19]),C(t,"mousemove",m),C(t,"mouseleave",e[21])],i=!0)},p(n,l){e=n,2&l[0]&&r!==(r=d(e[1]==e[22]&&"selected")+" svelte-ohnihg")&&O(t,"class",r)},d(e){e&&k(t),i=!1,a(o)}}}function Yn(e){let t,n,l,a,s,r,i,o,u,d,m,f,h,p,v,g=e[3][e[0]][e[1]].name+"",y=e[3][e[0]][e[1]].detail+"",b=Rn[e[0]][e[1]]+"";return{c(){t=M("div"),n=M("img"),a=E(),s=M("txt"),r=j(g),i=E(),o=M("txt"),u=j(y),d=E(),m=M("txt"),f=j(b),c(n.src,l="/svg/"+e[0]+"/"+e[1]+".svg")||O(n,"src",l),O(n,"class","svelte-ohnihg"),O(s,"class","name svelte-ohnihg"),O(o,"class","effect svelte-ohnihg"),O(m,"class","story svelte-ohnihg"),O(t,"class","detail svelte-ohnihg")},m(e,l){x(e,t,l),_(t,n),_(t,a),_(t,s),_(s,r),_(t,i),_(t,o),_(o,u),_(t,d),_(t,m),_(m,f),v=!0},p(e,t){(!v||3&t[0]&&!c(n.src,l="/svg/"+e[0]+"/"+e[1]+".svg"))&&O(n,"src",l),(!v||3&t[0])&&g!==(g=e[3][e[0]][e[1]].name+"")&&q(r,g),(!v||3&t[0])&&y!==(y=e[3][e[0]][e[1]].detail+"")&&q(u,y),(!v||3&t[0])&&b!==(b=Rn[e[0]][e[1]]+"")&&q(f,b)},i(e){v||(J((()=>{v&&(p&&p.end(1),h=ce(t,xe,{duration:200}),h.start())})),v=!0)},o(e){h&&h.invalidate(),p=ue(t,xe,{duration:200}),v=!1},d(e){e&&k(t),e&&p&&p.end()}}}function Zn(e){let t,n,l,s,r,i,o,c,u,m,f,h,p,v,g,y,b,$,w,S,q,H,A,z,I,T,F,B,N,R,P,L;function G(t){e[5](t)}let W={};void 0!==e[2]&&(W.explain=e[2]),n=new Xe({props:W}),D.push((()=>he(n,"explain",G)));let K="collection"==e[0]&&Wn(e),U="souvenir"==e[0]&&Qn(e),V="equipment"==e[0]&&Vn(e),X=e[1]&&Yn(e);return{c(){t=M("div"),pe(n.$$.fragment),s=E(),r=M("div"),i=M("txt"),o=j("收藏品"),u=E(),m=M("txt"),f=j("纪念品"),p=E(),v=M("txt"),g=j("装备"),b=E(),$=M("txt"),$.textContent="符卡",w=E(),S=M("txt"),S.textContent="消耗品",q=E(),H=M("txt"),H.textContent="角色",A=E(),z=M("div"),K&&K.c(),I=E(),U&&U.c(),T=E(),V&&V.c(),F=E(),X&&X.c(),O(i,"class",c=d("collection"==e[0]&&"selected")+" svelte-ohnihg"),O(m,"class",h=d("souvenir"==e[0]&&"selected")+" svelte-ohnihg"),O(v,"class",y=d("equipment"==e[0]&&"selected")+" svelte-ohnihg"),O($,"class","svelte-ohnihg"),O(S,"class","svelte-ohnihg"),O(H,"class","svelte-ohnihg"),O(r,"class","index svelte-ohnihg"),O(z,"class","main svelte-ohnihg"),O(t,"class","body svelte-ohnihg")},m(l,a){x(l,t,a),ve(n,t,null),_(t,s),_(t,r),_(r,i),_(i,o),_(r,u),_(r,m),_(m,f),_(r,p),_(r,v),_(v,g),_(r,b),_(r,$),_(r,w),_(r,S),_(r,q),_(r,H),_(t,A),_(t,z),K&&K.m(z,null),_(z,I),U&&U.m(z,null),_(z,T),V&&V.m(z,null),_(z,F),X&&X.m(z,null),R=!0,P||(L=[C(i,"click",e[6]),C(m,"click",e[7]),C(v,"click",e[8])],P=!0)},p(e,t){const a={};!l&&4&t[0]&&(l=!0,a.explain=e[2],Q((()=>l=!1))),n.$set(a),(!R||1&t[0]&&c!==(c=d("collection"==e[0]&&"selected")+" svelte-ohnihg"))&&O(i,"class",c),(!R||1&t[0]&&h!==(h=d("souvenir"==e[0]&&"selected")+" svelte-ohnihg"))&&O(m,"class",h),(!R||1&t[0]&&y!==(y=d("equipment"==e[0]&&"selected")+" svelte-ohnihg"))&&O(v,"class",y),"collection"==e[0]?K?(K.p(e,t),1&t[0]&&re(K,1)):(K=Wn(e),K.c(),re(K,1),K.m(z,I)):K&&(ae(),ie(K,1,1,(()=>{K=null})),se()),"souvenir"==e[0]?U?(U.p(e,t),1&t[0]&&re(U,1)):(U=Qn(e),U.c(),re(U,1),U.m(z,T)):U&&(ae(),ie(U,1,1,(()=>{U=null})),se()),"equipment"==e[0]?V?(V.p(e,t),1&t[0]&&re(V,1)):(V=Vn(e),V.c(),re(V,1),V.m(z,F)):V&&(ae(),ie(V,1,1,(()=>{V=null})),se()),e[1]?X?(X.p(e,t),2&t[0]&&re(X,1)):(X=Yn(e),X.c(),re(X,1),X.m(z,null)):X&&(ae(),ie(X,1,1,(()=>{X=null})),se())},i(e){R||(re(n.$$.fragment,e),re(K),re(U),re(V),re(X),J((()=>{R&&(N&&N.end(1),B=ce(t,xe,{duration:250}),B.start())})),R=!0)},o(e){ie(n.$$.fragment,e),ie(K),ie(U),ie(V),ie(X),B&&B.invalidate(),N=ue(t,xe,{duration:250}),R=!1},d(e){e&&k(t),ge(n),K&&K.d(),U&&U.d(),V&&V.d(),X&&X.d(),e&&N&&N.end(),P=!1,a(L)}}}function el(e,t,n){let l="collection",a=null;let s;function r(e){n(1,a=null),n(0,l=e)}return[l,a,s,{collection:Fe,equipment:Be,souvenir:Ne,spellcard:Re,role:Pe},r,function(e){s=e,n(2,s)},e=>r("collection"),e=>r("souvenir"),e=>r("equipment"),(e,t)=>Fe[t].type==e,(e,t)=>n(1,a=e),e=>s.show(),(e,t,n)=>s.move(n,Fe[e],t),e=>s.hide(),(e,t)=>n(1,a=e),e=>s.show(),(e,t)=>s.move(t,Ne[e],"purple"),e=>s.hide(),(e,t)=>n(1,a=e),e=>s.show(),(e,t)=>s.move(t,Be[e],"gold"),e=>s.hide()]}class tl extends be{constructor(e){super(),_e(this,e,el,Zn,i,{},null,[-1,-1])}}function nl(e){let t,n,l,a,s,r,i,o,c,u;var d=e[2][e[1]];function m(t){e[3](t)}d&&(n=A(d,{})),a=new Te({});let f={};return void 0!==e[0]&&(f.menu=e[0]),r=new dt({props:f}),D.push((()=>he(r,"menu",m))),{c(){t=M("div"),n&&pe(n.$$.fragment),l=E(),pe(a.$$.fragment),s=E(),pe(r.$$.fragment),O(t,"id","root"),O(t,"class","svelte-g4jctk")},m(i,d){x(i,t,d),n&&ve(n,t,null),_(t,l),ve(a,t,null),_(t,s),ve(r,t,null),o=!0,c||(u=C(t,"contextmenu",e[4]),c=!0)},p(e,[a]){if(2&a&&d!==(d=e[2][e[1]])){if(n){ae();const e=n;ie(e.$$.fragment,1,0,(()=>{ge(e,1)})),se()}d?(n=A(d,{}),pe(n.$$.fragment),re(n.$$.fragment,1),ve(n,t,l)):n=null}const s={};!i&&1&a&&(i=!0,s.menu=e[0],Q((()=>i=!1))),r.$set(s)},i(e){o||(n&&re(n.$$.fragment,e),re(a.$$.fragment,e),re(r.$$.fragment,e),o=!0)},o(e){n&&ie(n.$$.fragment,e),ie(a.$$.fragment,e),ie(r.$$.fragment,e),o=!1},d(e){e&&k(t),n&&ge(n),ge(a),ge(r),c=!1,u()}}}function ll(e,t,n){let l;u(e,je,(e=>n(1,l=e)));const a={Index:kt,Foreword:Tt,Explore:Pt,Battle:Nn,Afflatus:tl};window.deepCopy=e=>{if(Array.isArray(e)){let a=e;for(var t=[],n=0;n<a.length;n++)if(Array.isArray(a[n])){var l=deepCopy(a[n]);t.push(l)}else t.push(a[n]);return t}{let t=e.constructor===Array?[]:{};for(let n in e)t[n]="object"==typeof e[n]?deepCopy(e[n]):e[n];return t}},Array.prototype.rd=function(){for(var e,t,n=this.length;n;e=parseInt(Math.random()*n),t=this[--n],this[n]=this[e],this[e]=t);return this},String.prototype.getByteLen=function(){let e=0;for(let t=0;t<this.length;t++)this.charCodeAt(t)<256?e+=1:e+=2;return e},window.r=Math.random;let s;window.RAF=class{constructor(){this.init()}init(){this._timerIdMap={timeout:{},interval:{}}}run(e="interval",t,n=16.7){const l=Date.now;let a=l(),s=a;const r=Symbol(),i=()=>{this.setIdMap(r,e,i),s=l(),s-a>=n&&("interval"===e&&(a=l(),s=a),t(),"timeout"===e&&this.clearTimeout(r))};return this.setIdMap(r,e,i),r}setIdMap(e,t,n){const l=requestAnimationFrame(n);this._timerIdMap[t][e]=l}setTimeout(e,t){return this.run("timeout",e,t)}clearTimeout(e){cancelAnimationFrame(this._timerIdMap.timeout[e])}setInterval(e,t){return this.run("interval",e,t)}clearInterval(e){cancelAnimationFrame(this._timerIdMap.interval[e])}};return[s,l,a,function(e){s=e,n(0,s)},e=>s(e)]}return new class extends be{constructor(e){super(),_e(this,e,ll,nl,i,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
