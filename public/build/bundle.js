var app=function(){"use strict";function e(){}const t=e=>e;function n(e,t){for(const n in t)e[n]=t[n];return e}function i(e){return e()}function l(){return Object.create(null)}function s(e){e.forEach(i)}function a(e){return"function"==typeof e}function o(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let u;function c(e,t){return u||(u=document.createElement("a")),u.href=t,e===u.href}function f(t,n,r){t.$$.on_destroy.push(function(t,...n){if(null==t)return e;const r=t.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}function d(e){return null==e?"":e}function h(e,t,n){return e.set(n),t}const m="undefined"!=typeof window;let p=m?()=>window.performance.now():()=>Date.now(),g=m?e=>requestAnimationFrame(e):e;const v=new Set;function y(e){v.forEach((t=>{t.c(e)||(v.delete(t),t.f())})),0!==v.size&&g(y)}function _(e){let t;return 0===v.size&&g(y),{promise:new Promise((n=>{v.add(t={c:e,f:n})})),abort(){v.delete(t)}}}function b(e,t){e.appendChild(t)}function x(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function $(e){const t=j("style");return function(e,t){b(e.head||e,t),t.sheet}(x(e),t),t.sheet}function w(e,t,n){e.insertBefore(t,n||null)}function k(e){e.parentNode&&e.parentNode.removeChild(e)}function S(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function j(e){return document.createElement(e)}function E(e){return document.createTextNode(e)}function M(){return E(" ")}function A(){return E("")}function C(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function T(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function z(e,t){t=""+t,e.data!==t&&(e.data=t)}function N(e,t,n,r){null==n?e.style.removeProperty(t):e.style.setProperty(t,n,r?"important":"")}function R(e,t){return new e(t)}const O=new Map;let P,I=0;function L(e,t,n,r,i,l,s,a=0){const o=16.666/r;let u="{\n";for(let e=0;e<=1;e+=o){const r=t+(n-t)*l(e);u+=100*e+`%{${s(r,1-r)}}\n`}const c=u+`100% {${s(n,1-n)}}\n}`,f=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(c)}_${a}`,d=x(e),{stylesheet:h,rules:m}=O.get(d)||function(e,t){const n={stylesheet:$(t),rules:{}};return O.set(e,n),n}(d,e);m[f]||(m[f]=!0,h.insertRule(`@keyframes ${f} ${c}`,h.cssRules.length));const p=e.style.animation||"";return e.style.animation=`${p?`${p}, `:""}${f} ${r}ms linear ${i}ms 1 both`,I+=1,f}function q(e,t){const n=(e.style.animation||"").split(", "),r=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),i=n.length-r.length;i&&(e.style.animation=r.join(", "),I-=i,I||g((()=>{I||(O.forEach((e=>{const{ownerNode:t}=e.stylesheet;t&&k(t)})),O.clear())})))}function B(e){P=e}function F(e){(function(){if(!P)throw new Error("Function called outside component initialization");return P})().$$.after_update.push(e)}const H=[],D=[];let W=[];const U=[],X=Promise.resolve();let G=!1;function Y(e){W.push(e)}function V(e){U.push(e)}const Z=new Set;let K,J=0;function Q(){if(0!==J)return;const e=P;do{try{for(;J<H.length;){const e=H[J];J++,B(e),ee(e.$$)}}catch(e){throw H.length=0,J=0,e}for(B(null),H.length=0,J=0;D.length;)D.pop()();for(let e=0;e<W.length;e+=1){const t=W[e];Z.has(t)||(Z.add(t),t())}W.length=0}while(H.length);for(;U.length;)U.pop()();G=!1,Z.clear(),B(e)}function ee(e){if(null!==e.fragment){e.update(),s(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Y)}}function te(){return K||(K=Promise.resolve(),K.then((()=>{K=null}))),K}function ne(e,t,n){e.dispatchEvent(function(e,t,{bubbles:n=!1,cancelable:r=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(e,n,r,t),i}(`${t?"intro":"outro"}${n}`))}const re=new Set;let ie;function le(){ie={r:0,c:[],p:ie}}function se(){ie.r||s(ie.c),ie=ie.p}function ae(e,t){e&&e.i&&(re.delete(e),e.i(t))}function oe(e,t,n,r){if(e&&e.o){if(re.has(e))return;re.add(e),ie.c.push((()=>{re.delete(e),r&&(n&&e.d(1),r())})),e.o(t)}else r&&r()}const ue={duration:0};function ce(n,r,i){const l={direction:"in"};let s,o,u=r(n,i,l),c=!1,f=0;function d(){s&&q(n,s)}function h(){const{delay:r=0,duration:i=300,easing:l=t,tick:a=e,css:h}=u||ue;h&&(s=L(n,0,1,i,r,l,h,f++)),a(0,1);const m=p()+r,g=m+i;o&&o.abort(),c=!0,Y((()=>ne(n,!0,"start"))),o=_((e=>{if(c){if(e>=g)return a(1,0),ne(n,!0,"end"),d(),c=!1;if(e>=m){const t=l((e-m)/i);a(t,1-t)}}return c}))}let m=!1;return{start(){m||(m=!0,q(n),a(u)?(u=u(l),te().then(h)):h())},invalidate(){m=!1},end(){c&&(d(),c=!1)}}}function fe(n,r,i){const l={direction:"out"};let o,u=r(n,i,l),c=!0;const f=ie;function d(){const{delay:r=0,duration:i=300,easing:l=t,tick:a=e,css:d}=u||ue;d&&(o=L(n,1,0,i,r,l,d));const h=p()+r,m=h+i;Y((()=>ne(n,!1,"start"))),_((e=>{if(c){if(e>=m)return a(0,1),ne(n,!1,"end"),--f.r||s(f.c),!1;if(e>=h){const t=l((e-h)/i);a(1-t,t)}}return c}))}return f.r+=1,a(u)?te().then((()=>{u=u(l),d()})):d(),{end(e){e&&u.tick&&u.tick(1,0),c&&(o&&q(n,o),c=!1)}}}function de(e,t){e.d(1),t.delete(e.key)}function he(e,t){oe(e,1,1,(()=>{t.delete(e.key)}))}function me(e,t,n,r,i,l,a,o,u,c,f,d){let h=e.length,m=l.length,p=h;const g={};for(;p--;)g[e[p].key]=p;const v=[],y=new Map,_=new Map,b=[];for(p=m;p--;){const e=d(i,l,p),s=n(e);let o=a.get(s);o?r&&b.push((()=>o.p(e,t))):(o=c(s,e),o.c()),y.set(s,v[p]=o),s in g&&_.set(s,Math.abs(p-g[s]))}const x=new Set,$=new Set;function w(e){ae(e,1),e.m(o,f),a.set(e.key,e),f=e.first,m--}for(;h&&m;){const t=v[m-1],n=e[h-1],r=t.key,i=n.key;t===n?(f=t.first,h--,m--):y.has(i)?!a.has(r)||x.has(r)?w(t):$.has(i)?h--:_.get(r)>_.get(i)?($.add(r),w(t)):(x.add(i),h--):(u(n,a),h--)}for(;h--;){const t=e[h];y.has(t.key)||u(t,a)}for(;m;)w(v[m-1]);return s(b),v}function pe(e,t,n){const r=e.$$.props[t];void 0!==r&&(e.$$.bound[r]=n,n(e.$$.ctx[r]))}function ge(e){e&&e.c()}function ve(e,t,n,r){const{fragment:l,after_update:o}=e.$$;l&&l.m(t,n),r||Y((()=>{const t=e.$$.on_mount.map(i).filter(a);e.$$.on_destroy?e.$$.on_destroy.push(...t):s(t),e.$$.on_mount=[]})),o.forEach(Y)}function ye(e,t){const n=e.$$;null!==n.fragment&&(!function(e){const t=[],n=[];W.forEach((r=>-1===e.indexOf(r)?t.push(r):n.push(r))),n.forEach((e=>e())),W=t}(n.after_update),s(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function _e(e,t){-1===e.$$.dirty[0]&&(H.push(e),G||(G=!0,X.then(Q)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function be(t,n,r,i,a,o,u,c=[-1]){const f=P;B(t);const d=t.$$={fragment:null,ctx:[],props:o,update:e,not_equal:a,bound:l(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(f?f.$$.context:[])),callbacks:l(),dirty:c,skip_bound:!1,root:n.target||f.$$.root};u&&u(d.root);let h=!1;if(d.ctx=r?r(t,n.props||{},((e,n,...r)=>{const i=r.length?r[0]:n;return d.ctx&&a(d.ctx[e],d.ctx[e]=i)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](i),h&&_e(t,e)),n})):[],d.update(),h=!0,s(d.before_update),d.fragment=!!i&&i(d.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);d.fragment&&d.fragment.l(e),e.forEach(k)}else d.fragment&&d.fragment.c();n.intro&&ae(t.$$.fragment),ve(t,n.target,n.anchor,n.customElement),Q()}B(f)}class xe{$destroy(){ye(this,1),this.$destroy=e}$on(t,n){if(!a(n))return e;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const e=r.indexOf(n);-1!==e&&r.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const $e=[":",";",",","(",")","[","]","{","}","π","±","+","-","*","/","%",'"',"'","`","@","=","^"],we={escape:e=>"\\"==e,space:e=>/[\r\n\t\s]/.test(e),digit:e=>/^[0-9]$/.test(e),sign:e=>/^[+-]$/.test(e),dot:e=>"."==e,quote:e=>/^["'`]$/.test(e),symbol:e=>$e.includes(e),hexNum:e=>/^[0-9a-f]$/i.test(e),hex:(e,t,n)=>"0"==e&&we.letter(t,"x")&&we.hexNum(n),expWithSign:(e,t,n)=>we.letter(e,"e")&&we.sign(t)&&we.digit(n),exp:(e,t)=>we.letter(e,"e")&&we.digit(t),dots:(e,t)=>we.dot(e)&&we.dot(t),letter:(e,t)=>String(e).toLowerCase()==String(t).toLowerCase(),comment:(e,t)=>"/"==e&&"*"==t,inlineComment:(e,t)=>"/"==e&&"/"===t,selfClosedTag:(e,t)=>"/"==e&&">"==t,closedTag:(e,t)=>"<"==e&&"/"==t};class ke{constructor({type:e,value:t,pos:n,status:r}){this.type=e,this.value=t,this.pos=n,r&&(this.status=r)}isSymbol(...e){let t="Symbol"==this.type;return e.length?e.some((e=>e===this.value)):t}isSpace(){return"Space"==this.type}isNumber(){return"Number"==this.type}isWord(){return"Word"==this.type}}function Se(e){let t=-1,n=e.length,r=-1,i=0;return{curr:(n=0)=>e[t+n],next(n=1){let l=e[t+=n];return"\n"===l?(i++,r=0):r+=n,l},end:()=>t>=n,get:()=>({prev:e[t-1],curr:e[t+0],next:e[t+1],next2:e[t+2],next3:e[t+3],pos:[r,i]})}}function je(e){for(;e.next();){let{curr:t,prev:n}=e.get();if(we.comment(t,n))break}}function Ee(e){for(;e.next()&&"\n"!==e.curr(););}function Me(e){return[":",";",",","{","}","(",")","[","]"].includes(e)}function Ae(e){let t="";for(;!e.end();){let{curr:n,next:r}=e.get();t+=n;let i=we.symbol(r)||we.space(r)||we.digit(r);if(t.length&&i&&!we.closedTag(n,r))break;e.next()}return t.trim()}function Ce(e){let t="";for(;!e.end();){let{curr:n,next:r}=e.get();if(t+=n,!we.space(r))break;e.next()}return t}function Te(e){let t="",n=!1;for(;!e.end();){let{curr:r,next:i,next2:l,next3:s}=e.get();if(t+=r,n&&we.dot(i))break;if(we.dot(r)&&(n=!0),we.dots(i,l))break;if(we.expWithSign(i,l,s))t+=e.next()+e.next();else if(we.exp(i,l))t+=e.next();else if(!we.digit(i)&&!we.dot(i))break;e.next()}return t}function ze(e){let t="0x";for(e.next(2);!e.end();){let{curr:n,next:r}=e.get();if(t+=n,!we.hexNum(r))break;e.next()}return t}function Ne(e){return e[e.length-1]}function Re(e,t={}){let n=Se(String(e).trim()),r=[],i=[];for(;n.next();){let{prev:e,curr:l,next:s,next2:a,pos:o}=n.get();if(we.comment(l,s))je(n);else if(t.ignoreInlineComment&&we.inlineComment(l,s))Ee(n);else if(we.hex(l,s,a)){let e=ze(n);r.push(new ke({type:"Number",value:e,pos:o}))}else if(we.digit(l)||we.digit(s)&&we.dot(l)&&!we.dots(e,l)){let e=Te(n);r.push(new ke({type:"Number",value:e,pos:o}))}else if(we.symbol(l)&&!we.selfClosedTag(l,s)){let e=Ne(r),t=we.digit(s)||we.dot(s)&&we.digit(a);if("-"===l&&t&&(!e||!e.isNumber())){let e=Te(n);r.push(new ke({type:"Number",value:e,pos:o}));continue}let u={type:"Symbol",value:l,pos:o};if(i.length&&we.escape(e.value)){r.pop();let e=Ae(n);e.length&&r.push(new ke({type:"Word",value:e,pos:o}))}else{if(we.quote(l)){Ne(i)==l?(i.pop(),u.status="close"):(i.push(l),u.status="open")}r.push(new ke(u))}}else if(we.space(l)){let e=Ce(n),s=Ne(r),{next:a}=n.get();if(!i.length&&s){let n=s.value,r=Me(n)&&")"!==n,i=Me(a)&&"("!==a;if(r||i)continue;e=t.preserveLineBreak?l:" "}r.length&&a&&a.trim()&&r.push(new ke({type:"Space",value:e,pos:o}))}else{let e=Ae(n);e.length&&r.push(new ke({type:"Word",value:e,pos:o}))}}let l=Ne(r);return l&&l.isSpace()&&(r.length=r.length-1),r}function Oe(e){let t=[];for(;e.next();){let{curr:n,next:r}=e.get();if("var"===n.value){if(r&&r.isSymbol("(")){e.next();let n=Pe(e);Le(n.name)&&t.push(n)}}else if(t.length&&!n.isSymbol(","))break}return t}function Pe(e){let t={},n=[];for(;e.next();){let{curr:r,next:i}=e.get();if(r.isSymbol(")",";")&&!t.name){t.name=Ie(n);break}r.isSymbol(",")?(void 0===t.name&&(t.name=Ie(n),n=[]),t.name&&(t.fallback=Oe(e))):n.push(r)}return t}function Ie(e){return e.map((e=>e.value)).join("")}function Le(e){return void 0!==e&&(!(e.length<=2)&&(!e.substr(2).startsWith("-")&&!!e.startsWith("--")))}function qe(e,t,n){return e=Number(e)||0,Math.max(t,Math.min(n,e))}function Be(e,t,n){let r=0,i=e,l=e=>e>0&&e<1?.1:1,s=arguments.length;1==s&&([e,t]=[l(e),e]),s<3&&(n=l(e));let a=[];for(;(n>=0&&e<=t||n<0&&e>t)&&(a.push(e),e+=n,!(r++>=65535)););return a.length||a.push(i),a}function Fe(e,t){for(let[n,r]of Object.entries(t))e[n]=e[r];return e}function He(e){return/^[a-zA-Z]$/.test(e)}function De(e){return null==e}function We(e){return De(e)||Number.isNaN(e)}function Ue(e){return De(e)||""===e}function Xe(e){let t=t=>(...n)=>e(t,...n);return t.lazy=!0,t}function Ge(e,t,n){return"c-"+e+"-"+t+"-"+n}function Ye(e){let t=e;for(;t&&!De(t.value);)t=t.value;return De(t)?"":t}function Ve(e,t,n=0){let r=new Image;r.crossOrigin="anonymous",r.src=e,r.onload=function(){setTimeout(t,n)}}function Ze(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function Ke(e){let t=document.createElement("textarea");return t.innerHTML=e,t.value}function Je(e,t=0){let n=3735928559^t,r=1103547991^t;for(let t,i=0;i<e.length;i++)t=e.charCodeAt(i),n=Math.imul(n^t,2654435761),r=Math.imul(r^t,1597334677);return n=Math.imul(n^n>>>16,2246822507)^Math.imul(r^r>>>13,3266489909),r=Math.imul(r^r>>>16,2246822507)^Math.imul(n^n>>>13,3266489909),4294967296*(2097151&r)+(n>>>0)}function Qe(){let e=0;return(t="")=>`${t}-${++e}`}function et(e,t,n){return t+e*(n-t)}function tt(e=""){return e+Math.random().toString(32).substr(2)}function nt(e,t={symbol:",",noSpace:!1,verbose:!1}){let n=[],r=[],i=[],l=[],s="";if(Ue(e))return n;let a=Se(Re(e));function o(e){let n=t.symbol||[","];return Array.isArray(n)||(n=[n]),t.noSpace?e.isSymbol(...n):e.isSymbol(...n)||e.isSpace()}function u(e){let r=function(e){return e.map((e=>e.value)).join("")}(e);t.verbose?(s.length||r.length)&&n.push({group:s,value:r}):n.push(r)}for(;a.next();){let{prev:e,curr:n,next:c}=a.get();n.isSymbol("(")&&i.push(n.value),n.isSymbol(")")&&i.pop(),"open"===n.status&&l.push(n.value),"close"===n.status&&l.pop();let f=!i.length&&!l.length;if(f){let r=t.noSpace&&n.isSpace()&&o(c),i=t.noSpace&&n.isSpace()&&o(e);if(r||i)continue}f&&o(n)?(u(r),s=n.value,r=[]):r.push(n)}return r.length&&u(r),n}function rt(e,t){let n,r=[],i=[],l=[];for(;e.next();){let{curr:t,next:s}=e.get();t.isSymbol("(")&&!i.length?l.push(t):t.isSymbol(")")&&!i.length&&l.pop();let a=!i.length&&!l.length&&(!s||t.isSymbol(";")||s.isSymbol("}"));if(t.isSymbol("'",'"')&&("open"===t.status?i.push(t):i.pop(),s&&s.isSymbol("}")&&!i.length&&(a=!0)),!l.length&&!i.length&&t.isSymbol("{")){let t=ct(r);if(!t.length)continue;let i=t.pop(),l=ht(...t,i);for(n=ot(lt(e,dt(i,{type:"block",inline:!0,name:i,value:[]})),l);i=t.pop();)n=ot(dt(i,{type:"block",name:i,value:[n]}),l);break}if(r.push(t),a)break}return r.length&&!n?(t._valueTokens=r,t.value=at(r)):n&&(t.value=n),t.origin&&(t.origin.value=t.value),t}function it(e){let t=[],n=[];for(;e.next();){let{curr:r}=e.get();if(r.isSymbol("{"))t.push(r.value);else if(r.isSymbol("}")){if(!t.length)break;t.pop()}n.push(r.value)}return n.join("")}function lt(e,t){let n=[],r=[],i=t&&t.type||"",l=[];for(;e.next();){let{prev:s,curr:a,next:o}=e.get();a.isSymbol("(")&&l.push(a.value),a.isSymbol(")")&&l.pop();let u=!o||a.isSymbol("}");if(mt(i)&&u){if(!o&&n.length&&!a.isSymbol("}")){"string"==typeof n[n.length-1].value&&(n[n.length-1].value+=";"+a.value)}t.value=n;break}if(a.isSymbol("{")){let i=ct(r);if(!i.length)continue;ht(t.name)&&(i=[at(r)]);let l=i.pop(),s=ht(...i,t.name,l);if("style"===l)n.push({type:"block",name:l,value:it(e)});else{let t=ot(lt(e,dt(l,{type:"block",name:l,value:[]})),s);for(;l=i.pop();)t=ot(dt(l,{type:"block",name:l,value:[t]}),s);n.push(t)}r=[]}else if(a.isSymbol(":")&&!l.length&&!st(s,o)&&r.length){let l=ut(r,(e=>e.isSymbol(","))),s={type:"statement",name:"unkown",value:""};l.length>1&&(s.origin={name:l});let a=rt(e,s),o=nt(a.value),u=l.length>1&&o.length===l.length;l.forEach(((e,t)=>{let r=Object.assign({},a,{name:e});/^\-\-/.test(e)&&(r.variable=!0),u&&(r.value=o[t]),/viewBox/i.test(e)&&(r.detail=ft(r.value,r._valueTokens)),delete r._valueTokens,n.push(r)})),mt(i)&&(t.value=n),r=[]}else a.isSymbol(";")?n.length&&r.length&&(n[n.length-1].value+=";"+at(r),r=[]):r.push(a)}return n.length&&mt(i)&&(t.value=n),i?t:n}function st(e,t){let n=e&&e.value,r=t&&t.value;return["xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"].includes(n+":"+r)}function at(e){return e.filter(((t,n)=>!t.isSymbol(";","}")||n!==e.length-1)).map((e=>e.value)).join("")}function ot(e,t){let n=e.name||"",[r,...i]=n.split(/#/),l=i[i.length-1];return r&&l&&!t&&(e.name=r,e.value.push({type:"statement",name:"id",value:l})),e}function ut(e,t){let n=[],r=[];return e.forEach((e=>{t(e)?(n.push(at(r)),r=[]):r.push(e)})),r.length&&n.push(at(r)),n}function ct(e){let t,n=[],r=Se(e);for(;r.next();){let{prev:e,curr:i,next:l}=r.get(),s=e&&l&&"x"===i.value&&e.isNumber()&&l.isNumber();!i.isWord()||t||s?n[n.length-1]=(n[n.length-1]+i.value).trim():n.push(i.value.trim()),i.isSymbol()?t=!0:i.isSpace()||(t=!1)}return n}function ft(e,t){const n={value:[]};let r;if(!Array.isArray(t))return n;for(let e of t)e.isSpace()||e.isSymbol(",",";")||(n.value.length<4&&e.isNumber()?n.value.push(Number(e.value)):e.isNumber()&&r?(n[r]=Number(e.value),r=null):e.isWord()&&(r=e.value));return n}function dt(e,t){let n=Object.assign({},t);if(/\*\s*[0-9]/.test(e)){let[t,r]=e.split("*");r&&(n.times=r.trim(),n.pureName=t.trim())}return n}function ht(...e){return e.some((e=>"style"===e))}function mt(e){return"block"===e}function pt(e,t){return function(e){let t,n=[];for(let r of e.value)"svg"===r.name&&(t=r),r.variable&&n.push(r);return t?(t.value.push(...n),t):e}(lt(Se(Re(e)),t||{type:"block",name:"svg",value:[]}))}function gt(e,t){let n="";if("block"===e.type){let t=Array.isArray(e.value)&&e.value[0]&&e.value[0].inline;if(e.times?n+="@M"+e.times+"("+e.pureName+"{":n+=e.name+(t?" ":"{"),"style"===e.name)n+=e.value;else if(Array.isArray(e.value)&&e.value.length){let t="";for(let r of e.value)n+=gt(r,t),r.origin&&(t=r.origin.name.join(","))}e.times?n+="})":t||(n+="}")}else if("statement"===e.type){let r=e.origin&&t===e.origin.name.join(","),i=e.origin?e.origin.name.join(","):e.name,l=e.origin?e.origin.value:e.value;r||(n+=l&&l.type?i+":"+gt(l):i+":"+l+";")}return n}function vt(e){return gt(e).trim()}function yt(e){return De(e)?[]:Array.isArray(e)?e:[e]}function _t(e,t="\n"){return(e||[]).join(t)}function bt(e,t=1){return De(e)?"":e[e.length-t]}function xt(e){return e[0]}function $t(e,t){return Array.prototype.flatMap?e.flatMap(t):e.reduce(((e,n)=>e.concat(t(n))),[])}const wt={func:(e="")=>({type:"func",name:e,arguments:[]}),argument:()=>({type:"argument",value:[]}),text:(e="")=>({type:"text",value:e}),pseudo:(e="")=>({type:"pseudo",selector:e,styles:[]}),cond:(e="")=>({type:"cond",name:e,styles:[],arguments:[]}),rule:(e="")=>({type:"rule",property:e,value:[]}),keyframes:(e="")=>({type:"keyframes",name:e,steps:[]}),step:(e="")=>({type:"step",name:e,styles:[]})},kt={white_space:e=>/[\s\n\t]/.test(e),line_break:e=>/\n/.test(e),number:e=>!isNaN(e),pair:e=>['"',"(",")","'"].includes(e),pair_of:(e,t)=>({'"':'"',"'":"'","(":")"}[e]==t)},St={"π":Math.PI,"∏":Math.PI};function jt(e){return["@canvas","@shaders","@doodle"].includes(e)}function Et(e=""){let t=0,n=1,r=1;return{curr:(n=0)=>e[t+n],end:()=>e.length<=t,info:()=>({index:t,col:n,line:r}),index:e=>void 0===e?t:t=e,range:(t,n)=>e.substring(t,n),next(){let i=e[t++];return"\n"==i?(r++,n=0):n++,i}}}function Mt(e,{col:t,line:n}){console.warn(`(at line ${n}, column ${t}) ${e}`)}function At(e){return function(t,n){let r=t.index(),i="";for(;!t.end();){let n=t.next();if(e(n))break;i+=n}return n&&t.index(r),i}}function Ct(e,t){return At((e=>/[^\w@]/.test(e)))(e,t)}function Tt(e){return At((e=>/[\s\{]/.test(e)))(e)}function zt(e,t){return At((e=>kt.line_break(e)||"{"==e))(e,t)}function Nt(e,t){let n,r=wt.step();for(;!e.end()&&"}"!=(n=e.curr());)if(kt.white_space(n))e.next();else{if(r.name.length){if(r.styles.push(Vt(e,t)),"}"==e.curr())break}else r.name=Xt(e);e.next()}return r}function Rt(e,t){const n=[];let r;for(;!e.end()&&"}"!=(r=e.curr());)kt.white_space(r)||n.push(Nt(e,t)),e.next();return n}function Ot(e,t){let n,r=wt.keyframes();for(;!e.end()&&"}"!=(n=e.curr());)if(r.name.length){if("{"==n||"{"==e.curr(-1)){e.next(),r.steps=Rt(e,t);break}e.next()}else if(Ct(e),r.name=Tt(e),!r.name.length){Mt("missing keyframes name",e.info());break}return r}function Pt(e,t={}){for(e.next();!e.end();){let n=e.curr();if(t.inline){if("\n"==n)break}else if("*"==(n=e.curr())&&"/"==e.curr(1))break;e.next()}t.inline||(e.next(),e.next())}function It(e){for(e.next();!e.end();){if(">"==e.curr())break;e.next()}}function Lt(e){let t,n="";for(;!e.end()&&":"!=(t=e.curr());)kt.white_space(t)||(n+=t),e.next();return n}function qt(e,t,n){let r,i=[],l=[],s=[],a="",o="";for(;!e.end();){r=e.curr();let f=e.curr(-1),d=e.curr(1),h=e.index();if(/[\('"`]/.test(r)&&"\\"!==f)s.length?("("!==r&&"("===bt(s)&&s.pop(),"("!=r&&r===bt(s)?s.pop():s.push(r)):s.push(r),a+=r;else if(("@"==r||"."===f&&t)&&!n)l.length||(a=a.trimLeft()),a.length&&(l.push(wt.text(a)),a=""),l.push(Wt(e));else if(n&&/[)]/.test(r)||!n&&/[,)]/.test(r))if(s.length)")"==r&&"("===bt(s)&&s.pop(),a+=r;else{if(a.length&&(l.length?/\S/.test(a)&&l.push(wt.text(a)):l.push(wt.text((c=a).trim().length?kt.number(+c)?+c:c.trim():c)),a.startsWith("±")&&!n)){let e=a.substr(1),t=(u=l,JSON.parse(JSON.stringify(u)));bt(t).value="-"+e,i.push(Ft(t)),bt(l).value=e}if(i.push(Ft(l)),[l,a]=[[],""],")"==r)break}else St[r]&&!/[0-9]/.test(e.curr(-1))&&(r=St[r]),a+=r;if(!(!t||")"!=d&&";"!=d&&/[0-9a-zA-Z_\-.]/.test(e.curr())||s.length)){l.length&&i.push(Ft(l));break}o+=e.range(h,e.index()+1),e.next()}var u,c;return[Bt(i),o]}function Bt(e){let t=bt(e[0]);return t&&"text"===t.type&&!String(t.value).trim().length&&(e[0]=e[0].slice(0,-1)),e}function Ft(e){let t=e.map((e=>{if("text"==e.type&&"string"==typeof e.value){let t=String(e.value);t.includes("`")&&(e.value=t=t.replace(/`/g,'"')),e.value=t}return e})),n=xt(t)||{},r=bt(t)||{};if("text"==n.type&&"text"==r.type){let e=xt(n.value),i=bt(r.value);"string"==typeof n.value&&"string"==typeof r.value&&kt.pair_of(e,i)&&(n.value=n.value.slice(1),r.value=r.value.slice(0,r.value.length-1),t.cluster=!0)}return t}function Ht(e){let t=JSON.stringify(e);return t.includes("pureName")&&t.includes("times")}function Dt(e){return/^@svg$/i.test(e)}function Wt(e){let t,n=wt.func(),r=e.curr(),i=!1;for("@"===r?e.next():r="@";!e.end();){t=e.curr();let l=e.curr(1),s="."==t&&("@"==l||/[a-zA-Z]/.test(l));if("("==t||s){i=!0,e.next();let[t,l]=qt(e,s,jt(r));if(Dt(r)&&/\d\s*{/.test(l)){let e=pt(l);if(Ht(e)){let n=vt(e);n+=")",t=qt(Et(n),s,jt(r))[0]}}n.arguments=t;break}if(/[0-9a-zA-Z_\-.]/.test(t)&&(r+=t),!i&&"("!==l&&!/[0-9a-zA-Z_\-.]/.test(l))break;e.next()}let{fname:l,extra:s}=function(e){let t="",n="";if(/\D$/.test(e)&&!/\d+[x-]\d+/.test(e)||Math[e.substr(1)])return{fname:e,extra:n};for(let r=e.length-1;r>=0;r--){let i=e[r],l=e[r-1],s=e[r+1];if(!(/[\d.]/.test(i)||("x"==i||"-"==i)&&/\d/.test(l)&&/\d/.test(s))){t=e.substring(0,r+1);break}n=i+n}return{fname:t,extra:n}}(r);return n.name=l,s.length&&n.arguments.unshift([{type:"text",value:s}]),n.position=e.info().index,n}function Ut(e){let t,n=wt.text(),r=0,i=!0;const l=[];l[r]=[];let s=[],a=[];for(;!e.end();)if(t=e.curr(),i&&kt.white_space(t))e.next();else{if(i=!1,"\n"!=t||kt.white_space(e.curr(-1)))if(","!=t||s.length){if(/[;}<]/.test(t)&&!a.length){n.value.length&&(l[r].push(n),n=wt.text());break}if("@"==t&&/\w/.test(e.curr(1)))n.value.length&&(l[r].push(n),n=wt.text()),l[r].push(Wt(e));else if('"'===t||"'"===t){t===bt(a)?a.pop():a.length||a.push(t),n.value+=t}else kt.white_space(t)&&kt.white_space(e.curr(-1))||("("==t&&s.push(t),")"==t&&s.pop(),St[t]&&!/[0-9]/.test(e.curr(-1))&&(t=St[t]),n.value+=t)}else n.value.length&&(l[r].push(n),n=wt.text()),l[++r]=[],i=!0;else n.value+=" ";if(";"===e.curr()||"}"==e.curr())break;e.next()}return n.value.length&&l[r].push(n),l}function Xt(e){let t,n="";for(;!e.end()&&"{"!=(t=e.curr());)kt.white_space(t)||(n+=t),e.next();return n}function Gt(e){let t,n={name:"",arguments:[]};for(;!e.end();){if("("==(t=e.curr()))e.next(),n.arguments=qt(e)[0];else{if(/[){]/.test(t))break;kt.white_space(t)||(n.name+=t)}e.next()}return n}function Yt(e,t){let n,r=wt.pseudo();for(;!e.end();){if(n=e.curr(),"/"==n&&"*"==e.curr(1))Pt(e);else{if("}"==n)break;if(kt.white_space(n)){e.next();continue}if(r.selector){let n=Vt(e,t);if("@use"==n.property?r.styles=r.styles.concat(n.value):r.styles.push(n),"}"==e.curr())break}else r.selector=Xt(e)}e.next()}return r}function Vt(e,t){let n,r=wt.rule(),i=e.index();for(;!e.end();){if(n=e.curr(),"/"==n&&"*"==e.curr(1))Pt(e);else{if(";"==n)break;if(r.property.length){r.value=Ut(e);break}if(r.property=Lt(e),"@use"==r.property){r.value=Qt(e,t);break}}e.next()}let l=e.index();return r.raw=()=>e.range(i,l).trim(),r}function Zt(e,t){let n,r=wt.cond();for(;!e.end();){if(n=e.curr(),"/"==n&&"*"==e.curr(1))Pt(e);else{if("}"==n)break;if(r.name.length)if(":"==n){let t=Yt(e);t.selector&&r.styles.push(t)}else if("@"!=n||zt(e,!0).includes(":")){if(!kt.white_space(n)){let n=Vt(e,t);if(n.property&&r.styles.push(n),"}"==e.curr())break}}else r.styles.push(Zt(e));else Object.assign(r,Gt(e))}e.next()}return r}function Kt(e,t){let n="";return e&&e.get_variable&&(n=e.get_variable(t)),n}function Jt(e,t){e.forEach&&e.forEach((e=>{if("text"==e.type&&e.value){let n=Oe(Se(Re(e.value)));e.value=n.reduce(((e,n)=>{let r,i="",l="";i=Kt(t,n.name),!i&&n.fallback&&n.fallback.every((e=>{if(l=Kt(t,e.name),l)return i=l,!1}));try{r=en(i,t)}catch(e){}return r&&e.push.apply(e,r),e}),[])}"func"==e.type&&e.arguments&&e.arguments.forEach((e=>{Jt(e,t)}))}))}function Qt(e,t){return e.next(),(Ut(e)||[]).reduce(((e,n)=>{Jt(n,t);let[r]=n;return r.value&&r.value.length&&e.push(...r.value),e}),[])}function en(e,t){const n=Et(e),r=[];for(;!n.end();){let e=n.curr();if(kt.white_space(e))n.next();else{if("/"==e&&"*"==n.curr(1))Pt(n);else if(":"==e){let e=Yt(n,t);e.selector&&r.push(e)}else if("@"==e&&"@keyframes"===Ct(n,!0)){let e=Ot(n,t);r.push(e)}else if("@"!=e||zt(n,!0).includes(":")){if("<"==e)It(n);else if(!kt.white_space(e)){let e=Vt(n,t);e.property&&r.push(e)}}else{let e=Zt(n,t);e.name.length&&r.push(e)}n.next()}}return r}function tn(e,t=64){const[n,r,i]=[1,t,t*t];let[l,s,a]=(e+"").replace(/\s+/g,"").replace(/[,，xX]+/g,"x").split("x").map((e=>parseInt(e)));const o=1==l||1==s?i:r,u=1==l&&1==s?i:n,c={x:qe(l||n,1,o),y:qe(s||l||n,1,o),z:qe(a||n,1,u)};return Object.assign({},c,{count:c.x*c.y*c.z,ratio:c.x/c.y})}function nn(e){return/^texture\w*$|^(fragment|vertex)$/.test(e)}function rn(){return new ke({type:"LineBreak",value:"\n"})}function ln(e){let t=e[0],n=e[e.length-1];for(;t&&t.isSymbol("(")&&n&&n.isSymbol(")");)t=(e=e.slice(1,e.length-1))[0],n=e[e.length-1];return e}function sn(e){return ln(e).map((e=>e.value)).join("")}function an(e,t){return`url("data:image/svg+xml;utf8,${encodeURIComponent(e)+(t?`#${t}`:"")}")`}function on(e){const t='xmlns="http://www.w3.org/2000/svg"',n='xmlns:xlink="http://www.w3.org/1999/xlink"';return e.includes("<svg")||(e=`<svg ${t} ${n}>${e}</svg>`),e.includes("xmlns")||(e=e.replace(/<svg([\s>])/,`<svg ${t} ${n}$1`)),e}const un="http://www.w3.org/2000/svg",cn="http://www.w3.org/1999/xlink",fn=Qe();class dn{constructor(e,t=""){if(!e)throw new Error("Tag name is required");this.name=e,this.body=[],this.attrs={},this.isTextNode()&&(this.body=t)}isTextNode(){return"text-node"===this.name}find(e){let t=e.attrs.id,n=e.name;if(Array.isArray(this.body)&&void 0!==t)return this.body.find((e=>e.attrs.id===t&&e.name===n))}append(e){this.isTextNode()||this.body.push(e)}merge(e){for(let[t,n]of Object.entries(e.attrs))this.attrs[t]=n;Array.isArray(e.body)&&this.body.push(...e.body)}attr(e,t){if(!this.isTextNode())return void 0===t?this.attrs[e]:this.attrs[e]=t}toString(){if(this.isTextNode())return hn(this.body);let e=[""],t=[];for(let[t,n]of Object.entries(this.attrs))n=hn(n),e.push(`${t}="${n}"`);for(let e of this.body)t.push(e.toString());return`<${this.name}${e.join(" ")}>${t.join("")}</${this.name}>`}}function hn(e){let t=(e=String(e)).startsWith('"')&&e.endsWith('"'),n=e.startsWith("'")&&e.endsWith("'");return t||n?e.substring(1,e.length-1):e}function mn(e,t,n,r){let i;if(t||(t=new dn("root")),"block"===e.type)if("style"===e.name){let n=new dn("style");n.append(e.value),t.append(n)}else{let n=new dn(e.name);r||(r=n).attr("xmlns",un);for(let t of e.value){let l=mn(t,n,e,r);l&&(i=l)}if(e.inline){let t=e.value.find((e=>"statement"===e.type&&"id"===e.name));t?i=t.value:(i=fn(e.name),n.attr("id",i))}let l=r.find(n);l?l.merge(n):t.append(n)}if("statement"===e.type&&!e.variable)if("content"===e.name){let n=new dn("text-node",e.value);t.append(n)}else if(e.name.startsWith("style ")){let n=(e.name.split("style ")[1]||"").trim();if(n.length){let r=t.attr("style")||"";t.attr("style",r+function(e,t){return`${e}:${t};`}(n,e.value))}}else{let n=e.value;if(n&&"block"===n.type){let t=mn(e.value,r,e,r);n=`url(#${t})`,"xlink:href"!==e.name&&"href"!==e.name||(n=`#${t}`)}/viewBox/i.test(e.name)?(n=function(e){let t=e.detail.value,n=e.detail.padding||e.detail.expand;if(!t.length)return"";let[r,i,l,s]=t;return n&&([r,i,l,s]=[r-n,r-n,l+2*n,s+2*n]),`${r} ${i} ${l} ${s}`}(e),n&&t.attr(e.name,n)):t.attr(e.name,n),e.name.includes("xlink:")&&r.attr("xmlns:xlink",cn)}return n?i:r.toString()}function pn(e){return mn(e)}function gn(e){let t=Se(Re(e)),n={},r=!1;for(;t.next();){let{prev:e,curr:i,next:l}=t.get(),s=r&&(i.isWord()||i.isSymbol())&&e&&e.isNumber()&&!l;if(i.isNumber())n.value=Number(i.value),r=!0;else{if(!s)break;n.unit=i.value}}return n}function vn(e){return(...t)=>{let n=[],r=[];for(let e of t){let{unit:t,value:i}=gn(e);void 0!==t&&n.push(t),void 0!==i&&r.push(i)}let i=e(...r),l=n.find((e=>void 0!==e));return void 0===l?i:Array.isArray(i)?i.map((e=>e+l)):i+l}}function yn(e){return(...t)=>{let n=t.map((e=>String(e).charCodeAt(0))),r=e(...n);return Array.isArray(r)?r.map((e=>String.fromCharCode(e))):String.fromCharCode(r)}}const _n={"π":Math.PI,gcd:(e,t)=>{for(;t;)[e,t]=[t,e%t];return e}},bn={"^":7,"*":6,"/":6,"÷":6,"%":6,"&":5,"|":5,"+":4,"-":4,"<":3,"<<":3,">":3,">>":3,"=":3,"==":3,"≤":3,"<=":3,"≥":3,">=":3,"≠":3,"!=":3,"∧":2,"&&":2,"∨":2,"||":2,"(":1,")":1};function xn(e,t,n=[]){let r=[];for(;e.length;){let{name:l,value:s,type:a}=e.shift();if("variable"===a){let e=t[s];We(e)&&(e=Math[s]),We(e)&&(e=kn(s,t)),We(e)&&/^\-\D/.test(s)&&(e=kn("-1"+s.substr(1),t)),void 0===e&&(e=0),"number"!=typeof e&&(n.push(e),(i=n)[0]==i[2]&&i[1]==i[3]?(e=0,n=[]):e=xn($n(e),t,n)),r.push(e)}else if("function"===a){let e=!1;/^\-/.test(l)&&(e=!0,l=l.substr(1));let n,i=s.map((e=>xn(e,t))),a=l.split(".");for(;n=a.pop();){if(!n)continue;let e=t[n]||Math[n];i="function"==typeof e?Array.isArray(i)?e(...i):e(i):0}e&&(i*=-1),r.push(i)}else if(/\d+/.test(s))r.push(s);else{let e=r.pop(),t=r.pop();r.push(wn(s,Number(t),Number(e)))}}var i;return Number(r[0])||0}function $n(e){let t=function(e){let t=String(e),n=[],r="";for(let e=0;e<t.length;++e){let i=t[e];if(bn[i]){let l=bt(n);if("="==i&&l&&/^[!<>=]$/.test(l.value))l.value+=i;else if(/^[|&<>]$/.test(i)&&l&&l.value==i)l.value+=i;else if("-"==i&&"e"==t[e-1])r+=i;else if(n.length||r.length||!/[+-]/.test(i)){let{type:e,value:t}=l||{};"operator"==e&&!r.length&&/[^()]/.test(i)&&/[^()]/.test(t)?r+=i:(r.length&&(n.push({type:"number",value:r}),r=""),n.push({type:"operator",value:i}))}else r+=i}else/\S/.test(i)&&(","==i?(n.push({type:"number",value:r}),r="",n.push({type:"comma",value:i})):"!"==i?(n.push({type:"number",value:r}),n.push({type:"operator",value:i}),r=""):r+=i)}return r.length&&n.push({type:"number",value:r}),n}(e);const n=[],r=[];for(let e=0;e<t.length;++e){let{type:i,value:l}=t[e],s=t[e+1]||{};if("number"==i)if("("==s.value&&/[^\d.\-]/.test(l)){let n="",i=[],s=[];for(e+=1;void 0!==t[e++];){let r=t[e];if(void 0===r)break;let l=r.value;if(")"==l){if(!i.length)break;i.pop(),n+=l}else if("("==l&&i.push(l),","!=l||i.length)n+=l;else{let e=$n(n);e.length&&s.push(e),n=""}}n.length&&s.push($n(n)),r.push({type:"function",name:l,value:s})}else/[^\d.\-]/.test(l)?r.push({type:"variable",value:l}):r.push({type:"number",value:l});else if("operator"==i)if("("==l)n.push(l);else if(")"==l){for(;n.length&&"("!=bt(n);)r.push({type:"operator",value:n.pop()});n.pop()}else{for(;n.length&&bn[bt(n)]>=bn[l];){let e=n.pop();/[()]/.test(e)||r.push({type:"operator",value:e})}n.push(l)}}for(;n.length;)r.push({type:"operator",value:n.pop()});return r}function wn(e,t,n){switch(e){case"+":return t+n;case"-":return t-n;case"*":return t*n;case"%":return t%n;case"|":return t|n;case"&":return t&n;case"<":return t<n;case">":return t>n;case"^":return Math.pow(t,n);case"÷":case"/":return t/n;case"=":case"==":return t==n;case"≤":case"<=":return t<=n;case"≥":case">=":return t>=n;case"≠":case"!=":return t!=n;case"∧":case"&&":return t&&n;case"∨":case"||":return t||n;case"<<":return t<<n;case">>":return t>>n}}function kn(e,t){let[n,r,i]=e.match(/([\d.\-]+)(.*)/)||[],l=t[i];return void 0===l?l:"number"==typeof l?Number(r)*l:r*xn($n(l),t)}function Sn(e,t){return xn($n(e),Object.assign({},_n,t))}var jn=new class{constructor(){this.cache={}}clear(){this.cache={}}set(e,t){if(De(e))return"";let n=this.getKey(e);return this.cache[n]=t}get(e){let t=this.getKey(e);return this.cache[t]}getKey(e){return Je("string"==typeof e?e:JSON.stringify(e))}};function En(e,t){return(...n)=>{let r=e+n.join("-");return jn.get(r)||jn.set(r,t(...n))}}function Mn(e,t){return{type:e,value:t}}const An=En("build_range",(e=>{let t=function(e){let t=String(e),n=[],r=[];if(!t.startsWith("[")||!t.endsWith("]"))return n;for(let e=1;e<t.length-1;++e){let i=t[e];if("-"!=i||"-"!=t[e-1])if("-"!=i)if("-"!=bt(r))r.length&&n.push(Mn("char",r.pop())),r.push(i);else{r.pop();let e=r.pop();n.push(e?Mn("range",[e,i]):Mn("char",i))}else r.push(i)}return r.length&&n.push(Mn("char",r.pop())),n}(e);return $t(t,(({type:e,value:t})=>{if("char"==e)return t;let[n,r]=t,i=!1;n>r&&([n,r]=[r,n],i=!0);let l=yn(Be)(n,r);return i&&l.reverse(),l}))}));function Cn(e){return(...t)=>e(...$t(t,(e=>String(e).startsWith("[")?An(e):e)))}class Tn{constructor(e){this.prev=this.next=null,this.data=e}}class zn{constructor(e=20){this._limit=e,this._size=0}push(e){this._size>=this._limit&&(this.root=this.root.next,this.root.prev=null);let t=new Tn(e);this.root?(t.prev=this.tail,this.tail.next=t,this.tail=t):this.root=this.tail=t,this._size++}last(e=1){let t=this.tail;for(;--e&&t.prev;)t=t.prev;return t.data}}class Nn{constructor(e){var t;this.p=(t=e([151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180]),[].concat(t,t))}grad(e,t,n,r){let i=15&e,l=i<8?t:n,s=i<4?n:12==i||14==i?t:r;return(0==(1&i)?l:-l)+(0==(2&i)?s:-s)}noise(e,t,n){let{p:r,grad:i}=this,[l,s,a]=[e,t,n].map((e=>255&Math.floor(e)));[e,t,n]=[e,t,n].map((e=>e-Math.floor(e)));let[o,u,c]=[e,t,n].map((e=>e*e*e*(e*(6*e-15)+10))),f=r[l]+s,d=r[f]+a,h=r[f+1]+a,m=r[l+1]+s,p=r[m]+a,g=r[m+1]+a;return et(c,et(u,et(o,i(r[d],e,t,n),i(r[p],e-1,t,n)),et(o,i(r[h],e,t-1,n),i(r[g],e-1,t-1,n))),et(u,et(o,i(r[d+1],e,t,n-1),i(r[p+1],e-1,t,n-1)),et(o,i(r[h+1],e,t-1,n-1),i(r[g+1],e-1,t-1,n-1))))}}function Rn(e,t){let n={},r=!0;for(let i=0;i<e.length;++i){let l=e[i],s=t[i];if(/=/.test(l)){let[e,i]=nt(l,{symbol:"=",noSpace:!0});void 0!==i?(t.includes(e)&&(n[e]=i),r=!1):n[s]=l}else r&&(n[s]=l)}return n}function On(e){let t,n=Se(Re(e)),r={},i=[],l=!1;for(;n.next();){let{prev:e,curr:s,next:a}=n.get();if(s.isSymbol(":")&&!t)t=In(i),i=[];else if(s.isSymbol(";")&&t)r[t]=Pn(t,In(i),l),i=[],t=null,l=!1;else if(!s.isSymbol(";")){let n=e&&e.isSymbol("-"),r=a&&a.isSymbol("-"),o=s.isSymbol("-");t||i.length||!o||n||r||a&&a.isSymbol(":")?i.push(s):l=!0}}return i.length&&t&&(r[t]=Pn(t,In(i),l)),r}function Pn(e,t,n){return["fill-rule","fill"].includes(e)?t:n?`-1 * (${t})`:t}function In(e){return e.map((e=>e.value)).join("")}const Ln=["auto","reverse"],qn=["deg","rad","grad","turn"];function Bn(e){let t=Se(Re(e)),n=!1,r="",i={direction:"",angle:""};for(;t.next();){let{prev:e,curr:l,next:s}=t.get();if(l.isWord()&&Ln.includes(l.value))i.direction=l.value,n=!0;else if(l.isNumber())i.angle=Number(l.value),n=!0;else if(l.isWord()&&e&&e.isNumber()&&qn.includes(l.value))r=l.value;else if(l.isSpace()&&""!==i.direction&&""!==i.angle)break}return n||(i.direction="auto"),function(e,t){let{angle:n}=e;""===n&&(n=0);"rad"===t&&(n/=Math.PI/180);"grad"===t&&(n*=.9);"turn"===t&&(n*=360);return Object.assign({},e,{angle:n})}(i,r)}const{cos:Fn,sin:Hn,abs:Dn,atan2:Wn,PI:Un}=Math,Xn=(Gn=e=>Jn(On(e),{min:3,max:3600}),(e,...t)=>{let n=(r=e,De(r)?[]:Array.isArray(r)?r:[r]).reduce(((e,n,r)=>{return e+n+(De(i=t[r])?"":i);var i}),"");var r;return Gn(n)});var Gn;const Yn={circle:()=>Xn`
    split: 180;
    scale: .99
  `,triangle:()=>Xn`
    rotate: 30;
    scale: 1.1;
    move: 0 .2
  `,pentagon:()=>Xn`
    split: 5;
    rotate: 54
  `,hexagon:()=>Xn`
    split: 6;
    rotate: 30;
    scale: .98
  `,octagon:()=>Xn`
    split: 8;
    rotat: 22.5;
    scale: .99
  `,star:()=>Xn`
    split: 10;
    r: cos(5t);
    rotate: -18;
    scale: .99
  `,infinity:()=>Xn`
    split: 180;
    scale: .99;
    x: cos(t)*.99 / (sin(t)^2 + 1);
    y: x * sin(t)
  `,heart:()=>Xn`
    split: 180;
    rotate: 180;
    a: cos(t)*13/18 - cos(2t)*5/18;
    b: cos(3t)/18 + cos(4t)/18;
    x: (.75 * sin(t)^3) * 1.2;
    y: (a - b + .2) * -1.1
  `,bean:()=>Xn`
    split: 180;
    r: sin(t)^3 + cos(t)^3;
    move: -.35 .35;
  `,bicorn:()=>Xn`
    split: 180;
    x: cos(t);
    y: sin(t)^2 / (2 + sin(t)) - .5
  `,drop:()=>Xn`
    split: 180;
    rotate: 90;
    scale: .95;
    x: sin(t);
    y: (1 + sin(t)) * cos(t) / 1.6
  `,fish:()=>Xn`
    split: 240;
    x: cos(t) - sin(t)^2 / sqrt(2) - .04;
    y: sin(2t)/2
  `,whale:()=>Xn`
    split: 240;
    rotate: 180;
    R: 3.4 * (sin(t)^2 - .5) * cos(t);
    x: cos(t) * R + .75;
    y: sin(t) * R * 1.2
  `,windmill:()=>Xn`
    split: 18;
    R: seq(.618, 1, 0);
    T: seq(t-.55, t, t);
    x: R * cos(T);
    y: R * sin(T)
  `,vase:()=>Xn`
    split: 240;
    scale: .3;
    x: sin(4t) + sin(t) * 1.4;
    y: cos(t) + cos(t) * 4.8 + .3
  `,clover:(e=3)=>(4==(e=qe(e,3,5))&&(e=2),Xn`
      split: 240;
      r: cos(${e}t);
      scale: .98
    `),hypocycloid:(e=3)=>(e=qe(e,3,5),Xn`
      split: 240;
      scale: ${[0,0,0,.34,.25,.19][e]};
      k: ${e};
      x: (k-1)*cos(t) + cos((k-1)*t);
      y: (k-1)*sin(t) - sin((k-1)*t)
    `),bud:(e=3)=>(e=qe(e,3,10),Xn`
      split: 240;
      scale: .8;
      r: 1 + .2 * cos(${e}t)
    `)};class Vn{constructor(e,t,n){this.x=e,this.y=t,this.extra=n}valueOf(){return this.x+" "+this.y}toString(){return this.valueOf()}}function Zn(e,t){"function"==typeof arguments[0]&&(t=e,e={}),t||(t=e=>[Fn(e),Hn(e)]);let n,r,i=e.split||180,l=e.turn||1,s=e.frame,a=e.fill||e["fill-rule"],o=Bn(e.direction||e.dir||""),u=e.unit,c=2*Un*l/i,f=[],d=void 0===e.scale?1:e.scale,h=([e,t,n=0,r=0])=>{if("evenodd"==e||"nonzero"==e)return f.push(new Vn(e,"",""));let[i,l]=Kn(e,-t,d),[s,a]=Kn(n,-r,d),c=function(e,t,n,r,i){let l=180*Wn(t+r,e-n)/Un;"reverse"===i.direction&&(l-=180);i.direction||(l=90);i.angle&&(l+=i.angle);return l}(i,l,s,a,o);void 0!==u&&"%"!==u?"none"!==u&&(i+=u,l+=u):(i=50*(i+1)+"%",l=50*(l+1)+"%"),f.push(new Vn(i,l,c))};"nonzero"!=a&&"evenodd"!=a||h([a,"",""]);for(let e=0;e<i;++e){let r=t(c*e,e);e||(n=r),h(r)}if(void 0!==s){h(n);let e=s/100;l>1&&(e*=2),0==e&&(e=.002);for(let n=0;n<i;++n){let i=-c*n,[l,s,a=0,o=0]=t(i,n),u=Wn(s+o,l-a),f=[l-e*Fn(u),s-e*Hn(u)];n||(r=f),h(f)}h(r),h(n)}return f}function Kn(e,t,n){let[r,i=r]=nt(n).map(Number);return[e*r,t*i]}function Jn(e,{min:t,max:n}){let r=qe(parseInt(e.vertices||e.points||e.split)||0,t,n),i=Ue(e.x)?"cos(t)":e.x,l=Ue(e.y)?"sin(t)":e.y,s=Ue(e.r)?"":e.r,{unit:a,value:o}=gn(s);return a&&!e[a]&&"t"!==a&&(Ue(e.unit)&&(e.unit=a),s=e.r=o),e.degree&&(e.rotate=e.degree),e.origin&&(e.move=e.origin),Zn(Object.assign({},e,{split:r}),((t,n)=>{let a=Object.assign({},e,{t:t,"θ":t,i:n+1,seq:(...e)=>e.length?e[n%e.length]:"",range:(e,t=0)=>((e=Number(e)||0)>(t=Number(t)||0)&&([e,t]=[t,e]),e+Dn(t-e)/(r-1)*n)}),o=Sn(i,a),u=Sn(l,a),c=0,f=0;if(s){let e=Sn(s,a);0==e&&(e=1e-5),o=e*Fn(t),u=e*Hn(t)}return e.rotate&&([o,u]=function(e,t,n){let r=-Un/180*n;return[e*Fn(r)-t*Hn(r),t*Fn(r)+e*Hn(r)]}(o,u,Number(e.rotate)||0)),e.move&&([o,u,c,f]=function(e,t,n){let[r,i=r]=nt(n).map(Number);return[e+(r||0),t-(i||0),r,i]}(o,u,e.move)),[o,u,c,f]}))}function Qn(e){let t=Se(Re(e)),n={},r={commands:[],valid:!0};for(;t.next();){let{curr:e}=t.get();if(!e.isSpace()&&!e.isSymbol(","))if(e.isWord())n.name&&(r.commands.push(n),n={}),n.name=e.value,n.value=[],"MmLlHhVvCcSsQqTtAaZz".includes(e.value)?"mlhvcsqtaz".includes(e.value)?n.type="relative":n.type="absolute":(n.type="unknown",r.valid=!1);else if(n.value){let t=e.value;e.isNumber()&&(t=Number(e.value)),n.value.push(t)}else n.name||(r.valid=!1)}return n.name&&r.commands.push(n),r}const er={name:"cssd-uniform-time","animation-name":"cssd-uniform-time-animation","animation-duration":31536e6,"animation-iteration-count":"infinite","animation-delay":"0s","animation-direction":"normal","animation-fill-mode":"none","animation-play-state":"running","animation-timing-function":"linear"};er.animation=`\n  ${er["animation-duration"]}ms\n  ${er["animation-timing-function"]}\n  ${er["animation-delay"]}\n  ${er["animation-iteration-count"]}\n  ${er["animation-name"]}\n`;const tr={name:"cssd-uniform-mousex"},nr={name:"cssd-uniform-mousey"},rr={name:"cssd-uniform-width"},ir={name:"cssd-uniform-height"};var lr=Object.freeze({__proto__:null,uniform_height:ir,uniform_mousex:tr,uniform_mousey:nr,uniform_time:er,uniform_width:rr});function sr(e){return Xe(((t,n,...r)=>{if(!r||!n)return"";let i=Ye(n()),l=i;/\D/.test(i)&&!/\d+[x-]\d+/.test(i)&&(l=Sn(i),0===l&&(l=i));let s=Math.random();return function(e,t){let[n,r=1]=String(e).split(/[x-]/),[i,l]=[Math.ceil(n),Math.ceil(r)];We(i)&&(i=1),We(l)&&(l=1),n=qe(i,0,65536),r=qe(l,0,65536);let s=n*r,a=[],o=1;if(/x/.test(e))for(let e=1;e<=r;++e)for(let i=1;i<=n;++i)a.push(t(o++,i,e,s,n,r,o));else if(/-/.test(e))if(s=Math.abs(n-r)+1,n<=r)for(let e=n;e<=r;++e)a.push(t(e,e,1,s,s,1,o++));else for(let e=n;e>=r;--e)a.push(t(e,e,1,s,s,1,o++));else for(let e=1;e<=n;++e)a.push(t(e,e,1,n,n,1,o++));return a}(l,((...e)=>r.map((t=>Ye(t(...e,s)))).join(","))).join(e)}))}function ar(e,t,n){return e[t]||(e[t]=new zn),e[t].push(n),n}function or(e){return-1*e}function ur(e){return t=>{if(Ue(t)||Ue(e))return e;if(/^[+*-\/%][.\d\s]/.test(t)){let n=t[0],r=Number(t.substr(1).trim())||0;switch(n){case"+":return e+r;case"-":return e-r;case"*":return e*r;case"/":return e/r;case"%":return e%r}}else if(/[+*-\/%]$/.test(t)){let n=t.substr(-1),r=Number(t.substr(0,t.length-1).trim())||0;switch(n){case"+":return r+e;case"-":return r-e;case"*":return r*e;case"/":return r/e;case"%":return r%e}}return e+(Number(t)||0)}}const cr=Fe({i:({count:e})=>ur(e),y:({y:e})=>ur(e),x:({x:e})=>ur(e),z:({z:e})=>ur(e),I:({grid:e})=>ur(e.count),Y:({grid:e})=>ur(e.y),X:({grid:e})=>ur(e.x),Z:({grid:e})=>ur(e.z),id:({x:e,y:t,z:n})=>r=>Ge(e,t,n),dx:({x:e,grid:t})=>n=>(n=Number(n)||0,e-.5-n-t.x/2),dy:({y:e,grid:t})=>n=>(n=Number(n)||0,e-.5-n-t.y/2),n({extra:e}){let t=bt(e);return t?ur(t[0]):"@n"},nx({extra:e}){let t=bt(e);return t?ur(t[1]):"@nx"},ny({extra:e}){let t=bt(e);return t?ur(t[2]):"@ny"},N({extra:e}){let t=bt(e);return t?ur(t[3]):"@N"},m:sr(","),M:sr(" "),"µ":sr(""),p:({context:e,pick:t})=>Cn(((...n)=>{n.length||(n=e.last_pick_args||[]);let r=t(n);return e.last_pick_args=n,ar(e,"last_pick",r)})),P({context:e,pick:t,position:n}){let r="P-counter"+n;return Cn(((...n)=>{let i=!0;n.length||(n=e.last_pick_args||[],i=!1);let l=e.last_pick,s=l?l.last(1):"";if(i&&(e[r]||(e[r]={}),s=e[r].last_pick),n.length>1){let e=n.findIndex((e=>e===s));-1!==e&&n.splice(e,1)}let a=t(n);return e.last_pick_args=n,i&&(e[r].last_pick=a),ar(e,"last_pick",a)}))},pl({context:e,extra:t,position:n}){let r=bt(t),i="pl-counter"+n+(r?bt(r):"");return Cn(((...t)=>{e[i]||(e[i]=0),e[i]+=1;let n=t.length,l=r&&r[6];De(l)&&(l=e[i]);let s=t[(l-1)%n];return ar(e,"last_pick",s)}))},pr({context:e,extra:t,position:n}){let r=bt(t),i="pr-counter"+n+(r?bt(r):"");return Cn(((...t)=>{e[i]||(e[i]=0),e[i]+=1;let n=t.length,l=r&&r[6];De(l)&&(l=e[i]);let s=t[n-(l-1)%n-1];return ar(e,"last_pick",s)}))},pd({context:e,extra:t,position:n,shuffle:r}){let i=bt(t),l=i?bt(i):"",s="pd-counter"+n+l,a="pd-values"+n+l;return Cn(((...t)=>{e[s]||(e[s]=0),e[s]+=1,e[a]||(e[a]=r(t||[]));let n=t.length,l=i&&i[6];De(l)&&(l=e[s]);let o=(l-1)%n,u=e[a][o];return ar(e,"last_pick",u)}))},lp:({context:e})=>(t=1)=>{let n=e.last_pick;return n?n.last(t):""},r:({context:e,rand:t})=>(...n)=>{let r=(n.every(He)?yn:vn)(t)(...n);return ar(e,"last_rand",r)},rn({x:e,y:t,context:n,position:r,grid:i,extra:l,shuffle:s}){let a="noise-2d"+r,[o,u,c,f,d,h]=bt(l)||[],m=o&&f;return(...r)=>{let{from:l=0,to:o=l,frequency:f=1,amplitude:p=1}=Rn(r,["from","to","frequency","amplitude"]);1==r.length&&([l,o]=[0,l]),n[a]||(n[a]=new Nn(s)),f=qe(f,0,1/0),p=qe(p,0,1/0);let g=[l,o].every(He)?yn:vn,v=m?n[a].noise((u-1)/d*f,(c-1)/h*f,0):n[a].noise((e-1)/i.x*f,(t-1)/i.y*f,0),y=g(((e,t)=>function(e,t,n,r=1){let i=Math.sqrt(.5)*r,[l,s]=[-i,i];return et((e-l)/(s-l),t*r,n*r)}(v*p,e,t,p))),_=y(l,o);return ar(n,"last_rand",_)}},lr:({context:e})=>(t=1)=>{let n=e.last_rand;return n?n.last(t):""},noise({context:e,grid:t,position:n,shuffle:r,...i}){let l={i:i.count,I:t.count,x:i.x,X:t.x,y:i.y,Y:t.y,z:i.z,Z:t.z};return(t,i,s=0)=>{let a="raw-noise-2d"+n;return e[a]||(e[a]=new Nn(r)),e[a].noise(Sn(t,l),Sn(i,l),Sn(s,l))}},stripe:()=>(...e)=>{let t,n=e.map(Ye),r=n.length,i=0,l=[];if(!r)return"";n.forEach((e=>{let[t,n]=nt(e);void 0!==n?l.push(n):i+=1}));let s=l.length?`(100% - ${l.join(" - ")}) / ${i}`:`100% / ${r}`;return n.map(((e,n)=>{if(l.length){let[n,r]=nt(e);return t=(t?t+" + ":"")+(void 0!==r?r:s),`${n} 0 calc(${t})`}return`${e} 0 ${100/r*(n+1)}%`})).join(",")},calc:()=>e=>Sn(Ye(e)),hex:()=>e=>parseInt(Ye(e)).toString(16),svg:Xe(((e,...t)=>{let n=t.map((e=>Ye(e()))).join(",");if(!n.startsWith("<")){n=pn(pt(n))}return an(on(n))})),Svg:Xe(((e,...t)=>{let n=t.map((e=>Ye(e()))).join(",");if(!n.startsWith("<")){n=pn(pt(n))}return on(n)})),filter:Xe(((e,...t)=>{let n=t.map((e=>Ye(e()))),r=n.join(","),i=tt("filter-");if(n.every((e=>/^[\d.]/.test(e)||/^(\w+)/.test(e)&&!/[{}<>]/.test(e)))){let{frequency:t,scale:i=1,octave:l,seed:s=e.seed,blur:a,erode:o,dilate:u}=Rn(n,["frequency","scale","octave","seed","blur","erode","dilate"]);if(r="\n        x: -20%;\n        y: -20%;\n        width: 140%;\n        height: 140%;\n      ",De(u)||(r+=`\n          feMorphology {\n            operator: dilate;\n            radius: ${u};\n          }\n        `),De(o)||(r+=`\n          feMorphology {\n            operator: erode;\n            radius: ${o};\n          }\n        `),De(a)||(r+=`\n          feGaussianBlur {\n            stdDeviation: ${a};\n          }\n        `),!De(t)){let[e,n=e]=nt(t);l=l?`numOctaves: ${l};`:"",r+=`\n          feTurbulence {\n            type: fractalNoise;\n            baseFrequency: ${e} ${n};\n            seed: ${s};\n            ${l}\n          }\n          feDisplacementMap {\n            in: SourceGraphic;\n            scale: ${i};\n          }\n        `}}if(!r.startsWith("<")){r=pn(pt(r,{type:"block",name:"filter"}))}return an(on(r).replace(/<filter([\s>])/,`<filter id="${i}"$1`),i)})),"svg-pattern":Xe(((e,...t)=>an(pn(pt(`\n      viewBox: 0 0 1 1;\n      preserveAspectRatio: xMidYMid slice;\n      rect {\n        width, height: 100%;\n        fill: defs pattern { ${t.map((e=>Ye(e()))).join(",")} }\n      }\n    `))))),var:()=>e=>`var(${Ye(e)})`,ut:()=>e=>`var(--${er.name})`,uw:()=>e=>`var(--${rr.name})`,uh:()=>e=>`var(--${ir.name})`,ux:()=>e=>`var(--${tr.name})`,uy:()=>e=>`var(--${nr.name})`,plot({count:e,context:t,extra:n,position:r,grid:i}){let l="offset-points"+r,s=bt(n);return n=>{let[r=e,a,o,u=i.count]=s||[];if(!t[l]){let e=On(n);delete e.fill,delete e["fill-rule"],delete e.frame,e.points=u,t[l]=Jn(e,{min:1,max:65536})}return t[l][r-1]}},Plot({count:e,context:t,extra:n,position:r,grid:i}){let l="Offset-points"+r,s=bt(n);return n=>{let[r=e,a,o,u=i.count]=s||[];if(!t[l]){let e=On(n);delete e.fill,delete e["fill-rule"],delete e.frame,e.points=u,e.unit=e.unit||"none",t[l]=Jn(e,{min:1,max:65536})}return t[l][r-1]}},shape:()=>En("shape-function",((e="",...t)=>{let n=[];if((e=String(e).trim()).length)if("function"==typeof Yn[e])n=Yn[e](t);else{let r=e,i=t.join(",");i.length&&(r=e+","+i),n=Jn(On(r),{min:3,max:3600})}return`polygon(${n.join(",")})`})),doodle:()=>e=>e,shaders:()=>e=>e,canvas:()=>e=>e,pattern:()=>e=>e,invert:()=>e=>{let t=Qn(e);return t.valid?t.commands.map((({name:e,value:t})=>{switch(e){case"v":return"h"+t.join(" ");case"V":return"H"+t.join(" ");case"h":return"v"+t.join(" ");case"H":return"V"+t.join(" ");default:return e+t.join(" ")}})).join(" "):e},flipH:()=>e=>{let t=Qn(e);return t.valid?t.commands.map((({name:e,value:t})=>{switch(e){case"h":case"H":return e+t.map(or).join(" ");default:return e+t.join(" ")}})).join(" "):e},flipV:()=>e=>{let t=Qn(e);return t.valid?t.commands.map((({name:e,value:t})=>{switch(e){case"v":case"V":return e+t.map(or).join(" ");default:return e+t.join(" ")}})).join(" "):e},flip(...e){let t=cr.flipH(...e),n=cr.flipV(...e);return e=>n(t(e))},reverse:()=>(...e)=>{let t=e.map(Ye),n=Qn(t.join(","));if(n.valid){let e=[];for(let t=n.commands.length-1;t>=0;--t){let{name:r,value:i}=n.commands[t];e.push(r+i.join(" "))}return e.join(" ")}return t.reverse()},cycle:()=>(...e)=>{let t,n=[];1==e.length?(t=" ",n=nt(e[0],{symbol:t})):(t=",",n=nt(e.map(Ye).join(t),{symbol:t}));let r=n.length-1,i=[n.join(t)];for(let e=0;e<r;++e){let e=n.pop();n.unshift(e),i.push(n.join(t))}return i},mirror:()=>(...e)=>{for(let t=e.length-1;t>=0;--t)e.push(e[t]);return e},Mirror:()=>(...e)=>{for(let t=e.length-2;t>=0;--t)e.push(e[t]);return e},unicode:()=>(...e)=>e.map((e=>String.fromCharCode(e)))},{index:"i",col:"x",row:"y",depth:"z",rand:"r",pick:"p",pn:"pl",pnr:"pr",stripes:"stripe",strip:"stripe",patern:"pattern",flipv:"flipV",fliph:"flipH",t:"ut","svg-filter":"filter","last-rand":"lr","last-pick":"lp",multiple:"m",multi:"m",rep:"µ",repeat:"µ",ms:"M",s:"I",size:"I",sx:"X","size-x":"X","size-col":"X","max-col":"X",sy:"Y","size-y":"Y","size-row":"Y","max-row":"Y",sz:"Z","size-z":"Z","size-depth":"Z","pick-by-turn":"pl","pick-n":"pl","pick-d":"pd",offset:"plot",Offset:"Plot",point:"plot",Point:"Plot",paint:"canvas"}),fr={"4a0":[1682,2378],"2a0":[1189,1682],a0:[841,1189],a1:[594,841],a2:[420,594],a3:[297,420],a4:[210,297],a5:[148,210],a6:[105,148],a7:[74,105],a8:[52,74],a9:[37,52],a10:[26,37],b0:[1e3,1414],b1:[707,1e3],b2:[500,707],b3:[353,500],b4:[250,353],b5:[176,250],b6:[125,176],b7:[88,125],b8:[62,88],b9:[44,62],b10:[31,44],b11:[22,32],b12:[16,22],c0:[917,1297],c1:[648,917],c2:[458,648],c3:[324,458],c4:[229,324],c5:[162,229],c6:[114,162],c7:[81,114],c8:[57,81],c9:[40,57],c10:[28,40],c11:[22,32],c12:[16,22],d0:[764,1064],d1:[532,760],d2:[380,528],d3:[264,376],d4:[188,260],d5:[130,184],d6:[92,126],letter:[216,279],postcard:[100,148],poster:[390,540]},dr={portrait:"p",pt:"p",p:"p",landscape:"l",ls:"l",l:"l"};let hr=[];function mr(e){if(!hr.length){let e=new Set;if("undefined"!=typeof document)for(let t in document.head.style)t.startsWith("-")||e.add(t.replace(/[A-Z]/g,"-$&").toLowerCase());e.has("grid-gap")||e.add("grid-gap"),hr=Array.from(e)}return e instanceof RegExp?hr.filter((t=>e.test(t))):hr}function pr(e){let t=new RegExp(`\\-?${e}\\-?`);return mr(t).map((e=>e.replace(t,""))).reduce(((e,t)=>(e[t]=t,e)),{})}const gr=pr("webkit"),vr=pr("moz");function yr(e,t){return gr[e]?`-webkit-${t} ${t}`:vr[e]?`-moz-${t} ${t}`:t}const _r={center:"50%",left:"0%",right:"100%",top:"50%",bottom:"50%"},br={center:"50%",top:"0%",bottom:"100%",left:"50%",right:"50%"};var xr=Fe({size(e,{is_special_selector:t,grid:n}){let[r,i=r,l]=nt(e);fr[r]&&([r,i]=function(e,t){e=String(e).toLowerCase();let[n,r]=fr[e]||[];return"p"==dr[t]&&([r,n]=[n,r]),[r,n].map((e=>e+"mm"))}(r,i));let s=`\n      width: ${r};\n      height: ${i};\n    `;return"auto"!==r&&"auto"!==i||(l&&(/^\(.+\)$/.test(l)?l=l.substring(1,l.length-1):/^calc/.test(l)||(l=`calc(${l})`),t||(s+=`aspect-ratio: ${l};`)),t&&(s+=`aspect-ratio: ${l||n.ratio};`)),t||(s+=`\n        --internal-cell-width: ${r};\n        --internal-cell-height: ${i};\n      `),s},place(e,{extra:t}){let[n,r="50%"]=nt(e);n=_r[n]||n,r=br[r]||r;const i="var(--internal-cell-width, 25%)",l="var(--internal-cell-height, 25%)";return`\n      position: absolute;\n      left: ${n};\n      top: ${r};\n      width: ${i};\n      height: ${l};\n      margin-left: calc(${i} / -2);\n      margin-top: calc(${l} / -2);\n      grid-area: unset;\n      --plot-angle: ${t||0};\n      rotate: ${t||0}deg;\n    `},grid(e,t){let n={clip:!0};/no\-*clip/i.test(e)&&(n.clip=!1,e=e.replace(/no\-*clip/i,""));let r=nt(e,{symbol:["/","+","*","|","-"],noSpace:!0,verbose:!0});for(let{group:e,value:i}of r)"+"===e&&(n.scale=i),"*"===e&&(n.rotate=i),"/"===e&&(void 0===n.size?n.size=this.size(i,t):n.fill=i),"|"!==e&&"-"!=e&&""!=e||n.grid||(n.grid=tn(i,t.max_grid),"|"===e&&(n.flexColumn=!0),"-"===e&&(n.flexRow=!0));return n},gap:e=>e,seed:e=>e,shape:En("shape-property",(e=>{let[t,...n]=nt(e);if("function"!=typeof Yn[t])return"";let r="clip-path";return yr(r,`${r}: polygon(${Yn[t](...n).join(",")});`)+"overflow: hidden;"})),use(e){if(e.length>2)return e},content:e=>e},{"place-cell":"place",offset:"place",position:"place"});const $r={even:e=>!(e%2),odd:e=>!!(e%2)};function wr(e,t,n){for(let r=0;r<=n;++r)if(Sn(e,{n:r})==t)return!0}var kr,Sr={at:({x:e,y:t})=>(n,r)=>e==n&&t==r,nth:({count:e,grid:t})=>(...n)=>n.some((n=>$r[n]?$r[n](e):wr(n,e,t.count))),row:({y:e,grid:t})=>(...n)=>n.some((n=>$r[n]?$r[n](e):wr(n,e,t.y))),col:({x:e,grid:t})=>(...n)=>n.some((n=>$r[n]?$r[n](e):wr(n,e,t.x))),even:({count:e,grid:t,x:n,y:r})=>e=>$r.odd(n+r),odd:({count:e,grid:t,x:n,y:r})=>e=>$r.even(n+r),random:({random:e,count:t,x:n,y:r,grid:i})=>(l=.5)=>/\D/.test(l)?e()<Sn("("+l+")",{x:n,X:i.x,y:r,Y:i.y,i:t,I:i.count,random:e}):e()<l,match:({count:e,grid:t,x:n,y:r,random:i})=>l=>!!Sn("("+l+")",{x:n,X:t.x,y:r,Y:t.y,i:e,I:t.count,random:i})},jr=globalThis,Er=Math,Mr=[],Ar=256,Cr=6,Tr="random",zr=Er.pow(Ar,Cr),Nr=Er.pow(2,52),Rr=2*Nr,Or=Ar-1;function Pr(e,t,n){var r=[],i=Br(qr((t=1==t?{entropy:!0}:t||{}).entropy?[e,Fr(Mr)]:null==e?function(){try{var e;return kr&&(e=kr.randomBytes)||(e=new Uint8Array(Ar),(jr.crypto||jr.msCrypto).getRandomValues(e)),Fr(e)}catch(e){var t=jr.navigator,n=t&&t.plugins;return[+new Date,jr,n,jr.screen,Fr(Mr)]}}():e,3),r),l=new Ir(r),s=function(){for(var e=l.g(Cr),t=zr,n=0;e<Nr;)e=(e+n)*Ar,t*=Ar,n=l.g(1);for(;e>=Rr;)e/=2,t/=2,n>>>=1;return(e+n)/t};return s.int32=function(){return 0|l.g(4)},s.quick=function(){return l.g(4)/4294967296},s.double=s,Br(Fr(l.S),Mr),(t.pass||n||function(e,t,n,r){return r&&(r.S&&Lr(r,l),e.state=function(){return Lr(l,{})}),n?(Er[Tr]=e,t):e})(s,i,"global"in t?t.global:this==Er,t.state)}function Ir(e){var t,n=e.length,r=this,i=0,l=r.i=r.j=0,s=r.S=[];for(n||(e=[n++]);i<Ar;)s[i]=i++;for(i=0;i<Ar;i++)s[i]=s[l=Or&l+e[i%n]+(t=s[i])],s[l]=t;(r.g=function(e){for(var t,n=0,i=r.i,l=r.j,s=r.S;e--;)t=s[i=Or&i+1],n=n*Ar+s[Or&(s[i]=s[l=Or&l+t])+(s[l]=t)];return r.i=i,r.j=l,n})(Ar)}function Lr(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function qr(e,t){var n,r=[],i=typeof e;if(t&&"object"==i)for(n in e)try{r.push(qr(e[n],t-1))}catch(e){}return r.length?r:"string"==i?e:e+"\0"}function Br(e,t){for(var n,r=e+"",i=0;i<r.length;)t[Or&i]=Or&(n^=19*t[Or&i])+r.charCodeAt(i++);return Fr(t)}function Fr(e){return String.fromCharCode.apply(0,e)}function Hr(e){return/^\:(host|doodle)/.test(e)}function Dr(e){return/^\:(container|parent)/.test(e)}function Wr(e){return Hr(e)||Dr(e)}Br(Er.random(),Mr);const Ur={};for(let e of Object.getOwnPropertyNames(Math))Ur[e]=()=>(...t)=>"number"==typeof Math[e]?Math[e]:(t=t.map((e=>Sn(Ye(e)))),Math[e](...t));class Xr{constructor(e){this.tokens=e,this.rules={},this.props={},this.keyframes={},this.grid=null,this.seed=null,this.is_grid_defined=!1,this.coords=[],this.doodles={},this.canvas={},this.pattern={},this.shaders={},this.reset(),this.custom_properties={},this.uniforms={},this.content={}}reset(){this.styles={host:"",container:"",cells:"",keyframes:""},this.coords=[],this.doodles={},this.canvas={},this.pattern={},this.shaders={},this.content={};for(let e in this.rules)e.startsWith("#c")&&delete this.rules[e]}add_rule(e,t){let n=this.rules[e];n||(n=this.rules[e]=[]),n.push.apply(n,yt(t))}pick_func(e){return cr[e]||Ur[e]}apply_func(e,t,n){let r=e(...yt(t)),i=[];return n.forEach((e=>{let t=typeof e.value,n="number"===t||"string"===t;if(!e.cluster&&n)i.push(...nt(e.value,{noSpace:!0}));else if("function"==typeof e)i.push(e);else if(!De(e.value)){let t=Ye(e.value);i.push(t)}})),i=i.filter((e=>!De(e)&&String(e).trim().length)),r(...yt(i))}compose_aname(...e){return e.join("-")}compose_selector({x:e,y:t,z:n},r=""){return`#${Ge(e,t,n)}${r}`}is_composable(e){return["doodle","shaders","canvas","pattern"].includes(e)}read_var(e,t){let n=t.count,r=Object.assign({},this.custom_properties.host,this.custom_properties.container,this.custom_properties[n]);if(void 0!==r[e]){let t=String(r[e]).trim();if("("==t[0]){")"===t[t.length-1]&&(t=t.substring(1,t.length-1))}return t.replace(/;+$/g,"")}return e}compose_argument(e,t,n=[],r){t.extra||(t.extra=[]),t.extra.push(n);let i=e.map((e=>{if("text"===e.type)return/^\-\-\w/.test(e.value)?r&&"@var"===r.name?e.value:this.read_var(e.value,t):e.value;if("func"===e.type){let r=e.name.substr(1),i=this.pick_func(r);if("function"==typeof i){if(this.check_uniforms(r),this.is_composable(r)){let n=Ye((e.arguments[0]||[])[0]);if(!De(n))switch(r){case"doodle":return this.compose_doodle(this.inject_variables(n,t.count));case"shaders":return this.compose_shaders(n,t);case"canvas":return this.compose_canvas(n,e.arguments.slice(1));case"pattern":return this.compose_pattern(n,t)}}t.position=e.position;let l=e.arguments.map((r=>i.lazy?(...n)=>this.compose_argument(r,t,n,e):this.compose_argument(r,t,n,e)));return this.apply_func(i,t,l)}return e.name}}));return t.extra.pop(),{cluster:e.cluster,value:i.length>=2?{value:i.join("")}:i[0]}}compose_doodle(e){let t=tt("doodle");return this.doodles[t]=e,"${"+t+"}"}compose_shaders(e,{x:t,y:n,z:r}){let i=tt("shader");return this.shaders[i]={id:"--"+i,shader:e,cell:Ge(t,n,r)},"${"+i+"}"}compose_pattern(e,{x:t,y:n,z:r}){let i=tt("pattern");return this.pattern[i]={id:"--"+i,code:e,cell:Ge(t,n,r)},"${"+i+"}"}compose_canvas(e,t=[]){let n=e,r=t.map((e=>Ye(e[0]))).join(",");r.length&&(n=e+","+r);let i=tt("canvas");return this.canvas[i]={code:n},"${"+i+"}"}check_uniforms(e){switch(e){case"ut":case"t":this.uniforms.time=!0;break;case"ux":this.uniforms.mousex=!0;break;case"uy":this.uniforms.mousey=!0;break;case"uw":this.uniforms.width=!0;break;case"uh":this.uniforms.height=!0}}inject_variables(e,t){let n=Object.assign({},this.custom_properties.host,this.custom_properties.container,this.custom_properties[t]),r=[];for(let[e,t]of Object.entries(n))r.push(`${e}: ${t};`);return r=r.join(""),r.length?`:doodle { ${r} }`+e:e}compose_value(e,t){if(!Array.isArray(e))return{value:"",extra:""};let n="",r=e.reduce(((e,r)=>{switch(r.type){case"text":e+=r.value;break;case"func":{let i=r.name.substr(1),l=this.pick_func(i);if("function"==typeof l)if(this.check_uniforms(i),this.is_composable(i)){let n=Ye((r.arguments[0]||[])[0]);if(!De(n))switch(i){case"doodle":e+=this.compose_doodle(this.inject_variables(n,t.count));break;case"shaders":e+=this.compose_shaders(n,t);break;case"pattern":e+=this.compose_pattern(n,t);break;case"canvas":e+=this.compose_canvas(n,r.arguments.slice(1))}}else{t.position=r.position;let i=r.arguments.map((e=>l.lazy?(...n)=>this.compose_argument(e,t,n,r):this.compose_argument(e,t,[],r))),s=this.apply_func(l,t,i);De(s)||(e+=s,s.extra&&(n=s.extra))}else e+=r.name}}return e}),"");return{value:r,extra:n}}add_grid_style({fill:e,clip:t,rotate:n,scale:r,flexRow:i,flexColumn:l}){e&&this.add_rule(":host",`background-color: ${e};`),t||this.add_rule(":host","contain: none;"),n&&this.add_rule(":container",`rotate: ${n};`),r&&this.add_rule(":container",`scale: ${r};`),i&&(this.add_rule(":container","display: flex"),this.add_rule("cell","flex: 1")),l&&(this.add_rule(":container","display: flex; flex-direction: column;"),this.add_rule("cell","flex: 1"))}compose_rule(e,t,n){let r,i=Object.assign({},t),l=e.property;if("@seed"===l)return"";let s=e.value.reduce(((e,t)=>{let n=this.compose_value(t,i);return n&&(n.value&&e.push(n.value),n.extra&&(r=n.extra)),e}),[]),a=s.join(", ");if(/^animation(\-name)?$/.test(l)){if(this.props.has_animation=!0,Hr(n)){let e=er[l];e&&a&&(a=e+","+a)}if(i.count>1){let{count:e}=i;switch(l){case"animation-name":a=s.map((t=>this.compose_aname(t,e))).join(", ");break;case"animation":a=s.map((t=>{let n=(t||"").split(/\s+/);return n[0]=this.compose_aname(n[0],e),n.join(" ")})).join(", ")}}}"content"===l&&(/["']|^none$|^(var|counter|counters|attr|url)\(/.test(a)||(a=`'${a}'`)),"transition"===l&&(this.props.has_transition=!0);let o=`${l}: ${a};`;if(o=yr(l,o),"clip-path"===l&&(o+=";overflow: hidden;"),"width"!==l&&"height"!==l||Wr(n)||(o+=`--internal-cell-${l}: ${a};`),/^(background|background\-image)$/.test(l)&&/\$\{(canvas|shader|pattern)/.test(a)&&(o+="background-size: 100% 100%;"),/^\-\-/.test(l)){let e=t.count;Dr(n)&&(e="container"),Hr(n)&&(e="host"),this.custom_properties[e]||(this.custom_properties[e]={}),this.custom_properties[e][l]=a}if(/^@/.test(l)&&xr[l.substr(1)]){let t=l.substr(1),s=xr[t](a,{is_special_selector:Wr(n),grid:i.grid,max_grid:i.max_grid,extra:r});switch(t){case"grid":Hr(n)?(o=s.size||"",this.add_grid_style(s)):(o="",this.is_grid_defined||(s=xr[t](a,{is_special_selector:!0,grid:i.grid,max_grid:i.max_grid}),this.add_rule(":host",s.size||""),this.add_grid_style(s))),this.grid=i.grid,this.is_grid_defined=!0;break;case"gap":o="",this.add_rule(":container",`gap: ${s};`);case"content":o="",void 0===s||/\:before|\:after/.test(n)||Dr(n)||(this.content[this.compose_selector(i)]=s);case"seed":o="";break;case"place-cell":case"place":case"position":case"offset":Hr(n)||(o=s);break;case"use":e.value.length&&this.compose(i,e.value),o="";break;default:o=s}}return o}get_raw_value(e){let t=e.raw();De(t)&&(t="");let[n,...r]=t.split(e.property);return r=r.join(e.property).replace(/^\s*:\s*/,"").replace(/[;}<]$/,"").trim().replace(/[;}<]$/,""),r}pre_compose_rule(e,t){let n=Object.assign({},t),r=e.property;switch(r){case"@grid":{let i=e.value.reduce(((e,t)=>{let r=this.compose_value(t,n);return r&&r.value&&e.push(r.value),e}),[]).join(", "),l=r.substr(1),s=xr[l](i,{max_grid:t.max_grid});this.grid=s.grid;break}case"@use":e.value.length&&this.pre_compose(n,e.value)}}pre_compose(e,t){De(this.seed)&&((t||this.tokens).forEach((e=>{if("rule"===e.type&&"@seed"===e.property&&(this.seed=this.get_raw_value(e)),"pseudo"===e.type&&Hr(e.selector))for(let t of yt(e.styles))"rule"===t.type&&"@seed"===t.property&&(this.seed=this.get_raw_value(t))})),De(this.seed)?this.seed=e.seed_value:e.update_random(this.seed)),(t||this.tokens).forEach((t=>{switch(t.type){case"rule":this.pre_compose_rule(t,e);break;case"pseudo":Hr(t.selector)&&(t.styles||[]).forEach((t=>{this.pre_compose_rule(t,e)}))}}))}compose(e,t,n){this.coords.push(e),(t||this.tokens).forEach(((t,r)=>{if(t.skip)return!1;if(n&&this.grid)return!1;switch(t.type){case"rule":this.add_rule(this.compose_selector(e),this.compose_rule(t,e));break;case"pseudo":{t.selector.startsWith(":doodle")&&(t.selector=t.selector.replace(/^\:+doodle/,":host"));let n=Wr(t.selector);n&&(t.skip=!0),t.selector.split(",").forEach((r=>{let i=t.styles.map((t=>this.compose_rule(t,e,r))),l=n?r:this.compose_selector(e,r);this.add_rule(l,i)}));break}case"cond":{let n=Sr[t.name.substr(1)];if(n){let r=t.arguments.map((t=>this.compose_argument(t,e)));this.apply_func(n,e,r)&&this.compose(e,t.styles)}break}case"keyframes":this.keyframes[t.name]||(this.keyframes[t.name]=e=>`\n              ${_t(t.steps.map((t=>`\n                ${t.name} {\n                  ${_t(t.styles.map((t=>this.compose_rule(t,e))))}\n                }\n              `)))}\n            `)}}))}output(){for(let[e,t]of Object.entries(this.rules))if(Dr(e))this.styles.container+=`\n          .container {\n            ${_t(t)}\n          }\n        `;else{let n=Hr(e)?"host":"cells",r=_t(t).trim(),i="host"===n?`${e}, .host`:e;this.styles[n]+=`${i} { ${r} }`}return this.uniforms.time&&(this.styles.container+=`\n        :host, .host {\n          animation: ${er.animation};\n        }\n      `,this.styles.keyframes+=`\n       @keyframes ${er["animation-name"]} {\n         from { --${er.name}: 0 }\n         to { --${er.name}: ${er["animation-duration"]/10} }\n       }\n      `),this.coords.forEach(((e,t)=>{for(let[i,l]of Object.entries(this.keyframes)){let s=this.compose_aname(i,e.count);this.styles.keyframes+=`\n          ${n=0===t,r=`@keyframes ${i} { ${l(e)} }`,n?"function"==typeof r?r():r:""}\n          @keyframes ${s} {\n            ${l(e)}\n          }\n        `}var n,r})),{props:this.props,styles:this.styles,grid:this.grid,seed:this.seed,random:this.random,doodles:this.doodles,shaders:this.shaders,canvas:this.canvas,pattern:this.pattern,uniforms:this.uniforms,content:this.content}}}function Gr(e,t,n,r,i){let l=new Xr(e),s=i||Pr(String(n)),a={};function o(e=0,t){return 1==arguments.length&&([e,t]=[0,e]),et(s(),e,t)}function u(...e){let t=e.reduce(((e,t)=>e.concat(t)),[]);return t[~~(s()*t.length)]}function c(e){let t=[...e],n=e.length;for(;n;){let e=~~(s()*n--),r=t[n];t[n]=t[e],t[e]=r}return t}l.pre_compose({x:1,y:1,z:1,count:1,context:{},grid:{x:1,y:1,z:1,count:1},random:s,rand:o,pick:u,shuffle:c,max_grid:r,update_random:function(e){s=Pr(String(e))},seed_value:n});let{grid:f,seed:d}=l.output();if(f&&(t=f),d?(d=String(d),s=Pr(d)):d=n,De(d)&&(d=Date.now(),s=Pr(d)),d=String(d),l.seed=d,l.random=s,l.reset(),1==t.z)for(let e=1,n=0;e<=t.y;++e)for(let i=1;i<=t.x;++i)l.compose({x:i,y:e,z:1,count:++n,grid:t,context:a,rand:o,pick:u,shuffle:c,random:s,seed:d,max_grid:r});else for(let e=1,n=0;e<=t.z;++e)l.compose({x:1,y:1,z:e,count:++n,grid:t,context:a,rand:o,pick:u,shuffle:c,random:s,seed:d,max_grid:r});return l.output()}function Yr(e,t,n){let r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}function Vr(e,t){return e.includes(t)?e:t+"\n"+e}function Zr(e,t,n,r){let i=jn.get(e);if(i)return Promise.resolve(i);let l=document.createElement("canvas"),s=window.devicePixelRatio||1;t*=s,n*=s,l.width=t,l.height=n;let a=l.getContext("webgl2",{preserveDrawingBuffer:!0});if(!a)return Promise.resolve("");let o=Vr(e.fragment||"","uniform vec2 u_resolution;");o=Vr(o,"uniform float u_time;"),o=Vr(o,"uniform float u_timeDelta;"),o=Vr(o,"uniform int u_frameIndex;"),o=Vr(o,"uniform vec2 u_seed;"),e.textures.forEach((e=>{let t=`uniform sampler2D ${e.name};`;o=Vr(o,t)}));/(^|[^\w\_])void\s+mainImage\(\s*out\s+vec4\s+fragColor,\s*in\s+vec2\s+fragCoord\s*\)/gm.test(o)&&(o=`// https://www.shadertoy.com/howto\n\n#define iResolution vec3(u_resolution, 0)\n#define iTime u_time\n#define iTimeDelta u_timeDelta\n#define iFrame u_frameIndex\n\n${e.textures.map(((e,t)=>`#define iChannel${t} ${e.name}`)).join("\n")}\n\n${o}\n\nvoid main() {\n  mainImage(FragColor, gl_FragCoord.xy);\n}`);let u=function(e,t,n){let r=Yr(e,e.VERTEX_SHADER,t),i=Yr(e,e.FRAGMENT_SHADER,n),l=e.createProgram();return e.attachShader(l,r),e.attachShader(l,i),e.linkProgram(l),e.getProgramParameter(l,e.LINK_STATUS)||(console.warn("Link failed: "+e.getProgramInfoLog(l)),console.warn("vs info-log: "+e.getShaderInfoLog(r)),console.warn("fs info-log: "+e.getShaderInfoLog(i))),l}(a,e.vertex||"#version 300 es\n  in vec4 position;\n  void main() {\n    gl_Position = position;\n  }\n","#version 300 es\n  precision highp float;\n  out vec4 FragColor;\n"+o),c=a.getAttribLocation(u,"position"),f=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,f);a.bufferData(a.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,-1,1,1,-1,1,1,-1]),a.STATIC_DRAW),a.enableVertexAttribArray(c),a.vertexAttribPointer(c,2,a.FLOAT,!1,0,0),a.viewport(0,0,a.drawingBufferWidth,a.drawingBufferHeight),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT),a.useProgram(u);const d=a.getUniformLocation(u,"u_resolution");a.uniform2fv(d,[t,n]),e.textures.forEach(((e,t)=>{!function(e,t,n){const r=e.createTexture();e.activeTexture(e["TEXTURE"+n]),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR)}(a,e.value,t),a.uniform1i(a.getUniformLocation(u,e.name),t)}));const h=a.getUniformLocation(u,"u_seed");h&&a.uniform2f(h,Je(r)/1e16,Math.random());const m=a.getUniformLocation(u,"u_time"),p=a.getUniformLocation(u,"u_frameIndex"),g=a.getUniformLocation(u,"u_timeDelta");if(m||g||p){let t=0,n=0;return Promise.resolve(jn.set(e,(e=>(a.clear(a.COLOR_BUFFER_BIT),m&&a.uniform1f(m,e/1e3),p&&a.uniform1i(p,t++),g&&(a.uniform1f(g,(n-e)/1e3),n=e),a.drawArrays(a.TRIANGLES,0,6),l.toDataURL()))))}return a.drawArrays(a.TRIANGLES,0,6),Promise.resolve(jn.set(e,l.toDataURL()))}function Kr(e,t){let n=[];for(;e.next();){let{curr:t,next:r}=e.get(),i=!r||t.isSymbol(";")||r.isSymbol("}");if(n.push(t),i)break}return n.length&&(t.value=Qr(n)),t}function Jr(e,t){let n=[],r=[],i=t&&t.type||"",l=[];for(;e.next();){let{prev:s,curr:a,next:o}=e.get(),u=!o||a.isSymbol("}");if("block"===i&&u){o||!n.length||a.isSymbol("}")||(n[n.length-1].value+=";"+a.value),t.value=n;break}if(a.isSymbol("{")&&r.length&&!l.length){let t=ei(r);if(!t.length)continue;let i=Jr(e,{type:"block",name:"unkown",value:[]});t.forEach((e=>{let t=Object.assign({},i,{name:e.name,args:e.args});n.push(t)})),r=[]}else if(a.isSymbol(":")&&r.length&&!l.length){let l=Qr(r);n.push(Kr(e,{type:"statement",name:l,value:""})),"block"==i&&(t.value=n),r=[]}else a.isSymbol(";")?n.length&&r.length&&(n[n.length-1].value+=";"+Qr(r),r=[]):(a.isSymbol("(")&&l.push(a),a.isSymbol(")")&&l.pop(),r.push(a))}return n.length&&"block"==i&&(t.value=n),i?t:n}function Qr(e){return e.filter(((t,n)=>!t.isSymbol(";")||n!==e.length-1)).map((e=>e.value)).join("")}function ei(e){let t=Se(e),n=[],r="",i=[],l=[],s=[];for(;t.next();){let{curr:e,next:a}=t.get();!r.length&&e.isWord()?r=e.value:e.isSymbol("(")?(s.length&&l.push(e.value),s.push(e)):e.isSymbol(")")?(s.pop(),s.length?l.push(e.value):l.length&&(i.push(l.join("")),l=[])):e.isSymbol(",")?s.length?(i.push(l.join("")),l=[]):(l.length&&(i.push(l.join("")),l=[]),r&&(n.push({name:r,args:i}),r="",i=[],l=[])):l.push(e.value)}return r&&n.push({name:r,args:i}),n.filter(((e,t,n)=>n.findIndex((t=>t.name===e.name&&e.args.join("")==t.args.join("")))===t))}function ti(e){return Jr(Se(Re(e)))}function ni(e,t){if("fill"===e.name){let{r:n,g:r,b:i,a:l}=t.get_rgba_color(e.value);return{type:"statement",value:`\ncolor = vec4(${ri(n/255)}, ${ri(r/255)}, ${ri(i/255)}, ${ri(l)});\n`}}return"grid"==e.name?{type:"grid",value:e.value}:{type:"statement",value:""}}function ri(e){return String(e).includes(".")?e:e+".0"}function ii(e,t){let n=ti(e),r=[],i={x:1,y:1};return n.forEach((e=>{if("statement"===e.type){let n=ni(e,t);"statement"==n.type&&r.push(n.value),"grid"===n.type&&(i=function(e){let[t,n=t]=String(e+"").replace(/\s+/g,"").replace(/[,，xX]+/g,"x").split("x").map((e=>parseInt(e)));return(!t||t<1)&&(t=1),(!n||n<1)&&(n=1),{x:t,y:n}}(n.value))}else"block"===e.type&&r.push(function(e,t){if("match"===e.name){let n=e.args[0],r=[];return e.value.forEach((e=>{let n=ni(e,t);"statement"==n.type&&r.push(n.value)})),`\n      if (${n}) {\n        ${r.join("")}\n      }\n    `}return""}(e,t))})),function(e,t){return`\n    vec3 mapping(vec2 uv, vec2 grid) {\n      vec2 _grid = 1.0/grid;\n      float x = ceil(uv.x/_grid.x);\n      float y = ceil(grid.y - uv.y/_grid.y);\n      float i = x + (y - 1.0) * y;\n      return vec3(x, y, i);\n    }\n    vec4 getColor(float x, float y, float i, float I, float X, float Y, float t) {\n      vec4 color = vec4(0, 0, 0, 0);\n      ${e}\n      return color;\n    }\n    void main() {\n      vec2 uv = gl_FragCoord.xy/u_resolution.xy;\n      vec2 grid = vec2(${t.x}, ${t.y});\n      vec3 p = mapping(uv, grid);\n      FragColor = getColor(p.x, p.y, p.z, grid.x * grid.y, grid.x, grid.y, u_time);\n    }\n  `}(r.join(""),i)}const li=Qe();function si(e){let t=jn.get(e);if(t)return Promise.resolve(t);let n=li("css-doodle-paint"),r=function(e,t){t=Ke(t),t.includes("paint(")||(t=`\n      paint(ctx, {width, height}, props) {\n        ${t}\n      }\n    `);return`\n    registerPaint('${e}', class {\n      ${t}\n    })\n  `}(n,e),i=new Blob([r],{type:"text/javascript"});try{CSS.paintWorklet&&CSS.paintWorklet.addModule(URL.createObjectURL(i))}catch(e){}return Promise.resolve(jn.set(e,`paint(${n})`))}function ai(e){if("undefined"==typeof getComputedStyle)return"";let t={};if(e.computedStyleMap)for(let[n,r]of e.computedStyleMap())n.startsWith("--")&&(t[n]=r[0][0]);else{let n=getComputedStyle(e);for(let e of n)e.startsWith("--")&&(t[e]=n.getPropertyValue(e))}return function(e){let t=[];for(let[n,r]of Object.entries(e))t.push(n+":"+r);return t.join(";")}(t)}const oi=1e3/60;if("undefined"!=typeof customElements){class e extends HTMLElement{constructor(){super(),this.doodle=this.attachShadow({mode:"open"}),this.animations=[],this.extra={get_variable:e=>function(e,t){return"undefined"==typeof getComputedStyle?"":getComputedStyle(e).getPropertyValue(t).trim().replace(/^\(|\)$/g,"")}(this,e),get_rgba_color:e=>function(e,t){let n=e.querySelector("#defs");return n?(n.style.color=t,function(e){let[t,n,r,i=1]=e.replace(/rgba?\((.+)\)/,((e,t)=>t)).split(/,\s*/);return{r:t,g:n,b:r,a:i}}(getComputedStyle(n).color)):{r:0,g:0,b:0,a:1}}(this.shadowRoot,e)}}connectedCallback(e){this.innerHTML?this.load(e):setTimeout((()=>this.load(e)))}disconnectedCallback(){this.cleanup()}cleanup(){jn.clear();for(let e of this.animations)e.cancel();this.animations=[]}update(e){this.cleanup(),e||(e=Ke(this.innerHTML)),this.innerHTML!==e&&(this.innerHTML=e),this.grid_size||(this.grid_size=this.get_grid());const{x:t,y:n,z:r}=this.grid_size,i=this.get_use();let l="";this.compiled&&(l=this.compiled.content);const s=this.generate(en(i+e,this.extra));let a=s.grid||this.get_grid(),{x:o,y:u,z:c}=a,f=!this.shadowRoot.innerHTML||t!==o||n!==u||r!==c||JSON.stringify(l)!==JSON.stringify(s.content);if(Object.assign(this.grid_size,a),f)return s.grid?this.build_grid(s,a):this.build_grid(this.generate(en(i+e,this.extra)),a);let d=this.replace(s);this.set_content(".style-keyframes",d(s.styles.keyframes)),s.props.has_animation&&(this.set_content(".style-cells",""),this.set_content(".style-container","")),setTimeout((()=>{this.set_content(".style-container",d(ci(this.grid_size)+s.styles.host+s.styles.container)),this.set_content(".style-cells",d(s.styles.cells))}))}get grid(){return Object.assign({},this.grid_size)}set grid(e){this.attr("grid",e),this.connectedCallback(!0)}get seed(){return this._seed_value}set seed(e){this.attr("seed",e),this.connectedCallback(!0)}get use(){return this.attr("use")}set use(e){this.attr("use",e),this.connectedCallback(!0)}get_max_grid(){return this.hasAttribute("experimental")?256:64}get_grid(){return tn(this.attr("grid"),this.get_max_grid())}get_use(){let e=String(this.attr("use")||"").trim();return/^var\(/.test(e)&&(e=`@use:${e};`),e}attr(e,t){return 1===arguments.length?this.getAttribute(e):2===arguments.length?(this.setAttribute(e,t),t):void 0}generate(e){let t=this.get_grid(),n=this.attr("seed")||this.attr("data-seed");De(n)&&(n=Date.now());let r=this.compiled=Gr(e,t,n,this.get_max_grid());return this._seed_value=r.seed,this._seed_random=r.random,r}doodle_to_image(e,t,n){"function"==typeof t&&(n=t,t=null);let r=en(e=":doodle { width:100%;height:100% }"+e,this.extra),i=tn(""),l=Gr(r,i,this._seed_value,this.get_max_grid(),this._seed_random),s=l.grid?l.grid:i;const{keyframes:a,host:o,container:u,cells:c}=l.styles;let f=this.replace(l),d=hi(s,l.content);f(`\n        <svg ${t&&t.width&&t.height?`width="${t.width}" height="${t.height}"`:""} xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none">\n          <foreignObject width="100%" height="100%">\n            <div class="host" xmlns="http://www.w3.org/1999/xhtml">\n              <style>\n                ${ui()}\n                ${ci(s)}\n                ${o}\n                ${u}\n                ${c}\n                ${a}\n              </style>\n              <svg id="defs" xmlns="http://www.w3.org/2000/svg" style="width:0; height:0"></svg>\n              ${d}\n            </div>\n          </foreignObject>\n        </svg>\n      `).then((e=>{let t=`data:image/svg+xml;base64,${window.btoa(unescape(encodeURIComponent(e)))}`;Ze()&&Ve(t),n(t)}))}pattern_to_image({code:e,cell:t,id:n},r){let i=ii(e,this.extra);this.shader_to_image({shader:i,cell:t,id:n},r)}canvas_to_image({code:e},t){si(e).then(t)}pause(){this.setAttribute("cssd-paused-animation",!0);for(let e of this.animations)e.pause()}resume(){this.removeAttribute("cssd-paused-animation");for(let e of this.animations)e.resume()}shader_to_image({shader:e,cell:t,id:n},r){let i="string"==typeof e?function(e){let t,n,r=Se(ln(Re(e,{preserveLineBreak:!0,ignoreInlineComment:!0}))),i=[],l=[],s={textures:[]};for(;r.next();){let{curr:e,next:a}=r.get();if(e.isSymbol("{")){if(i.length)l.push(e);else{let n=sn(l);nn(n)?(t=n,l=[]):l.push(e)}i.push("{")}else if(e.isSymbol("}"))if(i.pop(),!i.length&&t){let e=sn(l);t&&e.length&&(t.startsWith("texture")?s.textures.push({name:t,value:e}):s[t]=e,l=[]),t=null}else l.push(e);else Ue(n)||n==e.pos[1]||(l.push(rn()),n=null),e.isWord()&&e.value.startsWith("#")&&(l.push(rn()),n=a.pos[1]),l.push(e)}return Ue(s.fragment)&&(s.fragment=sn(l),s.textures=s.textures||[]),s}(e):e,l=this.doodle.getElementById(t);const s=this.seed,a=e=>{l.style.setProperty(n,`url(${e})`)},o=e=>{if("function"==typeof e){let t=function(e){let t,n=0,r=0,i=0,l=!1;function s(l){n||(n=l),e(n);let a=l-r;a<oi&&(a=oi),a>1e3&&(a=i||1e3),r&&(n+=a),i=a,r=l,t=requestAnimationFrame(s)}return t=requestAnimationFrame(s),{resume(){t&&l&&(l=!1,t=requestAnimationFrame(s))},pause(){t&&(cancelAnimationFrame(t),l=!0)},cancel(){t&&(l=!1,cancelAnimationFrame(t),t=null)}}}((t=>{a(e(t))}));return this.animations.push(t),""}a(e)};let{width:u,height:c}=l&&l.getBoundingClientRect()||{width:0,height:0},f=window.devicePixelRatio||1;if(!i.textures.length||i.ticker)Zr(i,u,c,s).then(o).then(r);else{let e=i.textures.map((e=>new Promise((t=>{this.doodle_to_image(e.value,{width:u,height:c},(n=>{let r=new Image;r.width=u*f,r.height=c*f,r.onload=()=>t({name:e.name,value:r}),r.src=n}))}))));Promise.all(e).then((e=>{i.textures=e,Zr(i,u,c,s).then(o).then(r)}))}}load(e){this.cleanup();let t=en(this.get_use()+Ke(this.innerHTML),this.extra),n=this.generate(t);e||this.hasAttribute("click-to-update")&&this.addEventListener("click",(e=>this.update())),this.grid_size=n.grid?n.grid:this.get_grid(),this.build_grid(n,this.grid_size)}replace({doodles:e,shaders:t,canvas:n,pattern:r}){let i=Object.keys(e),l=Object.keys(t),s=Object.keys(n),a=Object.keys(r),o=i.length+s.length+l.length+a.length;return u=>{if(!o)return Promise.resolve(u);let c=[].concat(i.map((t=>u.includes(t)?new Promise((n=>{this.doodle_to_image(e[t],(e=>n({id:t,value:e})))})):Promise.resolve(""))),l.map((e=>u.includes(e)?new Promise((n=>{this.shader_to_image(t[e],(t=>n({id:e,value:t})))})):Promise.resolve(""))),s.map((e=>u.includes(e)?new Promise((t=>{this.canvas_to_image(n[e],(n=>t({id:e,value:n})))})):Promise.resolve(""))),a.map((e=>u.includes(e)?new Promise((t=>{this.pattern_to_image(r[e],(n=>t({id:e,value:n})))})):Promise.resolve(""))));return Promise.all(c).then((e=>{for(let{id:t,value:n}of e){let e=`url(${n})`;/^canvas/.test(t)&&(e=n),/^shader|^pattern/.test(t)&&(e=`var(--${t})`),u=u.replaceAll("${"+t+"}",e)}return u}))}}build_grid(e,t){const{has_transition:n,has_animation:r}=e.props;let i=n||r;const{keyframes:l,host:s,container:a,cells:o}=e.styles;let u=ci(t)+s+a,c=i?"":o;const{uniforms:f,content:d}=e;let h=this.replace(e);this.doodle.innerHTML=`\n        <style>${ui()}</style>\n        <style class="style-keyframes">${l}</style>\n        <style class="style-container">${u}</style>\n        <style class="style-cells">${c}</style>\n        <svg id="defs" xmlns="http://www.w3.org/2000/svg" style="width:0;height:0"></svg>\n        ${hi(t,d)}\n      `,this.set_content(".style-container",h(u)),i?setTimeout((()=>{this.set_content(".style-cells",h(o))}),50):this.set_content(".style-cells",h(o)),f.time&&this.register_uniform_time(),f.mousex||f.mousey?this.register_uniform_mouse(f):this.remove_uniform_mouse(),f.width||f.height?this.register_uniform_resolution(f):this.remove_uniform_resolution()}register_uniform_mouse(e){if(!this.uniform_mouse_callback){let{uniform_mousex:t,uniform_mousey:n}=lr;this.uniform_mouse_callback=r=>{let i=r.detail||r;e.mousex&&this.style.setProperty("--"+t.name,i.offsetX),e.mousey&&this.style.setProperty("--"+n.name,i.offsetY)},this.addEventListener("pointermove",this.uniform_mouse_callback);let r=new CustomEvent("pointermove",{detail:{offsetX:0,offsetY:0}});this.dispatchEvent(r)}}remove_uniform_mouse(){if(this.uniform_mouse_callback){let{uniform_mousex:e,uniform_mousey:t}=lr;this.style.removeProperty("--"+e.name),this.style.removeProperty("--"+t.name),this.removeEventListener("pointermove",this.uniform_mouse_callback),this.uniform_mouse_callback=null}}register_uniform_resolution(e){if(!this.uniform_resolution_observer){let{uniform_width:t,uniform_height:n}=lr;const r=()=>{let r=this.getBoundingClientRect();e.width&&this.style.setProperty("--"+t.name,r.width),e.height&&this.style.setProperty("--"+n.name,r.height)};r(),this.uniform_resolution_observer=new ResizeObserver((e=>{for(let t of e){(t.contentBoxSize||t.contentRect)&&r()}})),this.uniform_resolution_observer.observe(this)}}remove_uniform_resolution(){if(this.uniform_resolution_observer){let{uniform_width:e,uniform_height:t}=lr;this.style.removeProperty("--"+e.name),this.style.removeProperty("--"+t.name),this.uniform_resolution_observer.unobserve(this),this.uniform_resolution_observer=null}}register_uniform_time(){if(!window.CSS||!window.CSS.registerProperty)return!1;if(!this.is_uniform_time_registered){let{uniform_time:e}=lr;try{CSS.registerProperty({name:"--"+e.name,syntax:"<number>",initialValue:0,inherits:!0})}catch(e){}this.is_uniform_time_registered=!0}}export({scale:e,name:t,download:n,detail:r}={}){return new Promise(((i,l)=>{let s=ai(this),a=this.doodle.innerHTML,{width:o,height:u}=this.getBoundingClientRect(),c=o*(e=parseInt(e)||1),f=u*e,d=`\n          <svg xmlns="http://www.w3.org/2000/svg"\n            preserveAspectRatio="none"\n            viewBox="0 0 ${o} ${u}"\n            ${Ze()?"":`width="${c}px" height="${f}px"`}\n          >\n            <foreignObject width="100%" height="100%">\n              <div\n                class="host"\n                xmlns="http://www.w3.org/1999/xhtml"\n                style="width: ${o}px; height: ${u}px; "\n              >\n                <style>.host { ${h=s,h.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")} }</style>\n                ${a}\n              </div>\n            </foreignObject>\n          </svg>\n        `;var h;n||r?function(e,t,n,r){return new Promise(((i,l)=>{let s=`data:image/svg+xml;utf8,${encodeURIComponent(e)}`;function a(){let e=new Image;e.crossOrigin="anonymous",e.src=s,e.onload=()=>{let a=document.createElement("canvas"),o=a.getContext("2d"),u=window.devicePixelRatio||1;1!=r&&(u=1),a.width=t*u,a.height=n*u,o.drawImage(e,0,0,a.width,a.height);try{a.toBlob((e=>{i({blob:e,source:s,url:URL.createObjectURL(e)})}))}catch(e){l(e)}}}Ze()?Ve(s,a,200):a()}))}(d,c,f,e).then((({source:e,url:r,blob:l})=>{if(i({width:c,height:f,svg:d,blob:l,source:e}),n){let e=document.createElement("a");e.download=function(e){return(De(e)?Date.now():String(e).replace(/\/.png$/g,""))+".png"}(t),e.href=r,e.click()}})).catch((e=>{l(e)})):i({width:c,height:f,svg:d})}))}set_content(e,t){if(t instanceof Promise)t.then((t=>{this.set_content(e,t)}));else{const n=this.shadowRoot.querySelector(e);n&&(n.styleSheet?n.styleSheet.cssText=t:n.innerHTML=t)}}}customElements.get("css-doodle")||customElements.define("css-doodle",e)}function ui(){let{uniform_time:e}=lr;const t=mr(/grid/).map((e=>`${e}: inherit;`)).join("");return`\n    *, *::after, *::before {\n      box-sizing: border-box;\n      animation-play-state: var(--cssd-animation-play-state) !important\n    }\n    :host, .host {\n      display: block;\n      visibility: visible;\n      width: auto;\n      height: auto;\n      contain: content;\n      --${e.name}: 0\n    }\n    :host([hidden]), .host[hidden] {\n      display: none\n    }\n    .container {\n      position: relative;\n      width: 100%;\n      height: 100%;\n      display: grid;\n      ${t}\n    }\n    cell {\n      position: relative;\n      display: grid;\n      place-items: center\n    }\n    svg {\n      position: absolute;\n      width: 100%;\n      height: 100%\n    }\n    :host([cssd-paused-animation]) {\n      --cssd-animation-play-state: paused;\n      animation-play-state: paused !important\n    }\n  `}function ci(e){let{x:t,y:n}=e||{};return`\n    :host, .host {\n      grid-template-rows: repeat(${n}, 1fr);\n      grid-template-columns: repeat(${t}, 1fr);\n    }\n  `}function fi(e){return De(e)?"":e}function di(e,t,n,r,i=""){let l=Ge(e,t,n);return`<cell id="${l}">${fi(r["#"+l])}${fi(i)}</cell>`}function hi(e,t){let{x:n,y:r,z:i}=e||{},l="";if(1==i)for(let e=1;e<=r;++e)for(let r=1;r<=n;++r)l+=di(r,e,1,t);else{let e="";for(let n=i;n>=1;n--){e=di(1,1,n,t,e)}l=e}return`<grid class="container">${l}</grid>`}const mi=[];function pi(t,n=e){let r;const i=new Set;function l(e){if(o(t,e)&&(t=e,r)){const e=!mi.length;for(const e of i)e[1](),mi.push(e,t);if(e){for(let e=0;e<mi.length;e+=2)mi[e][0](mi[e+1]);mi.length=0}}}return{set:l,update:function(e){l(e(t))},subscribe:function(s,a=e){const o=[s,a];return i.add(o),1===i.size&&(r=n(l)||e),s(t),()=>{i.delete(o),0===i.size&&r&&(r(),r=null)}}}}function gi(e){return"[object Date]"===Object.prototype.toString.call(e)}function vi(e,t){if(e===t||e!=e)return()=>e;const n=typeof e;if(n!==typeof t||Array.isArray(e)!==Array.isArray(t))throw new Error("Cannot interpolate values of different type");if(Array.isArray(e)){const n=t.map(((t,n)=>vi(e[n],t)));return e=>n.map((t=>t(e)))}if("object"===n){if(!e||!t)throw new Error("Object cannot be null");if(gi(e)&&gi(t)){e=e.getTime();const n=(t=t.getTime())-e;return t=>new Date(e+t*n)}const n=Object.keys(t),r={};return n.forEach((n=>{r[n]=vi(e[n],t[n])})),e=>{const t={};return n.forEach((n=>{t[n]=r[n](e)})),t}}if("number"===n){const n=t-e;return t=>e+t*n}throw new Error(`Cannot interpolate ${n} values`)}const yi=pi("afflatus"),_i=pi("index"),bi=pi(!1),xi=pi({collections:{"vampire's_old_tooth":10,large_roll_of_bandages:10,skyrocket:10,magic_dart:10,mimosa:20,conch_shell:10,cherry:10,earthy_spider_wine:10,seal_needle:10,bird_wine:10,human_soul_lamp:10,"patchouli's_ribbon":10,fish_stone:4,crown_of_thorns:10,bottle_of_stars:3,compass_cat:10,corvis_feathers:10},equipment:!1,consumables:{},spellcards:{Earth_Light_Ray:5,marisa:0},souvenir:!1,role:"marisa",sugar:3,health:12,coin:1e3,scene:"shrine",lv:50}),$i=pi({resource:"kaoru"}),wi=pi({enermy:["cirno","cirno","cirno"],event:[],target:[!0,!0,!0,!0,!1,!1],enermyLimit:4,lv:80}),ki=pi({});var Si=["啊啊啊我忘记了","阿吽","阿卡麟","阿空","阿燐","阿求","艾丽","爱丽丝","爱丽丝的魔法书","爱丽丝梦游仙境","爱丽丝威震天","爱莲","爱塔妮缇拉尔瓦","庵我烧了","奥莲姬","八百万之神","八坂神奈子","八分咲","八卦炉","八桥","八意永琳","八云蓝","八云紫","百鬼夜行","白鹭风茗","稗田阿求","百万鬼夜行","百药枡","白玉楼","半白泽","坂田合欢乃","宝宝巴士","抱头蹲防","包子仙","本居小铃","本子仙","彼岸","彼岸归航","比那名居天子","弁弁","博丽","博丽大结界","博丽结界","博丽灵梦","博丽神社","博丽神社例大祭","布都","布嘟嘟","不认识的孩子","不朽的曼珠沙华","擦弹","残机","缠流子","车车人","车万","沉默的兽灵","成美","赤蛮奇","重生","畜生界","畜生们的休息","船幽灵","船长","纯狐","纯妈","茨歌仙","茨木华扇","从地下的归还","萃梦想","萃香","村纱水蜜","大蛾子","大根","大蛤蟆之池","大酱","大结界","大鹫灵","大狸子","大妖精","大玉","弹幕","弹幕射击","弹幕邪天鬼","弹幕战","道中","得点","地底通路","敌机","地灵殿","地狱鸦","掉残","弔姐","吊瓶妖","凋叶棕","丁礼田","丁礼田舞","东方","东方蝉时歌","东方茨歌仙","东方萃梦想","东方大炮弹","东方大往生","东方大战争","东方地灵殿","东方绯想天","东方非想天则","东方封魔录","东方风神录","东方绀珠传","东方刚欲异闻","东方怪绮谈","东方鬼形兽","东方红楼梦","东方红魔乡","东方华烂漫","东方花映冢","东方幻想乡","东方辉针城","东方铃奈庵","东方灵异传","东方梦灵梦","东方梦时空","东方儚月抄","东方凭依华","东方清泉飨","东方求闻口授","东方求闻史纪","东方三月精","东方神灵庙","东方深秘录","东方失去之言","东方四季呗","东方天空璋","东方天上花","东方童楼遥","东方外来韦编","东方文花帖","东方香霖堂","东方心绮楼","东方星莲船","东方妖妖梦","东方萤灯筏","东方樱蝶梦","东方樱神月","东方永夜抄","东方游剧天","东方智灵奇传","东方紫香花","东方醉蝶华","东风谷早苗","动物灵","毒奶","多多良小伞","哆来咪","哆来咪苏伊特","谔谔","噩梦日记","二次创作","二设","二婶子","二岩猯藏","尔子田","尔子田里乃","法界","反魂蝶","芳香","防撞桶","非符","非想天","丰聪耳神子","风见幽香","疯帽子茶会","封魔录","风神录","封兽鵺","风之暗穴","疯中二婶子","符卡","符卡规则","芙兰","芙兰朵露","付丧神","尬舞姐妹","感情的摩天楼","绀珠传","刚欲同盟","刚欲异闻","高丽野阿吽","格斗","宫古芳香","狗椛","固定弹","鼓哥","鼓姐","古明地觉","古明地恋","怪力乱神","怪绮谈","广西烧烤摊老板","广有射怪鸟事","鬼畜妹","袿姬","鬼杰组","鬼杰组组长","鬼人正邪","鬼形兽","果果","过膝袜","航哥","好吗","河城荷取","赫卡","赫卡姐","赫卡提亚","荷取","核融炉","河童","黑谷山女","黑历史","红楼","红美铃","红萌馆","红魔馆","红魔乡","红银","红字本","虎哥","胡桃","冴月麟","椛椛","花开夜","华扇","华扇邸","花映冢","坏苹果","欢姐","幻梦缘起","幻视之夜","幻想万华镜","幻想夏乡","幻想乡","幻想乡空闪姬","幻想乡空战姬","幻想乡少女大战","幻想乡玩家","幻想跃迁实验室","幻缘团","幻月","幻跃团","黄昏立绘","辉夜","慧音","辉针城","辉针城的小人族","魂魄妖忌","魂魄妖梦","火车","霍青娥","火焰猫燐","吉弔","吉弔八千慧","姬海棠果","姬海棠极","姬海棠羽立","鸡妹","寄世界于偶像","键山雏","间歇泉","奖残","奖分","姐贵","结界","禁忌的魔法","矜羯罗","今泉影狼","今天也是好天气","今昔幻想乡","劲牙组","劲牙组组长","堇子","京都幻想剧团","静叶","囧仙","囧仙子","旧地狱遗址","旧都","九十九八桥","九十九弁弁","九天瀑布","菊理","决死符","卡娜安娜贝拉尔","考据党","可悲的人偶","克劳恩","克劳恩皮丝","堀川雷鼓","狂气之瞳","蓝妈","狼女","老娘是最强","乐航","乐囧","蕾蒂","蕾蒂霍瓦特洛克","蕾拉","蕾米","雷咪","蕾米莉亚","例大祭","莉格露","莉格露奈特巴格","骊驹早鬼","莉莉","莉莉白","莉莉黑","莉莉霍瓦特","莉莉卡","里乃","里香","恋恋","莲妈","莲子","铃二","铃瑚","灵力","灵梦","铃奈庵","灵乌路空","铃仙","铃仙二号","灵异传","灵知的太阳信仰","留琴","辘轳首","露米娅","露娜","露娜切露德","露娜萨","露易兹","轮椅战神","萝卜","洛天依","绿头发的爸爸","绿眼的嫉妒","玛艾露贝莉赫恩","玛格特罗依德邸","麻将山","玛露奇","满福神社","馒馒来","毛玉","梅蒂欣梅兰可莉","美国酱","妹红","梅丽","梅莉","美铃","梅露兰","魅魔","梦殿大祀庙","梦时空","梦想天生","梦消失","梦月","儚月抄","梦子","秘封","蜜蜂","秘封厨","秘封噩梦日记","秘封活动记录","秘封组","米国酱","米国小妖精","咪咪号","秘神摩多罗","米斯蒂娅","米斯蒂娅萝蕾拉","迷途之家","迷途竹林","面灵气","绵月丰姬","绵月依姬","苗苗","苗爷","冥界","命莲","命莲寺","明罗","摸多了硬起来","摩多罗","摩多罗隐岐奈","魔法森林","魔法使","魔理沙","摩妈","磨米机","摩托罗拉","摩西的奇迹","娜兹玲","牛妈","牛崎润美","女苑","帕露西","帕琪","帕秋莉","帕秋莉诺蕾姬","判定点","蓬莱人","蓬莱山辉夜","凭依华","琪露诺","骑士之夜","琪斯美","千年幻想乡","桥姬","秦河胜","秦心","青娥","清兰","青蛙子","秋静叶","秋穰子","求闻口授","求闻史纪","犬走椛","穰子","人间之里","人形裁判","人形使","人鱼","戎璎花","入道","乳町","若鹭姬","萨拉","萨丽艾尔","三分咲","三途川","伞妖","三月精","桑尼","桑尼米尔克","骚灵","森近霖之助","山姥","山女","山彦","上白泽慧音","烧烤摊老板","少名针妙丸","少女幻葬","少女绮想曲","射命丸文","社团","神话幻想","神灵","神灵庙","神妈","深秘录","神奈子","神绮","神社闭店之日","神玉","神子","圣白莲","圣德传说","圣德太子","圣德太子的马","圣德太子的天马","圣莲船","生死之境","世界美咲剧场","十六夜","十六夜咲夜","矢田寺成美","兽道","寿命论","兽娘幻想入","兽人","守矢神社","双七","水桥帕露西","水獭灵","四重存在","四季","四季大人","四季撒吗","四季撒吗我有罪","四季映姬","斯卡雷特","死灵","死神","四十米大刀","斯塔","斯塔萨菲娅","死亡幻想曲","寺子屋","苏格拉底","苏我屠自古","随机弹","砕月","碎月","太田顺也","太阳花田","太子的马","探女","探女老仙","陶瓷的杖刀人","藤原妹红","天狗","天空璋","天人","天探女","天邪鬼","天子","条纹过膝袜","庭渡久侘歌","同人","土蜘蛛","土著信仰","屠自古","豚乙女","外界","外来人","外来韦编","亡灵","威严满满","胃炎满满","文花帖","文文","我会自己上厕所","我做东方鬼畜音","物部布都","五分咲","无何有之乡","无名之丘","雾雨","雾雨魔理沙","无缘冢","雾之湖","稀神探女","西行寺幽幽子","吸血鬼","下压","仙界","现界","仙人","现世的秘术师","香霖堂","乡长","响子","消弹","小町","小恶魔","小老帝","小铃","小米弹","小人族","小伞","小桶","小兔姬","小碗","小五","咲夜","小野冢小町","泄矢诹访子","心酱","心绮楼","心之所在","星莲船","星条旗的小丑","星熊杯","星熊勇仪","幸运与不幸","星之器","续关","玄武之泽","玄爷","玄云海","阎魔","妖虫","妖怪狸","妖怪鼠","妖怪之山","妖精","妖精大战争","妖梦","妖兽","妖兔","妖妖跋扈","妖妖梦","鵺酱","野狼灵","野蛮至极","爷们红","夜雀","爷是恋恋","一般通过","一般通过山女","异变","伊吹萃香","伊吹瓢","伊吹西瓜","一分咲","衣玖","依莉斯","一轮","一设","依神女苑","依神紫苑","易者","引弹","因幡帝","因幡天为","隐匿的四季","隐岐奈","寅丸星","阴阳玉","樱花樱花","影狼","永动之龛","永江衣玖","永琳","永夜抄","勇仪","永远的春梦","永远的满月","永远亭","幽闭星光","有顶天","幽谷响子","幽幻魔眼","油库里","幽灵","幽冥结界","幽香","幽幽子","御伽之国的鬼岛","玉米棒子","欲望加速","宇佐见堇子","宇佐见莲子","原点组","原始的节拍","远野幻想物语","越共","乐器妖怪","月人","月时计","月兔","月之都","云居一轮","云山","再思之道","早鬼","早苗","杖刀偶磨弓","长者","折返","这是好的","真吉八弔","针妙丸","正邪","埴安神袿姬","智灵奇传","埴轮兵长","中弹","终符","朱鹭子","竹取飞翔","转转","壮族大妈","自机","自机狙","紫老太","紫妈","紫妹","紫奶奶","紫婆婆","紫香花","紫苑","诹访湖","诹访子","醉蝶华","佐渡的二岩"];function ji(e,t,n){const r=e.slice();return r[15]=t[n],r[17]=n,r}function Ei(e,t){let n,r,i,l=t[15].word+"";return{key:e,first:null,c(){n=j("txt"),r=E(l),i=M(),N(n,"left",t[15].x),N(n,"top",t[15].y),N(n,"font-size",26-8*Ai()+"px"),N(n,"animation-delay",.2*t[17]+"s"),T(n,"class","svelte-dyofzd"),this.first=n},m(e,t){w(e,n,t),b(n,r),b(n,i)},p(e,i){t=e,1023&i&&l!==(l=t[15].word+"")&&z(r,l),1023&i&&N(n,"left",t[15].x),1023&i&&N(n,"top",t[15].y),1023&i&&N(n,"animation-delay",.2*t[17]+"s")},d(e){e&&k(n)}}}function Mi(t){let n,r,i=[],l=new Map,s=[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9]];const a=e=>e[17];for(let e=0;e<10;e+=1){let n=ji(t,s,e),r=a(n);l.set(r,i[e]=Ei(r,n))}return{c(){n=j("div"),r=j("div");for(let e=0;e<10;e+=1)i[e].c();T(r,"class","words svelte-dyofzd"),N(r,"opacity",t[11]),T(n,"class","body svelte-dyofzd"),N(n,"z-index",t[10]),N(n,"opacity",t[11])},m(e,t){w(e,n,t),b(n,r);for(let e=0;e<10;e+=1)i[e]&&i[e].m(r,null)},p(e,[t]){1023&t&&(s=[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9]],i=me(i,t,a,1,e,s,l,r,de,Ei,null,ji)),2048&t&&N(r,"opacity",e[11]),1024&t&&N(n,"z-index",e[10]),2048&t&&N(n,"opacity",e[11])},i:e,o:e,d(e){e&&k(n);for(let e=0;e<10;e+=1)i[e].d()}}}function Ai(){return Math.random()}function Ci(e,r,i){let l,s=y(),a=y(),o=y(),u=y(),c=y(),d=y(),h=y(),m=y(),g=y(),v=y();function y(){return{x:-40-160*Ai()+"px",y:80-160*Ai()+"px",word:Si[Math.floor(Ai()*Si.length)]}}setTimeout((e=>setInterval((e=>i(0,s=y())),2e3)),0),setTimeout((e=>setInterval((e=>i(1,a=y())),2e3)),200),setTimeout((e=>setInterval((e=>i(2,o=y())),2e3)),400),setTimeout((e=>setInterval((e=>i(3,u=y())),2e3)),600),setTimeout((e=>setInterval((e=>i(4,c=y())),2e3)),800),setTimeout((e=>setInterval((e=>i(5,d=y())),2e3)),1e3),setTimeout((e=>setInterval((e=>i(6,h=y())),2e3)),1200),setTimeout((e=>setInterval((e=>i(7,m=y())),2e3)),1400),setTimeout((e=>setInterval((e=>i(8,g=y())),2e3)),1600),setTimeout((e=>setInterval((e=>i(9,v=y())),2e3)),1800);let b=0;const x=function(e,r={}){const i=pi(e);let l,s=e;function a(a,o){if(null==e)return i.set(e=a),Promise.resolve();s=a;let u=l,c=!1,{delay:f=0,duration:d=400,easing:h=t,interpolate:m=vi}=n(n({},r),o);if(0===d)return u&&(u.abort(),u=null),i.set(e=s),Promise.resolve();const g=p()+f;let v;return l=_((t=>{if(t<g)return!0;c||(v=m(e,a),"function"==typeof d&&(d=d(e,a)),c=!0),u&&(u.abort(),u=null);const n=t-g;return n>d?(i.set(e=a),!1):(i.set(e=v(h(n/d))),!0)})),l.promise}return{set:a,update:(t,n)=>a(t(s,e),n),subscribe:i.subscribe}}(0,{duration:250,easing:t});return f(e,x,(e=>i(11,l=e))),bi.subscribe((e=>{setTimeout((t=>i(10,b=Number(e)-1)),e?0:200),x.set(Number(e))})),[s,a,o,u,c,d,h,m,g,v,b,l,x]}class Ti extends xe{constructor(e){super(),be(this,e,Ci,Mi,o,{})}}function zi(e,{delay:n=0,duration:r=400,easing:i=t}={}){const l=+getComputedStyle(e).opacity;return{delay:n,duration:r,easing:i,css:e=>"opacity: "+e*l}}function Ni(e){let t,n,r;return{c(){t=j("txt"),t.textContent="Press Any Key",T(t,"class","launch svelte-1xrc41q")},m(e,n){w(e,t,n),r=!0},i(e){r||(n&&n.end(1),r=!0)},o(e){n=fe(t,zi,{duration:250}),r=!1},d(e){e&&k(t),e&&n&&n.end()}}}function Ri(e){let t;return{c(){t=j("txt"),t.textContent="幻想异闻录",T(t,"class","title svelte-1xrc41q")},m(e,n){w(e,t,n)},d(e){e&&k(t)}}}function Oi(t){let n,r,i,l,a,o,u,c,f,d,h;return{c(){n=j("div"),r=j("txt"),r.textContent="开始",i=M(),l=j("txt"),l.textContent="灵感",a=M(),o=j("txt"),o.textContent="设定",u=M(),c=j("txt"),c.textContent="离去",T(r,"class","svelte-1xrc41q"),T(l,"class","svelte-1xrc41q"),T(o,"class","svelte-1xrc41q"),T(c,"class","svelte-1xrc41q"),T(n,"class","menu svelte-1xrc41q")},m(e,s){w(e,n,s),b(n,r),b(n,i),b(n,l),b(n,a),b(n,o),b(n,u),b(n,c),d||(h=[C(r,"click",t[2]),C(l,"click",t[3])],d=!0)},p:e,i(e){f||Y((()=>{f=ce(n,zi,{delay:250,duration:250}),f.start()}))},o:e,d(e){e&&k(n),d=!1,s(h)}}}function Pi(e){let t,n,r,i,l,s,a,o,u=!e[0]&&Ni();let c=Ri(e),f=e[0]&&Oi(e);return{c(){t=j("div"),u&&u.c(),n=M(),c.c(),r=M(),f&&f.c(),T(t,"class","body svelte-1xrc41q")},m(i,l){w(i,t,l),u&&u.m(t,null),b(t,n),c.m(t,null),b(t,r),f&&f.m(t,null),s=!0,a||(o=C(t,"click",e[4],{once:!0}),a=!0)},p(e,[r]){e[0]?u&&(le(),oe(u,1,1,(()=>{u=null})),se()):u?1&r&&ae(u,1):(u=Ni(),u.c(),ae(u,1),u.m(t,n)),e[0]?f?(f.p(e,r),1&r&&ae(f,1)):(f=Oi(e),f.c(),ae(f,1),f.m(t,null)):f&&(f.d(1),f=null)},i(e){s||(ae(u),ae(f),Y((()=>{s&&(l&&l.end(1),i=ce(t,zi,{duration:250}),i.start())})),s=!0)},o(e){oe(u),i&&i.invalidate(),l=fe(t,zi,{duration:250}),s=!1},d(e){e&&k(t),u&&u.d(),c.d(),f&&f.d(),e&&l&&l.end(),a=!1,o()}}}function Ii(e,t,n){let r;f(e,yi,(e=>n(1,r=e)));let i=!1;return[i,r,e=>h(yi,r="foreword",r),e=>h(yi,r="afflatus",r),e=>n(0,i=!0)]}class Li extends xe{constructor(e){super(),be(this,e,Ii,Pi,o,{})}}var qi={sort:["s1","s3","s5"],s1:{title:"一块",detail:"只有一个选择才真正有趣啊！",type:"sugar"},s3:{title:"三块",detail:"那就折衷吧...",type:"sugar"},s5:{title:"五块",detail:"我的控制欲还蛮强的。",type:"sugar"}},Bi={sort:["reimu","marisa","shion","aya","youmu"],reimu:{title:"博丽灵梦",detail:"超乎常人的幸运，她的直觉几乎一定会命中。",talent:""},marisa:{title:"雾雨魔理沙",detail:"弹幕最重要的是火力！"},shion:{title:"依神紫苑",detail:"失去的财产，还有运气究竟去了哪里呢。"},aya:{title:"射命丸文",detail:"来吧，我会手下留情的。"},youmu:{title:"魂魄妖梦",detail:"半人半灵的半吊子。但是剑有两把。",talent:"所有暴击率转化为暴击伤害。每消耗一点灵力，获得一层通灵(闪避几率+10%)，每触发一次闪避减少三层通灵并对伤害来源发动一次必定暴击的普通攻击，回合初清除通灵。"}};function Fi(e,t,n){const r=e.slice();return r[8]=t[n],r[10]=n,r}function Hi(e,t){let n,r,i,l,s,a,o,u,f,d,h,m,p,g,v=t[3][t[1]][t[8]].title+"",y=t[3][t[1]][t[8]].detail+"";function _(...e){return t[6](t[8],...e)}return{key:e,first:null,c(){n=j("div"),r=j("img"),l=M(),s=j("a"),a=E(v),o=M(),u=j("div"),f=j("a"),d=E(y),h=M(),c(r.src,i=t[5](t[1],t[8]))||T(r,"src",i),T(r,"class","svelte-1dkcu88"),T(s,"class","svelte-1dkcu88"),T(f,"class","svelte-1dkcu88"),T(u,"class","svelte-1dkcu88"),T(n,"class",m="selection animation_"+(t[0]?"close":"open")+"Selections svelte-1dkcu88"),this.first=n},m(e,t){w(e,n,t),b(n,r),b(n,l),b(n,s),b(s,a),b(n,o),b(n,u),b(u,f),b(f,d),b(n,h),p||(g=C(n,"click",_),p=!0)},p(e,l){t=e,2&l&&!c(r.src,i=t[5](t[1],t[8]))&&T(r,"src",i),2&l&&v!==(v=t[3][t[1]][t[8]].title+"")&&z(a,v),2&l&&y!==(y=t[3][t[1]][t[8]].detail+"")&&z(d,y),1&l&&m!==(m="selection animation_"+(t[0]?"close":"open")+"Selections svelte-1dkcu88")&&T(n,"class",m)},d(e){e&&k(n),p=!1,g()}}}function Di(t){let n,r=[],i=new Map,l=t[4];const s=e=>e[10];for(let e=0;e<l.length;e+=1){let n=Fi(t,l,e),a=s(n);i.set(a,r[e]=Hi(a,n))}return{c(){n=j("div");for(let e=0;e<r.length;e+=1)r[e].c();T(n,"class","selections svelte-1dkcu88")},m(e,t){w(e,n,t);for(let e=0;e<r.length;e+=1)r[e]&&r[e].m(n,null)},p(e,[t]){63&t&&(l=e[4],r=me(r,t,s,1,e,l,i,n,de,Hi,null,Fi))},i:e,o:e,d(e){e&&k(n);for(let e=0;e<r.length;e+=1)r[e].d()}}}function Wi(e,t,n){let r,i;f(e,$i,(e=>n(7,r=e))),f(e,xi,(e=>n(2,i=e)));let{type:l}=t,{selected:s}=t;const a={sugar:qi,role:Bi};let o=deepCopy(a[l]).sort.rd().slice(0,i.sugar);return e.$$set=e=>{"type"in e&&n(1,l=e.type),"selected"in e&&n(0,s=e.selected)},[s,l,i,a,o,(e,t)=>({role:`/img/role/${r.resource}/${t}.webp`,sugar:"/svg/sugar.svg"}[e]),(e,t)=>{n(0,s=!0);let r="sugar"==l?Number(e.slice(1)):e;["equipment","role","sugar"].includes(l)?h(xi,i[l]=r,i):e in i[l]?h(xi,i[l][r]++,i):h(xi,i[l][r]=1,i)}]}class Ui extends xe{constructor(e){super(),be(this,e,Wi,Di,o,{type:1,selected:0})}}var Xi={sort:{marisa:["Stardust_Reverie","Master_Spark","Asteroid_Belt","Orrery's_Sun","Earth_Light_Ray"],medicine:["Nerve_Poison","Melancholy_Poison","Gassing_Garden","Poison_Breath","Into_Delirium"],reimu:["Dream_Seal","Demon_Seal_Circle","Double_Bound","The_Jade","Dream_Born"],youmu:["Bright_Bitter_Wheel","Six_Roots_Clean","Centered_Flow","Future_Never_Survive","Graciousness_Maze"]},marisa:{name:"魔法弹",detail:"对目标造成120%攻击力伤害。",output:{attack:[{type:"scale",value:"120",aim:"one"}]}},Stardust_Reverie:{name:"星尘幻想",detail:"对目标造成400%攻击力伤害，对其余敌人造成80%攻击力伤害。",output:{attack:[{type:"scale",value:"400",aim:"one"},{type:"scale",value:"80",aim:"else"}]}},Master_Spark:{name:"极限火花",detail:"对每个敌人造成360%攻击力伤害，下回合无法行动。",allAim:!0,output:{attack:[{type:"scale",value:"360",aim:"all"}],buff:[{value:"hypodynamic",amount:"1",aim:"self"}]}},Asteroid_Belt:{name:"小行星带",detail:"对每个敌人造成4x50%攻击力伤害。",allAim:!0,output:{attack:[{type:"scale",value:"50",aim:"all",amount:"4"}]}},"Orrery's_Sun":{name:"太阳仪",detail:"本回合所有直接攻击转移到下回合造成120%的间接伤害。",allAim:!0,output:{buff:[{value:"Orrery's_Sun",amount:"1",aim:"self"}]}},Earth_Light_Ray:{name:"地球光",detail:"将600%攻击力伤害平摊给所有敌人",allAim:!0,output:{attack:[{type:"scale",value:"600",aim:"average"}]}},medicine:{},Nerve_Poison:{name:"神经之毒",detail:""},Melancholy_Poison:{name:"忧郁之毒",detail:""},Gassing_Garden:{name:"毒气花园",detail:""},Poison_Breath:{name:"猛毒气息",detail:""},Into_Delirium:{name:"进入疯狂",detail:""},reimu:{},Dream_Seal:{name:"梦想封印",detail:"分别对随机目标造成8*10%对方当前生命值的伤害。不会暴击。"},Demon_Seal_Circle:{name:"封魔阵",detail:"无效化目标下回合的直接攻击。"},Double_Bound:{name:"二重结界",detail:"下一回合，受到伤害时会返还同样的伤害。"},The_Jade:{name:"阴阳鬼神玉",detail:"对目标造成400%攻击力伤害。"},Dream_Born:{name:"梦想天生",detail:"接下来的七次攻击有15%概率使自己免受一次伤害，第七次获得自身当前血量50%的护盾。"},youmu:{name:"剑气",detail:"对目标造成2*50%攻击力伤害。",output:{attack:[{type:"scale",value:"50",aim:"one",amount:"2"}]}},Bright_Bitter_Wheel:{name:"幽明的苦轮",detail:"半灵将重复你接下来的三次攻击，造成60%间接伤害，每次回复一点灵力。"},Six_Roots_Clean:{name:"六根清净斩",detail:"闪避下次受到的攻击并对每个敌人造成180%攻击力伤害。"},Centered_Flow:{name:"圆心流转斩",detail:"对每个敌人造成3*40%攻击力伤害，下一次普通攻击造成的伤害提高40%。"},Future_Never_Survive:{name:"未来永劫斩",detail:"对目标造成300%攻击力伤害，接下来三次普通攻击变为2*70%。"},Graciousness_Maze:{name:"迷津慈航斩",detail:"普通攻击消耗的灵力+1但伤害提高200%，直到下回合初。"}},Gi={sort:{shrine:{normal:["cirno","lilywhite"],elite:[],boss:[]},forest:{normal:["sunny","lunar","star","eternity"]},moon:{normal:["piece"]}},cirno:{name:"冰之妖精",detail:"冷酷的智者",type:"normal"},piece:{name:"地狱的妖精",detail:"拥有使人发狂程度的能力",type:"normal"},lilywhite:{name:"报春的妖精",detail:"拥有告知春天到来程度的能力",type:"normal"},sunny:{name:"日光的妖精",detail:"拥有操纵光的折射程度的能力",type:"normal"},lunar:{name:"月光的妖精",detail:"拥有消除声音程度的能力",type:"normal"},star:{name:"星光的妖精",detail:"拥有感应到活动事物程度的能力",type:"normal"},eternity:{name:"凤蝶的妖精",detail:"拥有播撒鳞粉程度的能力",type:"normal"}},Yi={role:{marisa:e=>Vi(e,.9,.9,1,5),reimu:e=>Vi(e,1,1,1,6),shion:e=>Vi(e,1.1,1.1,1,5),medicine:e=>Vi(e,.9,.9,1,4),aya:e=>Vi(e,1,1,1.2,5),renko:e=>Vi(e,1,1,1,5),youmu:e=>Vi(e,.8,1.1,1.1,8)},enermy:{cirno:e=>Zi(e,1,1,1),piece:e=>Zi(e,1,1,1),lilywhite:e=>Zi(e,1,1,1),sunny:e=>Zi(e,1,1,1),lunar:e=>Zi(e,1,1,1),star:e=>Zi(e,1,1,1),eternity:e=>Zi(e,1,1,1)},amount:e=>{let t=4.2-1/Math.pow(2,e/32-2),n=t-parseInt(t),r=Number(Math.random()<n);return parseInt(t)+r}};function Vi(e,t,n,r,i){return{health:Math.ceil(Ki(e)*t),attack:Math.ceil(Ki(e)*n/6),speed:1+.02*e*r,power:i}}function Zi(e,t,n,r){return{health:Qi(Ji(e)*t),attack:Qi(Ji(e)*n/8),speed:1+.02*(e-1)*r}}function Ki(e){return parseInt(Math.pow(Math.E,e/(Math.E*Math.log(e+1)+Math.sqrt(e)/Math.E))+e+10)}function Ji(e){return parseInt(Math.pow(Math.E,e/(Math.log(e+1)+Math.sqrt(e)))+e+10)}function Qi(e){return.95*e+Math.random().toFixed(2)*e*.1}function el(e,t,n){const r=e.slice();return r[14]=t[n],r[16]=n,r}function tl(e){let t,n,r,i=e[14].value+"";return{c(){t=j("txt"),n=E(i),T(t,"class",r=d(e[16]+e[2]==e[1]-1&&"reading")+" svelte-19hh7fi"),N(t,"--length",e[14].value.getByteLen()/2-1),N(t,"width",e[14].value.getByteLen()-2+"ch"),N(t,"--time",(e[16]+e[2]==e[1]-1?.2*(e[14].value.getByteLen()/2-1):0)+"s")},m(e,r){w(e,t,r),b(t,n)},p(e,l){6&l&&i!==(i=e[14].value+"")&&z(n,i),6&l&&r!==(r=d(e[16]+e[2]==e[1]-1&&"reading")+" svelte-19hh7fi")&&T(t,"class",r),6&l&&N(t,"--length",e[14].value.getByteLen()/2-1),6&l&&N(t,"width",e[14].value.getByteLen()-2+"ch"),6&l&&N(t,"--time",(e[16]+e[2]==e[1]-1?.2*(e[14].value.getByteLen()/2-1):0)+"s")},d(e){e&&k(t)}}}function nl(e){let t,n,r;function i(t){e[7](t)}let l={type:e[3]};return void 0!==e[0]&&(l.selected=e[0]),t=new Ui({props:l}),D.push((()=>pe(t,"selected",i))),{c(){ge(t.$$.fragment)},m(e,n){ve(t,e,n),r=!0},p(e,r){const i={};8&r&&(i.type=e[3]),!n&&1&r&&(n=!0,i.selected=e[0],V((()=>n=!1))),t.$set(i)},i(e){r||(ae(t.$$.fragment,e),r=!0)},o(e){oe(t.$$.fragment,e),r=!1},d(e){ye(t,e)}}}function rl(e){let t,n,r,i,l,s,a,o,u=e[5].slice(e[2],e[1]),c=[];for(let t=0;t<u.length;t+=1)c[t]=tl(el(e,u,t));let f=e[3]&&nl(e);return{c(){t=j("div"),n=j("div");for(let e=0;e<c.length;e+=1)c[e].c();r=M(),f&&f.c(),T(n,"class","talk svelte-19hh7fi"),T(t,"class","body svelte-19hh7fi")},m(i,l){w(i,t,l),b(t,n);for(let e=0;e<c.length;e+=1)c[e]&&c[e].m(n,null);b(t,r),f&&f.m(t,null),s=!0,a||(o=C(t,"click",e[8]),a=!0)},p(e,[r]){if(38&r){let t;for(u=e[5].slice(e[2],e[1]),t=0;t<u.length;t+=1){const i=el(e,u,t);c[t]?c[t].p(i,r):(c[t]=tl(i),c[t].c(),c[t].m(n,null))}for(;t<c.length;t+=1)c[t].d(1);c.length=u.length}e[3]?f?(f.p(e,r),8&r&&ae(f,1)):(f=nl(e),f.c(),ae(f,1),f.m(t,null)):f&&(le(),oe(f,1,1,(()=>{f=null})),se())},i(e){s||(ae(f),Y((()=>{s&&(l&&l.end(1),i=ce(t,zi,{duration:250}),i.start())})),s=!0)},o(e){oe(f),i&&i.invalidate(),l=fe(t,zi,{duration:250}),s=!1},d(e){e&&k(t),S(c,e),f&&f.d(),e&&l&&l.end(),a=!1,o()}}}function il(e,t,n){let r,i,l;f(e,xi,(e=>n(9,r=e))),f(e,yi,(e=>n(10,i=e))),f(e,wi,(e=>n(11,l=e)));let s=!1,a=0,o=0,u=null,c=!0,d=[{type:"txt",value:"宇佐见莲子正对着笔记本电脑沉思。"},{type:"txt",value:"“终于要动笔了吗？”梅莉端着咖啡走来。"},{type:"txt",value:"“是啊。”莲子伸了个懒腰。"},{type:"txt",value:"“要加多少糖呢？”"},{type:"selector",value:"sugar"},{type:"txt",value:"“幻想交织在静谧的夜空之下——”莲子写道。"},{type:"txt",value:"“这句话有什么作用吗？”"},{type:"txt",value:"“文、文学的事情，你少管！”"},{type:"txt",value:"“少女坐在破旧的神社中。”她接着写，“其名为——”"},{type:"selector",value:"role"}];function m(){"txt"==d[a].type?n(1,a++,a):s?(n(4,c=!1),setTimeout((e=>{a==d.length-1?function(){const e={enermy:e=>l.enermy.push(Gi.sort[r.scene][e].rd()[0])};e.enermy("normal");let t=Yi.amount(l.lv);for(let n=0;n<t+10;n++)e.enermy("normal");h(xi,r.spellcards[r.role]=4,r),p(),p(),h(yi,i="explore",i)}():(n(2,o=a+1),n(1,a+=1),n(3,u=null),n(0,s=!1),n(4,c=!0),setTimeout((e=>m()),200))}),1e3)):n(3,u=d[a].value)}function p(){let e=deepCopy(Xi).sort[r.role].rd()[0];r.spellcards[e]?h(xi,r.spellcards[e]++,r):h(xi,r.spellcards[e]=1,r)}m();return[s,a,o,u,c,d,m,function(e){s=e,n(0,s)},e=>c&&m()]}class ll extends xe{constructor(e){super(),be(this,e,il,rl,o,{})}}function sl(e,t,n){const r=e.slice();return r[7]=t[n],r[9]=n,r}function al(e,t){let n,r,i,l,s,a,o,u,f,h,m,p,g,v,y,_,x=Gi[t[7]].name+"",$=Gi[t[7]].detail+"";function S(...e){return t[5](t[9],...e)}return{key:e,first:null,c(){n=j("div"),r=j("img"),l=M(),s=j("div"),a=j("txt"),o=j("span"),o.textContent=`lv.${t[4].lv}`,u=E(x),f=M(),h=j("txt"),m=E($),p=M(),g=j("div"),c(r.src,i=`/img/enermy/${Gi[t[7]].type}/${t[7]}/icon.png`)||T(r,"src",i),T(r,"class","svelte-181igqh"),T(o,"class","svelte-181igqh"),T(a,"class","svelte-181igqh"),T(h,"class","svelte-181igqh"),T(s,"class","enermy-info svelte-181igqh"),T(g,"class",d(`enermy-type enermy_${Gi[t[7]].type}`)+" svelte-181igqh"),T(n,"class",v=d(`enermy ${t[0][t[9]]&&"enermy_selected"}`)+" svelte-181igqh"),this.first=n},m(e,t){w(e,n,t),b(n,r),b(n,l),b(n,s),b(s,a),b(a,o),b(a,u),b(s,f),b(s,h),b(h,m),b(n,p),b(n,g),y||(_=C(n,"click",S),y=!0)},p(e,r){t=e,1&r&&v!==(v=d(`enermy ${t[0][t[9]]&&"enermy_selected"}`)+" svelte-181igqh")&&T(n,"class",v)},d(e){e&&k(n),y=!1,_()}}}function ol(e){let t,n,r,i,l,s,a,o,u,c,f,d,h,m=[],p=new Map,g=e[4].enermy;const v=e=>e[9];for(let t=0;t<g.length;t+=1){let n=sl(e,g,t),r=v(n);p.set(r,m[t]=al(r,n))}return{c(){t=j("div"),n=j("div"),n.innerHTML="<txt>机遇</txt>",r=M(),i=j("div"),l=j("txt"),l.textContent=`敌人(${e[3]})`,s=M();for(let e=0;e<m.length;e+=1)m[e].c();a=M(),o=j("txt"),o.textContent="战斗",T(n,"class","explore-events svelte-181igqh"),T(l,"class","title svelte-181igqh"),T(o,"class","btn svelte-181igqh"),T(i,"class","explore-enermys svelte-181igqh"),T(t,"class","body explore svelte-181igqh"),N(t,"background-image","url('/img/scene/shrine.webp')")},m(u,c){w(u,t,c),b(t,n),b(t,r),b(t,i),b(i,l),b(i,s);for(let e=0;e<m.length;e+=1)m[e]&&m[e].m(i,null);b(i,a),b(i,o),f=!0,d||(h=C(o,"click",e[6]),d=!0)},p(e,[t]){17&t&&(g=e[4].enermy,m=me(m,t,v,1,e,g,p,i,de,al,a,sl))},i(e){f||(Y((()=>{f&&(c&&c.end(1),u=ce(t,zi,{duration:250}),u.start())})),f=!0)},o(e){u&&u.invalidate(),c=fe(t,zi,{duration:250}),f=!1},d(e){e&&k(t);for(let e=0;e<m.length;e+=1)m[e].d();e&&c&&c.end(),d=!1,h()}}}function ul(e,t,n){let r,i;f(e,wi,(e=>n(1,r=e))),f(e,yi,(e=>n(2,i=e)));let l=r.enermy.length;const s=deepCopy(r);l>6&&s.enermy.splice(6);let a=s.enermy.map((e=>!1));return[a,r,i,l,s,(e,t)=>n(0,a[e]=!a[e],a),e=>{a.reduce(((e,t)=>e+Number(t)),0)>s.enermyLimit?alert("你最多只能选择四个敌人"):h(yi,i="battle",i),h(wi,r.target=a,r)}]}class cl extends xe{constructor(e){super(),be(this,e,ul,ol,o,{})}}function fl(e,t,n){const r=e.slice();return r[15]=t[n],r}function dl(e,t){let n,r,i,l,s,a,o,u,f,h,m,p,g,v,y=Xi[t[4][t[15]]].name+"",_=Xi[t[4][t[15]]].detail+"";function x(...e){return t[8](t[15],...e)}return{key:e,first:null,c(){n=j("div"),r=j("img"),l=M(),s=j("txt"),a=E(y),o=M(),u=j("div"),f=j("txt"),h=E(_),m=M(),c(r.src,i=`/svg/spellcard/${t[4][t[15]]}.svg`)||T(r,"src",i),T(r,"class","svelte-wwdao0"),T(s,"class","svelte-wwdao0"),T(f,"class","svelte-wwdao0"),T(u,"class","svelte-wwdao0"),T(n,"class",p=d(`spellcard ${t[2]==t[15]&&!t[3](t[15])&&"selectedSpellcard"} ${t[3](t[15])&&"animate_useSpellcard"}`)+" svelte-wwdao0"),this.first=n},m(e,t){w(e,n,t),b(n,r),b(n,l),b(n,s),b(s,a),b(n,o),b(n,u),b(u,f),b(f,h),b(n,m),g||(v=C(n,"click",x),g=!0)},p(e,l){t=e,2&l&&!c(r.src,i=`/svg/spellcard/${t[4][t[15]]}.svg`)&&T(r,"src",i),2&l&&y!==(y=Xi[t[4][t[15]]].name+"")&&z(a,y),2&l&&_!==(_=Xi[t[4][t[15]]].detail+"")&&z(h,_),14&l&&p!==(p=d(`spellcard ${t[2]==t[15]&&!t[3](t[15])&&"selectedSpellcard"} ${t[3](t[15])&&"animate_useSpellcard"}`)+" svelte-wwdao0")&&T(n,"class",p)},d(e){e&&k(n),g=!1,v()}}}function hl(t){let n,r=[],i=new Map,l=t[1];const s=e=>e[15];for(let e=0;e<l.length;e+=1){let n=fl(t,l,e),a=s(n);i.set(a,r[e]=dl(a,n))}return{c(){n=j("div");for(let e=0;e<r.length;e+=1)r[e].c();T(n,"class","spellcards svelte-wwdao0")},m(e,t){w(e,n,t);for(let e=0;e<r.length;e+=1)r[e]&&r[e].m(n,null)},p(e,[t]){31&t&&(l=e[1],r=me(r,t,s,1,e,l,i,n,de,dl,null,fl))},i:e,o:e,d(e){e&&k(n);for(let e=0;e<r.length;e+=1)r[e].d()}}}function ml(e,t,n){let r,i;f(e,xi,(e=>n(10,i=e)));const l=deepCopy(i),s=[];for(let e in l.spellcards)for(let t=0;t<l.spellcards[e];t++)s.push(e);p("blade_of_yellow_spring",(e=>[...Array(e).keys()].forEach((e=>s.push(l.role)))));let a,o=m(),u=[],c=[],{Selected:d}=t;const h=function(e){let t=4+e,r=[];p("blade_of_yellow_spring",(e=>{r=s.map(((e,t)=>t)).splice(-e),u.splice(-e)})),p("blood_book",(e=>t+=e)),n(1,u=u.filter((e=>!c.includes(e)))),o=o.filter((e=>!u.includes(e))).rd(),n(1,u=[...u,...o.splice(0,t-u.length),...r]),o=0==o.length?m():o,n(7,c=[]),n(2,a=null)};function m(){let e=s.map(((e,t)=>t));return p("blade_of_yellow_spring",(t=>e.splice(-t))),e}function p(e,t){e in l.collections&&t(l.collections[e])}return e.$$set=e=>{"Selected"in e&&n(0,d=e.Selected)},e.$$.update=()=>{128&e.$$.dirty&&n(3,r=e=>c.includes(e))},[d,u,a,r,s,e=>n(7,c=[...c,a]),h,c,(e,t)=>{n(2,a=a==e?null:e),n(0,d=s[a])}]}class pl extends xe{constructor(e){super(),be(this,e,ml,hl,o,{Selected:0,used:5,refresh:6})}get used(){return this.$$.ctx[5]}get refresh(){return this.$$.ctx[6]}}var gl={hypodynamic:{name:"乏力",detail:"回合开始时不回复灵力。生效时层数-1。",expend:!0},"Orrery's_Sun":{name:"太阳仪",detail:"直接攻击在次回合造成120%*1(每层+1)间接伤害。生效时层数-1。",positive:!0,expend:!0},tired:{name:"疲倦",detail:"回合开始时回复灵力减少1(每层+1)。生效时层数-1。",expend:!0},imprisoned:{name:"禁锢",detail:"回合内禁止行动。生效时层数-1。",expend:!0},prophesy:{name:"预言",detail:"闪避接下来的1(每层+1)次攻击。生效时层数-1。每回合初清空。",positive:!0,expend:!0,interim:!0},foresee:{name:"预知",detail:"闪避接下来的1(每层+1)次攻击。生效时层数-1。",positive:!0,expend:!0},interim_barrier:{name:"临时防御结界",detail:"阻挡1(每层+1)点伤害。生效时层数-1。每回合初清空。",positive:!0,interim:!0},barrier:{name:"防御结界",detail:"阻挡1(每层+1)点伤害。生效时层数-1。",positive:!0},Bright_Bitter_Wheel:{name:"幽明的苦轮",detail:"攻击附带60%间接伤害并回复1点灵力",positive:!0,interim:!0},frostbite:{name:"冻伤",detail:""},in_treatment:{name:"治疗中",detail:"回复5%(每层+5%)当前生命值。",positive:!0,interim:!0},burning:{name:"燃烧",detail:"每回合扣除2%(每层+2%)最大生命值。生效时层数-1。",expend:!0},strength_of_wine:{name:"酒劲",detail:"符卡造成的伤害+10%(每层+10%)。每回合初清空。",interim:!0,positive:!0},seal_needle:{name:"封魔针",detail:"造成8(每层-1)次伤害后，攻击对全体敌人附加流血。"},bleed:{name:"流血",detail:"每回合扣除2%(每层+2%)最大生命值。受治疗时移除。"},star:{name:"星星",detail:"天上的星星不装在瓶子里可是会爆炸的！",positive:!0}};const vl={cirno:{stage1:{mode:"random"}},piece:{stage1:{mode:"random"}},lilywhite:{stage1:{mode:"random"}},sunny:{stage1:{mode:"random"}},lunar:{stage1:{mode:"random"}},star:{stage1:{mode:"random"}},eternity:{stage1:{mode:"random"}}};var yl={sort:{cirno:["Perfect_Freeze","Icicle_Fall","Diamond_Blizzard","Minus_K","Frost_Columns"],lilywhite:["Surprise_Spring"]},cirno:{name:"冷气",detail:"对目标造成100%攻击力伤害。",output:{attack:[{type:"scale",value:"100",aim:"one"}]}},Perfect_Freeze:{name:"完美冻结",detail:"50%几率冻结对方一回合，50%几率冻结自己，若自己被冻结，受到的伤害减半。解冻后对目标造成300%攻击力伤害。"},Icicle_Fall:{name:"冰瀑",detail:"一回合无法行动，之后对目标造成600%攻击力伤害。"},Diamond_Blizzard:{name:"钻石风暴",detail:"对目标造成240%攻击力伤害并施加一层缓慢，对自己造成50%攻击力伤害。"},Minus_K:{name:"负K",detail:"接下来一回合，受到伤害会反馈一层冻伤。"},Frost_Columns:{name:"冰袭方阵",detail:"对目标造成200%攻击力伤害并施加两层疲倦。"},Surprise_Spring:{name:"惊喜之春",detail:"随机对目标造成80%到200%攻击力伤害",output:{attack:[{type:"random",typeofRandom:"scale",max:"80",min:"200",aim:"one"}]}}};const _l={};Object.assign(_l,Xi),Object.assign(_l,yl);const bl={spellcard:_l,buff:gl};var xl=(e,t,n)=>{const r={},i={attack:[],buff:[],heal:[]};e.role&&(e.state=Yi.role[e.role](e.lv)),"Orrery's_Sun"in e.buff&&(r["Orrery's_Sun"]=[]);const l=deepCopy(bl.spellcard[n].output);if("buff"in l)for(let e of l.buff)i.buff.push(e);if("attack"in l)for(let t of l.attack)if(t.amount=t.amount?t.amount:1,"Orrery's_Sun"in e.buff)r["Orrery's_Sun"].push(t);else for(let e=0;e<t.amount;e++)i.attack.push(deepCopy(t));return"collections"in e&&(s("vampire's_old_tooth",(e=>0!=i.attack.length&&i.attack.forEach((t=>i.heal.push({type:"value",value:.5*e}))))),s("portable_money_box",(t=>i.attack.forEach((n=>n.value=n.value*(1+.05*t*Math.floor(e.coin/100)))))),s("skyrocket",(t=>n==e.role&&i.attack.forEach((e=>{$l()<.3&&(e.value=1.5*e.value,i.buff.push({value:"burning",amount:t,aim:"one"}))})))),s("pickled_radish",(t=>e.health/e.state.health>=.95&&n!=e.role&&i.attack.forEach((e=>e.value*=1+.1*t)))),s("bronze_mirror",(e=>i.attack.forEach((t=>$l()<.25&&i.attack.push({type:t.type,value:.3*t.value*e,aim:"random",critical:!1}))))),s("earthy_spider_wine",(t=>{n==e.role&&(e.buff.strength_of_wine=t)})),s("amulet_of_full_moon",(t=>{Object.keys(e.buff).reduce(((e,t)=>e+(1==bl.buff[t].positive?0:1)),0)>2&&i.attack.forEach((e=>e.value*=1+.1*t))})),a("strength_of_wine",(t=>n!=e.role&&i.attack.forEach((e=>e.value*=1+.1*t)))),a("seal_needle",(t=>{t<=1&&(s("seal_needle",(e=>i.buff.push({value:"bleed",amount:e,aim:"all"}))),t<1?e.buff.seal_needle+=9:e.buff.seal_needle=9)}))),i.attack.forEach((t=>{t.from=e.role?"role":"enermy"})),i.buff.forEach((e=>e.amount=Number(e.amount))),i;function s(t,n){t in e.collections&&n(e.collections[t])}function a(t,n){if(t in e.buff){let r=e.buff[t];!bl.buff[t].positive&&s("fish_stone",(e=>r-=e)),n(r>=0?r:0),bl.buff[t].expend&&(1==e.buff[t]?delete e.buff[t]:e.buff[t]--)}}};function $l(){return Math.random()}function wl(t){let n,r,i,l,s,a,o,u,c,f,d,h;return{c(){n=j("div"),r=j("div"),i=M(),l=j("div"),s=M(),a=j("div"),o=M(),u=j("div"),c=M(),f=j("div"),d=M(),h=j("div"),T(r,"class","svelte-3ja3ij"),T(l,"class","svelte-3ja3ij"),T(a,"class","svelte-3ja3ij"),T(u,"class","svelte-3ja3ij"),T(f,"class","svelte-3ja3ij"),T(h,"class","svelte-3ja3ij"),T(n,"class","MarisaAttack svelte-3ja3ij"),N(n,"transform","rotate("+t[0]+"deg)"),N(n,"left",t[1]+"px"),N(n,"top",t[2]+"px")},m(e,t){w(e,n,t),b(n,r),b(n,i),b(n,l),b(n,s),b(n,a),b(n,o),b(n,u),b(n,c),b(n,f),b(n,d),b(n,h)},p:e,i:e,o:e,d(e){e&&k(n)}}}function kl(e){return[360*Math.random(),30+150*Math.random(),50+150*Math.random()]}const Sl={marisa:class extends xe{constructor(e){super(),be(this,e,kl,wl,o,{})}}};function jl(t){let n,r,i,l,s,a;return{c(){n=j("div"),r=j("span"),i=E(t[0]),l=M(),s=j("a"),a=E(t[1]),N(r,"background-color","var(--"+t[2]+")"),T(r,"class","svelte-36i0c7"),T(s,"class","svelte-36i0c7"),T(n,"class","explain svelte-36i0c7")},m(e,t){w(e,n,t),b(n,r),b(r,i),b(n,l),b(n,s),b(s,a)},p(e,[t]){1&t&&z(i,e[0]),4&t&&N(r,"background-color","var(--"+e[2]+")"),2&t&&z(a,e[1])},i:e,o:e,d(e){e&&k(n)}}}function El(e,t,n){let{title:r}=t,{detail:i}=t,{color:l}=t;return e.$$set=e=>{"title"in e&&n(0,r=e.title),"detail"in e&&n(1,i=e.detail),"color"in e&&n(2,l=e.color)},[r,i,l]}class Ml extends xe{constructor(e){super(),be(this,e,El,jl,o,{title:0,detail:1,color:2})}}function Al(e,t,n){const r=e.slice();return r[24]=t[n],r[26]=n,r}function Cl(e,t,n){const r=e.slice();return r[27]=t[n],r[29]=n,r}function Tl(e,t,n){const r=e.slice();return r[30]=t[n],r[29]=n,r}function zl(e){let t,n,r=Object.values(e[0][e[26]].buff)[e[29]]+"";return{c(){t=j("txt"),n=E(r),T(t,"class","svelte-2vu2l")},m(e,r){w(e,t,r),b(t,n)},p(e,t){1&t[0]&&r!==(r=Object.values(e[0][e[26]].buff)[e[29]]+"")&&z(n,r)},d(e){e&&k(t)}}}function Nl(e,t){let n,r,i,l,s,a,o,u,f=Object.values(t[0][t[26]].buff)[t[29]]>1,d=f&&zl(t);return a=new Ml({props:{title:gl[t[30]].name,detail:gl[t[30]].detail,color:gl[t[30]].positive?"blue":"purple"}}),{key:e,first:null,c(){n=j("div"),r=j("img"),l=M(),d&&d.c(),s=M(),ge(a.$$.fragment),o=M(),c(r.src,i="/svg/buff/"+t[30]+".svg")||T(r,"src",i),T(n,"class","svelte-2vu2l"),this.first=n},m(e,t){w(e,n,t),b(n,r),b(n,l),d&&d.m(n,null),b(n,s),ve(a,n,null),b(n,o),u=!0},p(e,l){t=e,(!u||1&l[0]&&!c(r.src,i="/svg/buff/"+t[30]+".svg"))&&T(r,"src",i),1&l[0]&&(f=Object.values(t[0][t[26]].buff)[t[29]]>1),f?d?d.p(t,l):(d=zl(t),d.c(),d.m(n,s)):d&&(d.d(1),d=null);const o={};1&l[0]&&(o.title=gl[t[30]].name),1&l[0]&&(o.detail=gl[t[30]].detail),1&l[0]&&(o.color=gl[t[30]].positive?"blue":"purple"),a.$set(o)},i(e){u||(ae(a.$$.fragment,e),u=!0)},o(e){oe(a.$$.fragment,e),u=!1},d(e){e&&k(n),d&&d.d(),ye(a)}}}function Rl(e){let t,n=[],r=new Map,i=e[4][e[26]].attack;const l=e=>e[29];for(let t=0;t<i.length;t+=1){let s=Cl(e,i,t),a=l(s);r.set(a,n[t]=Ol(a,s))}return{c(){for(let e=0;e<n.length;e+=1)n[e].c();t=A()},m(e,r){for(let t=0;t<n.length;t+=1)n[t]&&n[t].m(e,r);w(e,t,r)},p(e,s){144&s[0]&&(i=e[4][e[26]].attack,n=me(n,s,l,1,e,i,r,t.parentNode,de,Ol,t,Cl))},d(e){for(let t=0;t<n.length;t+=1)n[t].d(e);e&&k(t)}}}function Ol(e,t){let n,r,i,l=t[27].damage.toFixed(1)+"";return{key:e,first:null,c(){n=j("a"),r=E(l),T(n,"class",i="battle-input "+(t[27].critical&&"critical")+" svelte-2vu2l"),N(n,"left",30+150*ql()+"px"),N(n,"top",50+150*ql()+"px"),this.first=n},m(e,t){w(e,n,t),b(n,r)},p(e,s){t=e,16&s[0]&&l!==(l=t[27].damage.toFixed(1)+"")&&z(r,l),16&s[0]&&i!==(i="battle-input "+(t[27].critical&&"critical")+" svelte-2vu2l")&&T(n,"class",i)},d(e){e&&k(n)}}}function Pl(e){let t,n,r;var i=Sl[e[6].role];return i&&(t=R(i,{})),{c(){t&&ge(t.$$.fragment),n=A()},m(e,i){t&&ve(t,e,i),w(e,n,i),r=!0},p(e,r){if(i!==(i=Sl[e[6].role])){if(t){le();const e=t;oe(e.$$.fragment,1,0,(()=>{ye(e,1)})),se()}i?(t=R(i,{}),ge(t.$$.fragment),ae(t.$$.fragment,1),ve(t,n.parentNode,n)):t=null}},i(e){r||(t&&ae(t.$$.fragment,e),r=!0)},o(e){t&&oe(t.$$.fragment,e),r=!1},d(e){e&&k(n),t&&ye(t,e)}}}function Il(e,t){let n,r,i,l,s,a,o,u,f,h,m,p,g,v,y,_,x,$,S,A,z,R,O=Gi[t[24]].name+"",P=[],I=new Map,L=Object.keys(t[0][t[26]].buff);const q=e=>e[29];for(let e=0;e<L.length;e+=1){let n=Tl(t,L,e),r=q(n);I.set(r,P[e]=Nl(r,n))}let B=t[4]&&0!=t[4][t[26]].attack.length&&Rl(t),F=t[4]&&0!=t[4][t[26]].attack.length&&Pl(t);function H(...e){return t[12](t[26],...e)}return{key:e,first:null,c(){n=j("div"),r=j("div"),i=j("img"),a=M(),o=j("txt"),u=E(O),f=M(),h=j("div"),m=j("div"),p=M(),g=j("div");for(let e=0;e<P.length;e+=1)P[e].c();v=M(),y=j("div"),_=M(),B&&B.c(),x=M(),F&&F.c(),$=M(),c(i.src,l=`/img/enermy/${Gi[t[24]].type}/${t[24]}/${t[4]&&0!=t[4][t[26]].attack.length||t[0][t[26]].Health<=0?"hurt":"portrait"}.png`)||T(i,"src",l),T(i,"class",s=d(`${t[4]&&0!=t[4][t[26]].attack.length&&"animate_enermyShake"}`)+" svelte-2vu2l"),T(o,"class","svelte-2vu2l"),T(r,"class","enermy-info svelte-2vu2l"),T(m,"class","enermy-health svelte-2vu2l"),N(m,"visibility",t[0][t[26]].Health/t[0][t[26]].health!=1?"visible":"hidden"),N(m,"background-image",`linear-gradient(90deg, white ${t[0][t[26]].Health/t[0][t[26]].health*100}%, transparent ${t[0][t[26]].Health/t[0][t[26]].health*100}%)`),T(g,"class","enermy-buff svelte-2vu2l"),T(h,"class","enermy-state svelte-2vu2l"),T(y,"class","enermy-aim svelte-2vu2l"),T(n,"class",S=d(`enermy ${!t[5]&&t[1]&&"oneAim"} ${t[0][t[26]].Health<=0&&"animate_enermyOut"} ${t[2]==t[26]&&"orderEnermy"}`)+" svelte-2vu2l"),N(n,"z-index",t[7].length-t[26]),this.first=n},m(e,t){w(e,n,t),b(n,r),b(r,i),b(r,a),b(r,o),b(o,u),b(n,f),b(n,h),b(h,m),b(h,p),b(h,g);for(let e=0;e<P.length;e+=1)P[e]&&P[e].m(g,null);b(n,v),b(n,y),b(n,_),B&&B.m(n,null),b(n,x),F&&F.m(n,null),b(n,$),A=!0,z||(R=C(n,"click",H),z=!0)},p(e,r){t=e,(!A||17&r[0]&&!c(i.src,l=`/img/enermy/${Gi[t[24]].type}/${t[24]}/${t[4]&&0!=t[4][t[26]].attack.length||t[0][t[26]].Health<=0?"hurt":"portrait"}.png`))&&T(i,"src",l),(!A||16&r[0]&&s!==(s=d(`${t[4]&&0!=t[4][t[26]].attack.length&&"animate_enermyShake"}`)+" svelte-2vu2l"))&&T(i,"class",s),(!A||1&r[0])&&N(m,"visibility",t[0][t[26]].Health/t[0][t[26]].health!=1?"visible":"hidden"),(!A||1&r[0])&&N(m,"background-image",`linear-gradient(90deg, white ${t[0][t[26]].Health/t[0][t[26]].health*100}%, transparent ${t[0][t[26]].Health/t[0][t[26]].health*100}%)`),129&r[0]&&(L=Object.keys(t[0][t[26]].buff),le(),P=me(P,r,q,1,t,L,I,g,he,Nl,null,Tl),se()),t[4]&&0!=t[4][t[26]].attack.length?B?B.p(t,r):(B=Rl(t),B.c(),B.m(n,x)):B&&(B.d(1),B=null),t[4]&&0!=t[4][t[26]].attack.length?F?(F.p(t,r),16&r[0]&&ae(F,1)):(F=Pl(t),F.c(),ae(F,1),F.m(n,$)):F&&(le(),oe(F,1,1,(()=>{F=null})),se()),(!A||39&r[0]&&S!==(S=d(`enermy ${!t[5]&&t[1]&&"oneAim"} ${t[0][t[26]].Health<=0&&"animate_enermyOut"} ${t[2]==t[26]&&"orderEnermy"}`)+" svelte-2vu2l"))&&T(n,"class",S)},i(e){if(!A){for(let e=0;e<L.length;e+=1)ae(P[e]);ae(F),A=!0}},o(e){for(let e=0;e<P.length;e+=1)oe(P[e]);oe(F),A=!1},d(e){e&&k(n);for(let e=0;e<P.length;e+=1)P[e].d();B&&B.d(),F&&F.d(),z=!1,R()}}}function Ll(e){let t,n,r,i=[],l=new Map,s=e[7];const a=e=>e[26];for(let t=0;t<s.length;t+=1){let n=Al(e,s,t),r=a(n);l.set(r,i[t]=Il(r,n))}return{c(){t=j("div");for(let e=0;e<i.length;e+=1)i[e].c();T(t,"class",n="enermys "+(e[5]&&"allAim")+" svelte-2vu2l")},m(e,n){w(e,t,n);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,null);r=!0},p(e,o){255&o[0]&&(s=e[7],le(),i=me(i,o,a,1,e,s,l,t,he,Il,null,Al),se()),(!r||32&o[0]&&n!==(n="enermys "+(e[5]&&"allAim")+" svelte-2vu2l"))&&T(t,"class",n)},i(e){if(!r){for(let e=0;e<s.length;e+=1)ae(i[e]);r=!0}},o(e){for(let e=0;e<i.length;e+=1)oe(i[e]);r=!1},d(e){e&&k(t);for(let e=0;e<i.length;e+=1)i[e].d()}}}function ql(){return Math.random()}function Bl(e,t,n){let r,i,l,s;f(e,ki,(e=>n(13,i=e))),f(e,xi,(e=>n(14,l=e))),f(e,wi,(e=>n(15,s=e)));let{Selected:a}=t,{state:o}=t,{ordered:u}=t,{aimed:c}=t,{critical:d}=t,{killEvent:m}=t;const p={round:function(e,t){e({health:o[t].Health,state:o[t],buff:o[t].buff,input:e=>x(e,t),power:e=>null,index:t}),n(0,o)},output:function(){const e=o.map((e=>e.speed)),t=[];for(let n=0;n<e.length;n++){let n=e.indexOf(Math.max(...e));t.push(n),e[n]=0}return t.map((e=>function(e,t){let n=Math.floor(e/16)+1;return vl[t][n],"cirno"==t?["cirno","cirno","cirno"]:["Surprise_Spring","Surprise_Spring"]}(v.lv,_[e]).map((t=>xl(o[e],(e=>h(ki,i=e,i)),t)))))},input:x,state:e=>o};let{role:g}=t;const v=deepCopy(s),y=deepCopy(l),_=v.target.map(((e,t)=>e&&v.enermy[t])).filter((e=>e));o=_.map((e=>{let t=Yi.enermy[e](v.lv);return t.Health=t.health,t.buff={},t}));let b=null;function x(e,t){let r=_.map((e=>({attack:[],buff:[],heal:[]}))),l={heal:[],attack:[],buff:[]},s=[...Array(r.length).keys()],a={one:[t],all:s,else:s.filter((e=>e!=t)),average:s,random:s.filter((e=>o[e].Health>0)).rd().splice(0,1)},u=g.state();for(let t of e.attack){let e=Number(t.value);t.amount=t.amount?t.amount:1,"scale"==t.type&&(e*=.01*u.attack),t.type,"average"==t.aim&&(e/=s.filter((e=>o[e].Health>0)).length);let n=deepCopy(t);n.critical="critical"in n?n.critical:d(n.from);let i=1.5;if("role"==n.from&&$("human_soul_lamp",(e=>i+=.5*e)),n.damage=e*(n.critical?i:1),"self"==t.aim)l.attack.push(n);else for(let e of a[t.aim]){let i=deepCopy(n);$("compass_cat",(t=>{g.state().speed<o[e].speed&&(i.damage*=1+.1*t)})),"rate"==t.type&&(i.damage*=o[e].health),"Rate"==t.type&&(i.damage*=o[e].Health),r[e].attack.push(i)}}for(let t of e.heal)l.heal.push(t);for(let t of e.buff)if("self"==t.aim)l.buff.push({value:t.value,amount:t.amount});else for(let e of a[t.aim])r[e].buff.push(t);let c=function(e){const t={attack:[],buff:[],heal:[]},r=deepCopy(e);return r.forEach(((e,t)=>{for(let r of e.attack)r.indirect&&"role"==r.from&&$("sundial",(e=>r.damage*=1+.1*e)),o[t].Health>0&&o[t].Health-r.damage<=0&&m(t),r.damage>0&&"role"==r.from&&(g.buff("seal_needle"),$("bottle_of_stars",(n=>{if(r.damage>=2*g.state().attack){e.buff.push({value:"star",amount:n}),i.bottle_of_stars||h(ki,i.bottle_of_stars=[],i);for(let e=0;e<n;e++)i.bottle_of_stars.push({index:t,damage:.6*r.damage})}}))),n(0,o[t].Health-=r.damage,o);for(let n of e.heal)w(n+o[t].Health),delete o[t].buff.bleed;for(let r of e.buff)n(0,o[t].buff[r.value]=o[t].buff[r.value]?o[t].buff[r.value]+r.amount:r.amount,o)})),n(4,b=r),n(0,o),setTimeout((e=>n(4,b=null)),800),t}(r);for(let e in c)c[e].forEach((t=>l[e].push(t)));return l}function $(e,t){e in y.collections&&t(y.collections[e])}function w(e,t){health=e>o.health?o.health:e}return e.$$set=e=>{"Selected"in e&&n(1,a=e.Selected),"state"in e&&n(0,o=e.state),"ordered"in e&&n(2,u=e.ordered),"aimed"in e&&n(3,c=e.aimed),"critical"in e&&n(8,d=e.critical),"killEvent"in e&&n(9,m=e.killEvent),"role"in e&&n(11,g=e.role)},e.$$.update=()=>{2&e.$$.dirty[0]&&n(5,r=null!=a&&"allAim"in Xi[a])},[o,a,u,c,b,r,y,_,d,m,p,g,(e,t)=>{o[e].Health>0&&a&&c(e)}]}class Fl extends xe{constructor(e){super(),be(this,e,Bl,Ll,o,{Selected:1,state:0,ordered:2,aimed:3,critical:8,killEvent:9,enermy:10,role:11},null,[-1,-1])}get enermy(){return this.$$.ctx[10]}}function Hl(e,t,n){const r=e.slice();return r[24]=t[n],r[26]=n,r}function Dl(e,t,n){const r=e.slice();return r[27]=t[n],r[26]=n,r}function Wl(e,t,n){const r=e.slice();return r[29]=t[n],r[26]=n,r}function Ul(e){let t,n,r=Object.values(e[0])[e[26]]+"";return{c(){t=j("txt"),n=E(r),T(t,"class","svelte-16s3vpv")},m(e,r){w(e,t,r),b(t,n)},p(e,t){1&t&&r!==(r=Object.values(e[0])[e[26]]+"")&&z(n,r)},d(e){e&&k(t)}}}function Xl(e,t){let n,r,i,l,s,a,o,u,f=Object.values(t[0])[t[26]]>1,d=f&&Ul(t);return a=new Ml({props:{title:gl[t[29]].name,detail:gl[t[29]].detail,color:gl[t[29]].positive?"blue":"purple"}}),{key:e,first:null,c(){n=j("div"),r=j("img"),l=M(),d&&d.c(),s=M(),ge(a.$$.fragment),o=M(),c(r.src,i="/svg/buff/"+t[29]+".svg")||T(r,"src",i),T(n,"class","svelte-16s3vpv"),this.first=n},m(e,t){w(e,n,t),b(n,r),b(n,l),d&&d.m(n,null),b(n,s),ve(a,n,null),b(n,o),u=!0},p(e,l){t=e,(!u||1&l&&!c(r.src,i="/svg/buff/"+t[29]+".svg"))&&T(r,"src",i),1&l&&(f=Object.values(t[0])[t[26]]>1),f?d?d.p(t,l):(d=Ul(t),d.c(),d.m(n,s)):d&&(d.d(1),d=null);const o={};1&l&&(o.title=gl[t[29]].name),1&l&&(o.detail=gl[t[29]].detail),1&l&&(o.color=gl[t[29]].positive?"blue":"purple"),a.$set(o)},i(e){u||(ae(a.$$.fragment,e),u=!0)},o(e){oe(a.$$.fragment,e),u=!1},d(e){e&&k(n),d&&d.d(),ye(a)}}}function Gl(e){let t,n=[],r=new Map,i=e[5].attack;const l=e=>e[26];for(let t=0;t<i.length;t+=1){let s=Dl(e,i,t),a=l(s);r.set(a,n[t]=Yl(a,s))}return{c(){for(let e=0;e<n.length;e+=1)n[e].c();t=A()},m(e,r){for(let t=0;t<n.length;t+=1)n[t]&&n[t].m(e,r);w(e,t,r)},p(e,s){32&s&&(i=e[5].attack,n=me(n,s,l,1,e,i,r,t.parentNode,de,Yl,t,Dl))},d(e){for(let t=0;t<n.length;t+=1)n[t].d(e);e&&k(t)}}}function Yl(e,t){let n,r,i,l=t[27].damage.toFixed(1)+"";return{key:e,first:null,c(){n=j("txt"),r=E(l),T(n,"class",i="battle-input "+(t[27].critical&&"critical")+" svelte-16s3vpv"),N(n,"left",90+150*Jl()+"px"),N(n,"top",60*Jl()-40+"px"),this.first=n},m(e,t){w(e,n,t),b(n,r)},p(e,s){t=e,32&s&&l!==(l=t[27].damage.toFixed(1)+"")&&z(r,l),32&s&&i!==(i="battle-input "+(t[27].critical&&"critical")+" svelte-16s3vpv")&&T(n,"class",i)},d(e){e&&k(n)}}}function Vl(e){let t,n=[],r=new Map,i=e[5].heal;const l=e=>e[26];for(let t=0;t<i.length;t+=1){let s=Hl(e,i,t),a=l(s);r.set(a,n[t]=Zl(a,s))}return{c(){for(let e=0;e<n.length;e+=1)n[e].c();t=A()},m(e,r){for(let t=0;t<n.length;t+=1)n[t]&&n[t].m(e,r);w(e,t,r)},p(e,s){32&s&&(i=e[5].heal,n=me(n,s,l,1,e,i,r,t.parentNode,de,Zl,t,Hl))},d(e){for(let t=0;t<n.length;t+=1)n[t].d(e);e&&k(t)}}}function Zl(e,t){let n,r,i=t[24].toFixed(1)+"";return{key:e,first:null,c(){n=j("txt"),r=E(i),T(n,"class","battle-heal"),N(n,"left",90+150*Jl()+"px"),N(n,"top",60*Jl()-40+"px"),this.first=n},m(e,t){w(e,n,t),b(n,r)},p(e,n){t=e,32&n&&i!==(i=t[24].toFixed(1)+"")&&z(r,i)},d(e){e&&k(n)}}}function Kl(e){let t,n,r,i,l,s,a,o,u,f,d,h,m,p,g,v,y,_,x,$,S,A,C,R,O,P,I,L=[],q=new Map,B=e[2].toFixed(0)+"",F=e[1].health+"";h=new Ml({props:{title:"额外灵力",detail:"等同于灵力，优先消耗。",color:"blue"}});let H=Object.keys(e[0]);const D=e=>e[26];for(let t=0;t<H.length;t+=1){let n=Wl(e,H,t),r=D(n);q.set(r,L[t]=Xl(r,n))}let W=e[5]&&"attack"in e[5]&&0!=e[5].attack.length&&Gl(e),U=e[5]&&"heal"in e[5]&&0!=e[5].heal.length&&Vl(e);return{c(){t=j("div"),n=j("div"),r=j("div"),i=M(),l=j("img"),a=M(),o=j("div"),u=j("txt"),f=E(e[4]),d=M(),ge(h.$$.fragment),m=M(),p=j("div");for(let e=0;e<L.length;e+=1)L[e].c();g=M(),v=j("div"),y=j("txt"),_=E(B),x=E(" / "),$=E(F),S=M(),A=j("div"),C=M(),R=j("div"),R.textContent=`${Bi[e[7].role].title}`,O=M(),W&&W.c(),P=M(),U&&U.c(),N(r,"height",100*(1-e[3]/e[1].power)+"%"),T(r,"class","svelte-16s3vpv"),c(l.src,s=`/img/role/${e[6].resource}/${e[7].role}.webp`)||T(l,"src",s),T(l,"class","svelte-16s3vpv"),T(n,"class","power svelte-16s3vpv"),T(u,"class","svelte-16s3vpv"),T(o,"class","exPower svelte-16s3vpv"),N(o,"visibility",e[4]>0?"visible":"hidden"),T(p,"class","buff svelte-16s3vpv"),T(y,"class","health-value svelte-16s3vpv"),N(A,"left",e[2]/e[1].health*100-100+"%"),T(A,"class","svelte-16s3vpv"),T(v,"class","health svelte-16s3vpv"),T(R,"class","state-role svelte-16s3vpv"),T(t,"class","state svelte-16s3vpv")},m(e,s){w(e,t,s),b(t,n),b(n,r),b(n,i),b(n,l),b(t,a),b(t,o),b(o,u),b(u,f),b(o,d),ve(h,o,null),b(t,m),b(t,p);for(let e=0;e<L.length;e+=1)L[e]&&L[e].m(p,null);b(t,g),b(t,v),b(v,y),b(y,_),b(y,x),b(y,$),b(v,S),b(v,A),b(t,C),b(t,R),b(t,O),W&&W.m(t,null),b(t,P),U&&U.m(t,null),I=!0},p(e,[n]){(!I||10&n)&&N(r,"height",100*(1-e[3]/e[1].power)+"%"),(!I||64&n&&!c(l.src,s=`/img/role/${e[6].resource}/${e[7].role}.webp`))&&T(l,"src",s),(!I||16&n)&&z(f,e[4]),(!I||16&n)&&N(o,"visibility",e[4]>0?"visible":"hidden"),1&n&&(H=Object.keys(e[0]),le(),L=me(L,n,D,1,e,H,q,p,he,Xl,null,Wl),se()),(!I||4&n)&&B!==(B=e[2].toFixed(0)+"")&&z(_,B),(!I||2&n)&&F!==(F=e[1].health+"")&&z($,F),(!I||6&n)&&N(A,"left",e[2]/e[1].health*100-100+"%"),e[5]&&"attack"in e[5]&&0!=e[5].attack.length?W?W.p(e,n):(W=Gl(e),W.c(),W.m(t,P)):W&&(W.d(1),W=null),e[5]&&"heal"in e[5]&&0!=e[5].heal.length?U?U.p(e,n):(U=Vl(e),U.c(),U.m(t,null)):U&&(U.d(1),U=null)},i(e){if(!I){ae(h.$$.fragment,e);for(let e=0;e<H.length;e+=1)ae(L[e]);I=!0}},o(e){oe(h.$$.fragment,e);for(let e=0;e<L.length;e+=1)oe(L[e]);I=!1},d(e){e&&k(t),ye(h);for(let e=0;e<L.length;e+=1)L[e].d();W&&W.d(),U&&U.d()}}}function Jl(){return Math.random()}function Ql(e,t,n){let r,i,l;f(e,ki,(e=>n(13,r=e))),f(e,xi,(e=>n(14,i=e))),f(e,$i,(e=>n(6,l=e)));const s=deepCopy(i);let a={},o=Yi.role[s.role](s.lv);k("patchouli's_ribbon",(e=>n(1,o.power+=e,o))),k("seal_needle",(e=>n(0,a.seal_needle=8,a)));let u,c=o.health,d=o.power,m=0;const p={cost:e=>{let t=d+m-e;return n(4,m=t<=d?0:m-e),t<=d&&n(3,d=t),t},reset:e=>n(3,d=o.power),add:e=>n(4,m+=e),get:e=>d+m},g=p;let{critical:v}=t;const y={round:function(e){e({health:c,state:o,buff:a,input:x,power:e=>p.reset()}),n(0,a)},input:x,output:function(e){const t=deepCopy(s);return t.state=o,t.buff=a,t.health=c,xl(t,(e=>h(ki,r=e,r)),e)},state:e=>{let t=deepCopy(o);return t.Health=c,k("corvis_feathers",(e=>{Object.keys(a).reduce(((e,t)=>e+Number(1==gl[t].positive)),0)>=2&&(t.speed+=.05*e)})),t},buff:function(e){if(!0===e)for(let e in a)gl[e].positive&&delete a[e];if(!1===e)for(let e in a)!gl[e].positive&&delete a[e];if("seal_needle"!=e)return a[e];n(0,a.seal_needle-=1,a)}};let{enermy:_}=t,{killEvent:b}=t;function x(e,t){let r=_.state()[t],i={attack:[],buff:[],heal:[]},l={heal:[],attack:[],buff:[]};for(let t of e.attack){let e=Number(t.value);t.amount=t.amount?t.amount:1,"scale"==t.type&&(e*=.01*r.attack),t.type,t.aim;let n=deepCopy(t);n.critical="critical"in n?n.critical:v(n.from);let s=1.5;"role"==n.from&&k("human_soul_lamp",(e=>s+=.5*e)),n.damage=e*(n.critical?s:1),"self"==t.aim?l.attack.push(n):("rate"==t.type&&(n.damage*=o.health),"Rate"==t.type&&(n.damage*=c),i.attack.push(n))}for(let t of e.heal)"value"==t.type&&i.heal.push(t.value),"rate"==t.type&&i.heal.push(t.value*o.health),"Rate"==t.type&&i.heal.push(t.value*c);for(let t of e.buff)"self"==t.aim?l.buff.push({value:t.value,amount:t.amount}):i.buff.push(t);let f=function(e){const t={attack:[],buff:[],heal:[]};let r=deepCopy(e);for(let e of r.attack)k("mimosa",(t=>{let n=3*o.attack*Math.pow(.95,t-1);e.damage>n&&(e.damage=n)})),k("conch_shell",(t=>e.damage-=t)),e.damage<0&&(e.damage=0),w("interim_barrier",(t=>{t>e.damage?(n(0,a.interim_barrier-=Math.ceil(e.damage),a),e.damage=0):(e.damage-=t,delete a.interim_barrier)})),k("magic_dart",(n=>{e.damage>0&&t.attack.push({value:(.2+.1*(n-1))*e.damage,type:"real",aim:"one",indirect:!0,from:"role"})})),k("large_roll_of_bandages",(t=>{e.damage>0&&n(0,a.in_treatment=t,a)})),k("red_and_white_scarf",(t=>{c/s.health>.3*Math.pow(.9,t-1)&&c-e.damage<=0&&(e.damage=c-1)})),n(2,c-=e.damage),k("fox_jade",(t=>{e.damage/o.health>=.4*Math.pow(.95,t-1)&&b()}));for(let e of r.heal)$(e+c),e+c>o.health&&k("cherry",(t=>r.buff.push({value:"interim_barrier",amount:Math.ceil(.2*(e+c-o.health)*t)}))),delete a.bleed;for(let e of r.buff)n(0,a[e.value]=a[e.value]?a[e.value]+e.amount:e.amount,a);return n(5,u=r),setTimeout((e=>n(5,u=null)),800),t}(i);for(let e in f)f[e].forEach((t=>l[e].push(t)));return l}function $(e){n(2,c=e>o.health?o.health:e)}function w(e,t){if(e in a){let r=a[e];!gl[e].positive&&k("fish_stone",(e=>r-=e)),t(r>=0?r:0),gl[e].expend&&(1==a[e]?delete a[e]:n(0,a[e]--,a))}}function k(e,t){e in s.collections&&t(s.collections[e])}return e.$$set=e=>{"critical"in e&&n(9,v=e.critical),"enermy"in e&&n(11,_=e.enermy),"killEvent"in e&&n(12,b=e.killEvent)},[a,o,c,d,m,u,l,s,g,v,y,_,b]}class es extends xe{constructor(e){super(),be(this,e,Ql,Kl,o,{Power:8,critical:9,role:10,enermy:11,killEvent:12})}get Power(){return this.$$.ctx[8]}get role(){return this.$$.ctx[10]}}function ts(e){let t,n,r,i,l,a,o,u,c,f,h,m,p,g,v,y,_,x,$,S,E,A,z,R,O,P,I,L,q,B,F,H;function W(t){e[13](t)}let U={Selected:e[1],aimed:e[9],ordered:e[3],critical:e[12],killEvent:e[11],role:e[6]};function X(t){e[14](t)}function G(t){e[15](t)}function Z(t){e[16](t)}void 0!==e[7]&&(U.enermy=e[7]),r=new Fl({props:U}),D.push((()=>pe(r,"enermy",W)));let K={};function J(t){e[17](t)}function Q(t){e[18](t)}void 0!==e[0]&&(K.used=e[0]),void 0!==e[1]&&(K.Selected=e[1]),void 0!==e[2]&&(K.refresh=e[2]),u=new pl({props:K}),D.push((()=>pe(u,"used",X))),D.push((()=>pe(u,"Selected",G))),D.push((()=>pe(u,"refresh",Z)));let ee={critical:e[12],killEvent:e[11],enermy:e[7]};return void 0!==e[5]&&(ee.Power=e[5]),void 0!==e[6]&&(ee.role=e[6]),p=new es({props:ee}),D.push((()=>pe(p,"Power",J))),D.push((()=>pe(p,"role",Q))),{c(){t=j("div"),n=j("div"),ge(r.$$.fragment),l=M(),a=j("div"),o=M(),ge(u.$$.fragment),m=M(),ge(p.$$.fragment),y=M(),_=j("div"),x=j("div"),x.innerHTML='<img src="/svg/consumables.svg" class="svelte-390t0t"/> \n        <txt class="svelte-390t0t">消耗品</txt>',$=M(),S=j("div"),S.innerHTML='<img src="/svg/moon.svg" class="svelte-390t0t"/> \n        <txt class="svelte-390t0t">空</txt>',E=M(),A=j("div"),A.innerHTML='<img src="/svg/back.svg" class="svelte-390t0t"/> \n        <txt class="svelte-390t0t">回溯</txt>',z=M(),R=j("div"),O=j("txt"),O.textContent="结束回合",T(a,"class","record"),T(x,"class","consumables svelte-390t0t"),T(S,"class","equipment svelte-390t0t"),T(A,"class","back svelte-390t0t"),T(O,"class","svelte-390t0t"),T(R,"class",P=d(`end ${!e[4]&&"outRound"}`)+" svelte-390t0t"),T(_,"class","action svelte-390t0t"),T(n,"class","battle svelte-390t0t"),T(t,"class",I="body "+e[8].role+" "+e[1]+" svelte-390t0t"),N(t,"background-image","url('/img/scene/"+e[8].scene+".webp')")},m(i,s){w(i,t,s),b(t,n),ve(r,n,null),b(n,l),b(n,a),b(n,o),ve(u,n,null),b(n,m),ve(p,n,null),b(n,y),b(n,_),b(_,x),b(_,$),b(_,S),b(_,E),b(_,A),b(_,z),b(_,R),b(R,O),B=!0,F||(H=[C(A,"click",ns),C(R,"click",e[19])],F=!0)},p(e,[n]){const l={};2&n&&(l.Selected=e[1]),8&n&&(l.ordered=e[3]),64&n&&(l.role=e[6]),!i&&128&n&&(i=!0,l.enermy=e[7],V((()=>i=!1))),r.$set(l);const s={};!c&&1&n&&(c=!0,s.used=e[0],V((()=>c=!1))),!f&&2&n&&(f=!0,s.Selected=e[1],V((()=>f=!1))),!h&&4&n&&(h=!0,s.refresh=e[2],V((()=>h=!1))),u.$set(s);const a={};128&n&&(a.enermy=e[7]),!g&&32&n&&(g=!0,a.Power=e[5],V((()=>g=!1))),!v&&64&n&&(v=!0,a.role=e[6],V((()=>v=!1))),p.$set(a),(!B||16&n&&P!==(P=d(`end ${!e[4]&&"outRound"}`)+" svelte-390t0t"))&&T(R,"class",P),(!B||2&n&&I!==(I="body "+e[8].role+" "+e[1]+" svelte-390t0t"))&&T(t,"class",I)},i(e){B||(ae(r.$$.fragment,e),ae(u.$$.fragment,e),ae(p.$$.fragment,e),Y((()=>{B&&(q&&q.end(1),L=ce(t,zi,{duration:250}),L.start())})),B=!0)},o(e){oe(r.$$.fragment,e),oe(u.$$.fragment,e),oe(p.$$.fragment,e),L&&L.invalidate(),q=fe(t,zi,{duration:250}),B=!1},d(e){e&&k(t),ye(r),ye(u),ye(p),e&&q&&q.end(),F=!1,s(H)}}}const ns=e=>null;function rs(e,t,n){let i,l;f(e,ki,(e=>n(21,i=e))),f(e,xi,(e=>n(22,l=e)));const s=deepCopy(l),a=new window.RAF;let o,u,c,d,m,p,g,v=!0,y=!1;function _(){!function(){let e={buff:[],attack:[],heal:[]};w("ghost_lantern",(t=>e.buff.push({value:"interim_barrier",amount:Math.ceil(.05*p.state().health*t)*m.get()}))),p.input(e)}(),n(4,v=!1);const e=200,t=g.output(),r=deepCopy(t),i=[{handle:!1,time:2}];let l=a.setInterval((e=>{if(i[0].time-=1,0==i[0].time){i[0].handle&&i[0].handle();const e=r.filter((e=>e)),s=r.length-e.length;0==e.length?(a.clearInterval(l),a.setTimeout((e=>{n(3,d=null),n(4,v=!0)}),400),a.setTimeout((e=>{p.round(b),c(x())}),800)):0==e[0].length?i.push({handle:e=>r[s]=!1,time:6}):(e[0].length==t[s].length&&a.setTimeout((e=>{n(3,d=s),g.round(b,s)}),400),i.push({handle:t=>{g.state()[s].Health<=0?r[s]=!1:(g.input(p.input(e[0][0],s),s),e[0].shift())},time:g.state()[s].Health>0?6:1})),i.shift()}}),e)}function b(e){const t={heal:[],attack:[],buff:[]};let n,r=e.state.power;$(e,"in_treatment",(e=>t.heal.push({type:"Rate",value:.05*e}))),$(e,"burning",(e=>t.attack.push({value:.02*e,type:"rate",indirect:!0,critical:!1,aim:"one"}))),$(e,"bleed",(e=>t.attack.push({value:.02*e,type:"rate",indirect:!0,critical:!1,aim:"one"}))),$(e,"hypodynamic",(e=>n=1)),$(e,"star",(n=>{i.bottle_of_stars.filter((t=>t.index==e.index)).forEach((e=>t.attack.push({type:"real",value:e.damage,aim:"one",from:"role",indirect:!0,critical:!1}))),h(ki,i.bottle_of_stars=i.bottle_of_stars.filter((t=>t.index!=e.index)),i)})),(t.heal.length>0||t.attack.length>0)&&e.input(t);for(let t in e.buff)gl[t].interim&&delete e.buff[t];!n&&e.power(r)}function x(){let e=g.state().filter((e=>e.Health>0)),t=e.reduce(((e,t)=>e+t.speed),0)/e.length,n=Math.abs(p.state().speed-t),i=n-parseInt(n),l=parseInt(n)+Number(r()<i);return p.state().speed>t?l:-l}function $(e,t,n){if(t in e.buff){let r=e.buff[t];e.role&&!gl[t].positive&&w("fish_stone",(e=>r-=e)),n(r>=0?r:0),gl[t].expend&&(1==e.buff[t]?delete e.buff[t]:e.buff[t]--),"star"==t&&delete e.buff[t]}}function w(e,t){e in s.collections&&t(s.collections[e])}F((e=>{y||(c(x()),y=!0)}));return[o,u,c,d,v,m,p,g,s,function(e){let t=u==s.role?1:3;if(v)if(t>m.get())alert("灵力不足");else{o(),m.cost(t);let r=g.input(p.output(u),e);p.input(r,e),n(1,u=null)}else alert("不在你的回合")},_,function(e){const t={attack:[],heal:[],buff:[]};w("bird_wine",(e=>t.buff.push({value:"burning",amount:e,aim:"all"}))),g.input(t),w("crown_of_thorns",(e=>m.add(e)))},function(e){let t=.05;if("role"==e){let e=p.state();w("burning_seashore_flower",(n=>t+=Math.floor((e.health-e.Health)/e.health*100)*(.005+.0025*(n-1)))),w("fluorescent_zanthoxylum",(e=>t+=.05*e)),"youmu"==s.role&&(t=0)}return r()<t},function(e){g=e,n(7,g)},function(e){o=e,n(0,o)},function(e){u=e,n(1,u)},function(e){c=e,n(2,c)},function(e){m=e,n(5,m)},function(e){p=e,n(6,p)},e=>v&&_()]}class is extends xe{constructor(e){super(),be(this,e,rs,ts,o,{})}}var ls={sort:{white:["bronze_mirror","sundial","mimosa","compass_cat","bird_wine","frozen_frog","fluorescent_zanthoxylum","corvis_feathers","portable_money_box","pickled_radish","conch_shell","cursed_wind_chimes"],green:["vampire's_old_tooth","large_roll_of_bandages","burning_seashore_flower","skyrocket","magic_dart","fox_jade","cherry","earthy_spider_wine","amulet_of_full_moon","seal_needle","ghost_lantern","crown_of_thorns"],red:["red_and_white_scarf","bottle_of_stars","philosopher's_stone","blade_of_yellow_spring","blood_book","human_soul_lamp","patchouli's_ribbon","fish_stone"]},portable_money_box:{name:"便携式赛钱箱",detail:"每持有100硬币，伤害提高5%(每层+5%)。"},bronze_mirror:{name:"铜镜",detail:"攻击有25%概率额外对随机其它目标造成20%(每层+20%)伤害。"},mimosa:{name:"三片叶子的含羞草",detail:"敌人造成的伤害不会超过自身攻击力的300%(每层*95%)。"},compass_cat:{name:"罗盘猫",detail:"对敏捷高于自己的敌人伤害+10%(每层+10%)。"},bird_wine:{name:"雀酒",detail:"击败敌人时对全体敌人附加燃烧*1(每层+1)。"},frozen_frog:{name:"冻青蛙",detail:"自身所受迟缓效果转移到随机1(每层+1)名敌人身上。"},fluorescent_zanthoxylum:{name:"荧光花椒",detail:"暴击率+5%"},corvis_feathers:{name:"鸦天狗羽毛",detail:"处于两个及以上正面效果下时，敏捷+0.05(每层+0.05)。"},sundial:{name:"日晷",detail:"间接伤害提高10%(每层+10%)。"},pickled_radish:{name:"腌萝卜",detail:"生命值高于95%时符卡造成的伤害+10%(每层+10%)。"},conch_shell:{name:"海螺壳",detail:"每次受到的伤害固定减少1(每层+1)。"},cursed_wind_chimes:{name:"被诅咒的风铃",detail:"造成600%(每层*95%)攻击力及以上的伤害时，使下一次攻击能驱散目标的所有正面效果。"},ghost_lantern:{name:"鬼行提灯",detail:"回合结束时，每剩余1点灵力，获得5%(每层+5%)最大生命值的临时防御结界。"},"vampire's_old_tooth":{name:"吸血鬼的旧牙",detail:"攻击时回复0.5(每层+0.5)生命值。"},large_roll_of_bandages:{name:"一大卷绷带",detail:"受到伤害的下一回合回复5%(每层+5%)当前生命值。"},burning_seashore_flower:{name:"燃烧的彼岸花",detail:"每损失1%生命，获得0.5%(每层+0.25%)暴击率。"},skyrocket:{name:"窜天猴",detail:"普通攻击30%概率造成1.5倍伤害并附带燃烧*1(每层+1)。"},magic_dart:{name:"魔力飞镖",detail:"受到攻击时反击，造成伤害20%(每层+10%)的间接伤害。"},fox_jade:{name:"狐玉",detail:"受到超过最大生命值40%(每层*95%)的伤害时触发一次击败效果。"},cherry:{name:"石樱",detail:"20%(每层+20%)过量治疗量转化为临时防御结界。"},earthy_spider_wine:{name:"土蜘蛛酒",detail:"普通攻击后符卡造成的伤害提高10%(每层+10%)，回合初清除。"},amulet_of_full_moon:{name:"圆月护符",detail:"处于三个及以上负面效果下时，攻击造成的伤害增加10%(每层+10%)。"},seal_needle:{name:"封魔针",detail:"累计造成八次伤害后，下次攻击对全体敌人附加流血*1(每层+1)。"},crown_of_thorns:{name:"荆棘礼冠",detail:"击败敌人时获得1(每层+1)额外灵力。"},red_and_white_scarf:{name:"红白围巾",detail:"生命值高于30%(每层*90%)时，受到致命伤会保留1生命值。"},bottle_of_stars:{name:"装星星的瓶子",detail:"造成200%攻击力及以上的伤害时附加1(每层+1)颗星星，在下回合爆炸造成60%伤害。"},"philosopher's_stone":{name:"贤者之石",detail:"主动装备可使用次数加+1(每层+1)。"},blade_of_yellow_spring:{name:"黄泉之刃",detail:"每回合获得1(每层+1)张额外普通攻击。"},blood_book:{name:"鲜血魔导书",detail:"抽卡上限+1(每层+1)。"},human_soul_lamp:{name:"人魂灯",detail:"暴击伤害+50%(每层+50%)。"},"patchouli's_ribbon":{name:"帕秋莉的缎带",detail:"灵力上限+1(每层+1)。"},fish_stone:{name:"鱼石",detail:"自身负面效果结算时所取层数减1(每层+1)。"}},ss={sort:["gongonier","sword_of_feixiang","sunshade","mirror_of_pear","mini_bagua_stove","louguanjian","hd_camera"],gongonier:{name:"血之矢",detail:"被动。暴击回复伤害20%的生命值。"},sword_of_feixiang:{name:"绯想之剑",detail:"被动。对处于负面效果下的敌人造成的伤害+40%。"},sunshade:{name:"阳伞",detail:"主动。将30%生命值转化为200%防御结界。"},mirror_of_pear:{name:"净颇梨之镜",detail:"被动。普通攻击不消耗灵力。"},mini_bagua_stove:{name:"迷你八卦炉",detail:"主动。对全体敌人造成400%攻击力伤害。"},louguanjian:{name:"楼观剑",detail:"主动。扣除全体敌人20%当前生命值。"},hd_camera:{name:"高清相机",detail:"主动。驱散全体敌人身上的正面效果。"}},as={sort:["noda's_hat","microlithic_fish","ahab's_opinion","mimicry_cat_pendant","wanderlust"],"noda's_hat":{name:"野田的帽子",detail:"生命值高于50%时受到伤害增加20%，低于50%时则减少30%。"},microlithic_fish:{name:"小石的鱼",detail:"受到伤害时70%概率获得随机负面效果(迟缓，燃烧，流血，疲倦)*1，30%概率阻挡本次伤害。"},"ahab's_opinion":{name:"亚哈的意见",detail:"生命上限变为70%，战斗结束后回复全部生命值。"},mimicry_cat_pendant:{name:"拟态的猫挂件",detail:"使用符卡时，每有1灵力需求，扣除10%当前生命值，不消耗灵力。"},wanderlust:{name:"清泧的遨游术",detail:"手牌上限变为3，不受敏捷影响，每拥有1敏捷，回合初获得1额外灵力。"}},os={collection:{portable_money_box:"她经常要暴打妖怪，解决异变，人们很尊敬她。\n但那神社在人迹罕至的山里头。\n对了，随身带着赛钱箱不就好了。",bronze_mirror:"“这是我在竹林里捡到的镜子。”\n“应该叫毛玻璃？是半透明的。还很糊。”\n“但如果像这样对它发射一束光线。”\n“光线居然同时发生了穿透和反射！”\n“不过它的折射角度我就没法控制就是了。”",mimosa:"“老师快看呀，这棵含羞草只有三片叶子！”\n“碰一下试试？”\n叶子收拢了，相邻的那两片叶子靠在了一起。\n“那片叶子好孤独……”\n“但它坚持了该做的事。”",compass_cat:"“稀客啊。”\n“你居然还养了猫。”\n“你不也有两只兔子。”\n“我总是觉得猫的眼睛……很像指南针。”\n“它在竹林里也不会迷路呢。”\n“那就给它起名叫罗盘猫吧。”\n“不要。”",bird_wine:"“我感觉到了，这节竹子里有东西。”\n“雀酒！”\n“也可能是青蛙？”\n“青蛙！”",frozen_frog:"敬请期待",fluorescent_zanthoxylum:"敬请期待",corvis_feathers:"敬请期待",sundial:"敬请期待",pickled_radish:"敬请期待",conch_shell:"“我在藏书的仓库里发现了这个。”\n“是海螺壳呢。”\n“幻想乡有海吗？”\n“月亮上，有的。”\n“我父亲居然上过月球。”\n“但那海里没有生命呢。”\n“难不成......”\n“嗯，是陶瓷的。”\n",cursed_wind_chimes:"敬请期待",ghost_lantern:"敬请期待","vampire's_old_tooth":"前端略尖的牙齿。\n“她小时候换牙换下来的旧牙，我一直收藏着。”\n“能感觉到残存的强大力量，或许能作为大魔法的媒介。”\n“真的？”\n“假的。”",large_roll_of_bandages:"“这、这个尺寸，你究竟是谁？”\n“裹胸用的绷带被某个仙人顺走了啦。”\n“呀，还有这种事。”\n“还有人顺走过扫帚呢。”\n“诶嘿嘿。”",burning_seashore_flower:"敬请期待",skyrocket:"敬请期待",magic_dart:"“这个是未完成品，可以用魔力进行导向的飞镖。”\n“哇，听起来很有意思，便宜卖我呗。”\n“都说了是未完成——小心！”\n“啊呀，戳我屁股上了！”\n“没受伤吧？”\n“当然没有。”",fox_jade:"敬请期待",cherry:"敬请期待",earthy_spider_wine:"敬请期待",amulet_of_full_moon:"敬请期待",seal_needle:"敬请期待",crown_of_thorns:"敬请期待",red_and_white_scarf:"敬请期待",bottle_of_stars:"敬请期待","philosopher's_stone":"敬请期待",blade_of_yellow_spring:"敬请期待",blood_book:"敬请期待",human_soul_lamp:"敬请期待","patchouli's_ribbon":"敬请期待",fish_stone:"敬请期待"},souvenir:{"noda's_hat":"敬请期待",microlithic_fish:"敬请期待","ahab's_opinion":"敬请期待",mimicry_cat_pendant:"敬请期待",wanderlust:"还不可以认输！\n绝望中，仍存有一线生机！\n\n龙战于野，其血玄黄！\n潜龙勿用，藏锋守拙！"},equipment:{gongonier:"敬请期待",sword_of_feixiang:"敬请期待",sunshade:"敬请期待",mirror_of_pear:"敬请期待",mini_bagua_stove:"敬请期待",louguanjian:"敬请期待",hd_camera:"敬请期待"}};function us(e,t,n){const r=e.slice();return r[10]=t[n],r}function cs(e,t,n){const r=e.slice();return r[10]=t[n],r}function fs(e,t,n){const r=e.slice();return r[10]=t[n],r}function ds(e,t,n){const r=e.slice();return r[17]=t[n],r}function hs(e){let t,n,r,i,l=Object.keys(ls.sort),s=[];for(let t=0;t<l.length;t+=1)s[t]=ps(fs(e,l,t));const a=e=>oe(s[e],1,1,(()=>{s[e]=null}));return{c(){t=j("div");for(let e=0;e<s.length;e+=1)s[e].c();T(t,"class","collections svelte-ehbdi1")},m(e,n){w(e,t,n);for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(t,null);i=!0},p(e,n){if(2&n){let r;for(l=Object.keys(ls.sort),r=0;r<l.length;r+=1){const i=fs(e,l,r);s[r]?(s[r].p(i,n),ae(s[r],1)):(s[r]=ps(i),s[r].c(),ae(s[r],1),s[r].m(t,null))}for(le(),r=l.length;r<s.length;r+=1)a(r);se()}},i(e){if(!i){for(let e=0;e<l.length;e+=1)ae(s[e]);Y((()=>{i&&(r&&r.end(1),n=ce(t,zi,{duration:200}),n.start())})),i=!0}},o(e){s=s.filter(Boolean);for(let e=0;e<s.length;e+=1)oe(s[e]);n&&n.invalidate(),r=fe(t,zi,{duration:200}),i=!1},d(e){e&&k(t),S(s,e),e&&r&&r.end()}}}function ms(e){let t,n,r,i,l,s,a,o,u,f;function h(...t){return e[7](e[17],...t)}return l=new Ml({props:{title:ls[e[17]].name,detail:ls[e[17]].detail,color:"white"==e[10]?"blue":e[10]}}),{c(){t=j("div"),n=j("img"),i=M(),ge(l.$$.fragment),s=M(),c(n.src,r="/svg/collection/"+e[17]+".svg")||T(n,"src",r),T(n,"class","svelte-ehbdi1"),T(t,"class",a=d(e[1]==e[17]&&"selected")+" svelte-ehbdi1")},m(e,r){w(e,t,r),b(t,n),b(t,i),ve(l,t,null),b(t,s),o=!0,u||(f=C(t,"click",h),u=!0)},p(n,r){e=n,(!o||2&r&&a!==(a=d(e[1]==e[17]&&"selected")+" svelte-ehbdi1"))&&T(t,"class",a)},i(e){o||(ae(l.$$.fragment,e),o=!0)},o(e){oe(l.$$.fragment,e),o=!1},d(e){e&&k(t),ye(l),u=!1,f()}}}function ps(e){let t,n,r=ls.sort[e[10]],i=[];for(let t=0;t<r.length;t+=1)i[t]=ms(ds(e,r,t));const l=e=>oe(i[e],1,1,(()=>{i[e]=null}));return{c(){for(let e=0;e<i.length;e+=1)i[e].c();t=A()},m(e,r){for(let t=0;t<i.length;t+=1)i[t]&&i[t].m(e,r);w(e,t,r),n=!0},p(e,n){if(2&n){let s;for(r=ls.sort[e[10]],s=0;s<r.length;s+=1){const l=ds(e,r,s);i[s]?(i[s].p(l,n),ae(i[s],1)):(i[s]=ms(l),i[s].c(),ae(i[s],1),i[s].m(t.parentNode,t))}for(le(),s=r.length;s<i.length;s+=1)l(s);se()}},i(e){if(!n){for(let e=0;e<r.length;e+=1)ae(i[e]);n=!0}},o(e){i=i.filter(Boolean);for(let e=0;e<i.length;e+=1)oe(i[e]);n=!1},d(e){S(i,e),e&&k(t)}}}function gs(e){let t,n,r,i,l=as.sort,s=[];for(let t=0;t<l.length;t+=1)s[t]=vs(cs(e,l,t));const a=e=>oe(s[e],1,1,(()=>{s[e]=null}));return{c(){t=j("div");for(let e=0;e<s.length;e+=1)s[e].c();T(t,"class","souvenirs svelte-ehbdi1")},m(e,n){w(e,t,n);for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(t,null);i=!0},p(e,n){if(2&n){let r;for(l=as.sort,r=0;r<l.length;r+=1){const i=cs(e,l,r);s[r]?(s[r].p(i,n),ae(s[r],1)):(s[r]=vs(i),s[r].c(),ae(s[r],1),s[r].m(t,null))}for(le(),r=l.length;r<s.length;r+=1)a(r);se()}},i(e){if(!i){for(let e=0;e<l.length;e+=1)ae(s[e]);Y((()=>{i&&(r&&r.end(1),n=ce(t,zi,{duration:200}),n.start())})),i=!0}},o(e){s=s.filter(Boolean);for(let e=0;e<s.length;e+=1)oe(s[e]);n&&n.invalidate(),r=fe(t,zi,{duration:200}),i=!1},d(e){e&&k(t),S(s,e),e&&r&&r.end()}}}function vs(e){let t,n,r,i,l,s,a,o,u,f;function h(...t){return e[8](e[10],...t)}return l=new Ml({props:{title:as[e[10]].name,detail:as[e[10]].detail,color:"purple"}}),{c(){t=j("div"),n=j("img"),i=M(),ge(l.$$.fragment),s=M(),c(n.src,r="/svg/souvenir/"+e[10]+".svg")||T(n,"src",r),T(n,"class","svelte-ehbdi1"),T(t,"class",a=d(e[1]==e[10]&&"selected")+" svelte-ehbdi1")},m(e,r){w(e,t,r),b(t,n),b(t,i),ve(l,t,null),b(t,s),o=!0,u||(f=C(t,"click",h),u=!0)},p(n,r){e=n,(!o||2&r&&a!==(a=d(e[1]==e[10]&&"selected")+" svelte-ehbdi1"))&&T(t,"class",a)},i(e){o||(ae(l.$$.fragment,e),o=!0)},o(e){oe(l.$$.fragment,e),o=!1},d(e){e&&k(t),ye(l),u=!1,f()}}}function ys(e){let t,n,r,i,l=ss.sort,s=[];for(let t=0;t<l.length;t+=1)s[t]=_s(us(e,l,t));const a=e=>oe(s[e],1,1,(()=>{s[e]=null}));return{c(){t=j("div");for(let e=0;e<s.length;e+=1)s[e].c();T(t,"class","equipments svelte-ehbdi1")},m(e,n){w(e,t,n);for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(t,null);i=!0},p(e,n){if(2&n){let r;for(l=ss.sort,r=0;r<l.length;r+=1){const i=us(e,l,r);s[r]?(s[r].p(i,n),ae(s[r],1)):(s[r]=_s(i),s[r].c(),ae(s[r],1),s[r].m(t,null))}for(le(),r=l.length;r<s.length;r+=1)a(r);se()}},i(e){if(!i){for(let e=0;e<l.length;e+=1)ae(s[e]);Y((()=>{i&&(r&&r.end(1),n=ce(t,zi,{duration:200}),n.start())})),i=!0}},o(e){s=s.filter(Boolean);for(let e=0;e<s.length;e+=1)oe(s[e]);n&&n.invalidate(),r=fe(t,zi,{duration:200}),i=!1},d(e){e&&k(t),S(s,e),e&&r&&r.end()}}}function _s(e){let t,n,r,i,l,s,a,o,u,f;function h(...t){return e[9](e[10],...t)}return l=new Ml({props:{title:ss[e[10]].name,detail:ss[e[10]].detail,color:"gold"}}),{c(){t=j("div"),n=j("img"),i=M(),ge(l.$$.fragment),s=M(),c(n.src,r="/svg/equipment/"+e[10]+".svg")||T(n,"src",r),T(n,"class","svelte-ehbdi1"),T(t,"class",a=d(e[1]==e[10]&&"selected")+" svelte-ehbdi1")},m(e,r){w(e,t,r),b(t,n),b(t,i),ve(l,t,null),b(t,s),o=!0,u||(f=C(t,"click",h),u=!0)},p(n,r){e=n,(!o||2&r&&a!==(a=d(e[1]==e[10]&&"selected")+" svelte-ehbdi1"))&&T(t,"class",a)},i(e){o||(ae(l.$$.fragment,e),o=!0)},o(e){oe(l.$$.fragment,e),o=!1},d(e){e&&k(t),ye(l),u=!1,f()}}}function bs(e){let t,n,r,i,l,s,a,o,u,f,d,h,m,p,g,v=e[2][e[0]][e[1]].name+"",y=e[2][e[0]][e[1]].detail+"",_=os[e[0]][e[1]]+"";return{c(){t=j("div"),n=j("img"),i=M(),l=j("txt"),s=E(v),a=M(),o=j("txt"),u=E(y),f=M(),d=j("txt"),h=E(_),c(n.src,r="/svg/"+e[0]+"/"+e[1]+".svg")||T(n,"src",r),T(n,"class","svelte-ehbdi1"),T(l,"class","name svelte-ehbdi1"),T(o,"class","effect svelte-ehbdi1"),T(d,"class","story svelte-ehbdi1"),T(t,"class","detail svelte-ehbdi1")},m(e,r){w(e,t,r),b(t,n),b(t,i),b(t,l),b(l,s),b(t,a),b(t,o),b(o,u),b(t,f),b(t,d),b(d,h),g=!0},p(e,t){(!g||3&t&&!c(n.src,r="/svg/"+e[0]+"/"+e[1]+".svg"))&&T(n,"src",r),(!g||3&t)&&v!==(v=e[2][e[0]][e[1]].name+"")&&z(s,v),(!g||3&t)&&y!==(y=e[2][e[0]][e[1]].detail+"")&&z(u,y),(!g||3&t)&&_!==(_=os[e[0]][e[1]]+"")&&z(h,_)},i(e){g||(Y((()=>{g&&(p&&p.end(1),m=ce(t,zi,{duration:200}),m.start())})),g=!0)},o(e){m&&m.invalidate(),p=fe(t,zi,{duration:200}),g=!1},d(e){e&&k(t),e&&p&&p.end()}}}function xs(e){let t,n,r,i,l,a,o,u,c,f,h,m,p,g,v,y,_,x,$,S,A,z,N,R,O,P,I,L,q,B="collection"==e[0]&&hs(e),F="souvenir"==e[0]&&gs(e),H="equipment"==e[0]&&ys(e),D=e[1]&&bs(e);return{c(){t=j("div"),n=j("div"),r=j("txt"),i=E("收藏品"),a=M(),o=j("txt"),u=E("纪念品"),f=M(),h=j("txt"),m=E("装备"),g=M(),v=j("txt"),v.textContent="符卡",y=M(),_=j("txt"),_.textContent="消耗品",x=M(),$=j("txt"),$.textContent="角色",S=M(),A=j("div"),B&&B.c(),z=M(),F&&F.c(),N=M(),H&&H.c(),R=M(),D&&D.c(),T(r,"class",l=d("collection"==e[0]&&"selected")+" svelte-ehbdi1"),T(o,"class",c=d("souvenir"==e[0]&&"selected")+" svelte-ehbdi1"),T(h,"class",p=d("equipment"==e[0]&&"selected")+" svelte-ehbdi1"),T(v,"class","svelte-ehbdi1"),T(_,"class","svelte-ehbdi1"),T($,"class","svelte-ehbdi1"),T(n,"class","index svelte-ehbdi1"),T(A,"class","main svelte-ehbdi1"),T(t,"class","body svelte-ehbdi1")},m(l,s){w(l,t,s),b(t,n),b(n,r),b(r,i),b(n,a),b(n,o),b(o,u),b(n,f),b(n,h),b(h,m),b(n,g),b(n,v),b(n,y),b(n,_),b(n,x),b(n,$),b(t,S),b(t,A),B&&B.m(A,null),b(A,z),F&&F.m(A,null),b(A,N),H&&H.m(A,null),b(A,R),D&&D.m(A,null),I=!0,L||(q=[C(r,"click",e[4]),C(o,"click",e[5]),C(h,"click",e[6])],L=!0)},p(e,[t]){(!I||1&t&&l!==(l=d("collection"==e[0]&&"selected")+" svelte-ehbdi1"))&&T(r,"class",l),(!I||1&t&&c!==(c=d("souvenir"==e[0]&&"selected")+" svelte-ehbdi1"))&&T(o,"class",c),(!I||1&t&&p!==(p=d("equipment"==e[0]&&"selected")+" svelte-ehbdi1"))&&T(h,"class",p),"collection"==e[0]?B?(B.p(e,t),1&t&&ae(B,1)):(B=hs(e),B.c(),ae(B,1),B.m(A,z)):B&&(le(),oe(B,1,1,(()=>{B=null})),se()),"souvenir"==e[0]?F?(F.p(e,t),1&t&&ae(F,1)):(F=gs(e),F.c(),ae(F,1),F.m(A,N)):F&&(le(),oe(F,1,1,(()=>{F=null})),se()),"equipment"==e[0]?H?(H.p(e,t),1&t&&ae(H,1)):(H=ys(e),H.c(),ae(H,1),H.m(A,R)):H&&(le(),oe(H,1,1,(()=>{H=null})),se()),e[1]?D?(D.p(e,t),2&t&&ae(D,1)):(D=bs(e),D.c(),ae(D,1),D.m(A,null)):D&&(le(),oe(D,1,1,(()=>{D=null})),se())},i(e){I||(ae(B),ae(F),ae(H),ae(D),Y((()=>{I&&(P&&P.end(1),O=ce(t,zi,{duration:250}),O.start())})),I=!0)},o(e){oe(B),oe(F),oe(H),oe(D),O&&O.invalidate(),P=fe(t,zi,{duration:250}),I=!1},d(e){e&&k(t),B&&B.d(),F&&F.d(),H&&H.d(),D&&D.d(),e&&P&&P.end(),L=!1,s(q)}}}function $s(e,t,n){let r="collection",i=null;function l(e){n(1,i=null),n(0,r=e)}return[r,i,{collection:ls,equipment:ss,souvenir:as,spellcard:Xi,role:Bi},l,e=>l("collection"),e=>l("souvenir"),e=>l("equipment"),(e,t)=>n(1,i=e),(e,t)=>n(1,i=e),(e,t)=>n(1,i=e)]}class ws extends xe{constructor(e){super(),be(this,e,$s,xs,o,{})}}function ks(e){let t,n,r,i,l;var s=e[2][e[1]];return s&&(n=R(s,{})),i=new Ti({}),{c(){t=j("div"),n&&ge(n.$$.fragment),r=M(),ge(i.$$.fragment),T(t,"id","root"),N(t,"background-image","url(/img/scene/"+e[0]+".webp)"),T(t,"class","svelte-155t4ky")},m(e,s){w(e,t,s),n&&ve(n,t,null),b(t,r),ve(i,t,null),l=!0},p(e,[i]){if(2&i&&s!==(s=e[2][e[1]])){if(n){le();const e=n;oe(e.$$.fragment,1,0,(()=>{ye(e,1)})),se()}s?(n=R(s,{}),ge(n.$$.fragment),ae(n.$$.fragment,1),ve(n,t,r)):n=null}(!l||1&i)&&N(t,"background-image","url(/img/scene/"+e[0]+".webp)")},i(e){l||(n&&ae(n.$$.fragment,e),ae(i.$$.fragment,e),l=!0)},o(e){n&&oe(n.$$.fragment,e),oe(i.$$.fragment,e),l=!1},d(e){e&&k(t),n&&ye(n),ye(i)}}}function Ss(e,t,n){let r,i;f(e,_i,(e=>n(0,r=e))),f(e,yi,(e=>n(1,i=e)));const l={index:Li,foreword:ll,explore:cl,battle:is,afflatus:ws};window.deepCopy=e=>{if(Array.isArray(e)){let i=e;for(var t=[],n=0;n<i.length;n++)if(Array.isArray(i[n])){var r=deepCopy(i[n]);t.push(r)}else t.push(i[n]);return t}{let t=e.constructor===Array?[]:{};for(let n in e)t[n]="object"==typeof e[n]?deepCopy(e[n]):e[n];return t}},Array.prototype.rd=function(){for(var e,t,n=this.length;n;e=parseInt(Math.random()*n),t=this[--n],this[n]=this[e],this[e]=t);return this},String.prototype.getByteLen=function(){let e=0;for(let t=0;t<this.length;t++)this.charCodeAt(t)<256?e+=1:e+=2;return e},window.r=Math.random;return window.RAF=class{constructor(){this.init()}init(){this._timerIdMap={timeout:{},interval:{}}}run(e="interval",t,n=16.7){const r=Date.now;let i=r(),l=i;const s=Symbol(),a=()=>{this.setIdMap(s,e,a),l=r(),l-i>=n&&("interval"===e&&(i=r(),l=i),t(),"timeout"===e&&this.clearTimeout(s))};return this.setIdMap(s,e,a),s}setIdMap(e,t,n){const r=requestAnimationFrame(n);this._timerIdMap[t][e]=r}setTimeout(e,t){return this.run("timeout",e,t)}clearTimeout(e){cancelAnimationFrame(this._timerIdMap.timeout[e])}setInterval(e,t){return this.run("interval",e,t)}clearInterval(e){cancelAnimationFrame(this._timerIdMap.interval[e])}},[r,i,l]}return new class extends xe{constructor(e){super(),be(this,e,Ss,ks,o,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
